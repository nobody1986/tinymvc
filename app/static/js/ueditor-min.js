UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.commands={};baidu.editor.plugins={};baidu.editor.version="1.1.8.4";baidu.editor.browser=function(){var d=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:!!window.ActiveXObject,opera:(!!b&&b.version),webkit:(d.indexOf(" applewebkit/")>-1),air:(d.indexOf(" adobeair/")>-1),mac:(d.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};c.gecko=(navigator.product=="Gecko"&&!c.webkit&&!c.opera);var a=0;if(c.ie){a=parseFloat(d.match(/msie (\d+)/)[1]);c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=((a==7&&!document.documentMode)||document.documentMode==7);c.ie6Compat=(a<7||c.quirks)}if(c.gecko){var e=d.match(/rv:([\d\.]+)/);if(e){e=e[1].split(".");a=e[0]*10000+(e[1]||0)*100+(e[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(d)){c.chrome=+RegExp["\x241"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(d)&&!/chrome/i.test(d)){c.safari=+(RegExp["\x241"]||RegExp["\x242"])}if(c.opera){a=parseFloat(b.version())}if(c.webkit){a=parseFloat(d.match(/ applewebkit\/(\d+)/)[1])}c.version=a;c.isCompatible=!c.mobile&&((c.ie&&a>=6)||(c.gecko&&a>=10801)||(c.opera&&a>=9.5)||(c.air&&a>=1)||(c.webkit&&a>=522)||false);return c}();(function(){baidu.editor.utils={};var b=new Function();var a=baidu.editor.utils={makeInstance:function(c){b.prototype=c;c=new b;b.prototype=null;return c},extend:function(e,f,c){if(f){for(var d in f){if(!c||!e.hasOwnProperty(d)){e[d]=f[d]}}}return e},isArray:function(c){return Object.prototype.toString.apply(c)==="[object Array]"},isString:function(c){return typeof c=="string"||c.constructor==String},inherits:function(f,d){var c=f.prototype;var e=a.makeInstance(d.prototype);a.extend(e,c,true);f.prototype=e;return(e.constructor=f)},bind:function(c,d){return function(){return c.apply(d,arguments)}},defer:function(d,c,e){var f;return function(){if(e){clearTimeout(f)}f=setTimeout(d,c)}},indexOf:function(e,d,c){c=c||0;while(c<e.length){if(e[c]===d){return c}c++}return -1},removeItem:function(e,d){var c=e.length;if(c){while(c--){if(e[c]===d){e.splice(c,1);break}}}},trim:function(){var c=/(^[ \t\n\r]+)|([ \t\n\r]+$)/g;return function(d){return d.replace(c,"")}}(),listToMap:function(d){if(!d){return{}}var f=d.split(/,/g),c=f.length,e={};if(c){while(c--){e[f[c]]=1}}return e},unhtml:function(){var d={"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"};function c(e){return d[e]}return function(e){return e?e.replace(/[&<">]/g,c):""}}(),cssStyleToDomStyle:function(){var f=document.createElement("div").style,d=f.cssFloat!=undefined?"cssFloat":f.styleFloat!=undefined?"styleFloat":"float",c={"float":d};function e(g){return g.charAt(1).toUpperCase()}return function(g){return c[g]||(c[g]=g.toLowerCase().replace(/-./g,e))}}(),loadFile:function(g,f,c){if(f.id&&g.getElementById(f.id)){return}var d=g.createElement(f.tag);delete f.tag;for(var e in f){d.setAttribute(e,f[e])}d.onload=d.onreadystatechange=function(){if(!this.readyState||this.readyState=="loaded"||this.readyState=="complete"){if(c){c()}d.onload=d.onreadystatechange=null}};g.getElementsByTagName("head")[0].appendChild(d)},isEmptyObject:function(d){for(var c in d){return false}return true},fixColor:function(d,f){if(/color/i.test(d)&&/rgba?/.test(f)){var g=f.split(",");if(g.length>3){return""}f="#";for(var e=0,c;c=g[e++];){c=parseInt(c.replace(/[^\d]/gi,""),10).toString(16);f+=c.length==1?"0"+c:c}f=f.toUpperCase()}return f}}})();(function(){baidu.editor.EventBase=c;var a=baidu.editor.utils;function c(){}c.prototype={addListener:function(d,e){b(this,d,true).push(e)},removeListener:function(e,f){var d=b(this,e);d&&a.removeItem(d,f)},fireEvent:function(g){var f=b(this,g),h,e,d;if(f){d=f.length;while(d--){e=f[d].apply(this,arguments);if(e!==undefined){h=e}}}if(e=this["on"+g.toLowerCase()]){h=e.apply(this,arguments)}return h}};function b(g,e,f){var d;e=e.toLowerCase();return((d=(g.__allListeners||f&&(g.__allListeners={})))&&(d[e]||f&&(d[e]=[])))}})();baidu.editor.dom=baidu.editor.dom||{};baidu.editor.dom.dtd=(function(){function W(B){for(var A in B){B[A.toUpperCase()]=B[A]}return B}function a(E){var B=arguments;for(var D=1;D<B.length;D++){var A=B[D];for(var C in A){if(!E.hasOwnProperty(C)){E[C]=A[C]}}}return E}var z=W({isindex:1,fieldset:1}),y=W({input:1,button:1,select:1,textarea:1,label:1}),x=a(W({a:1}),y),w=a({iframe:1},x),v=W({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),u=W({ins:1,del:1,script:1,style:1}),t=a(W({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),u),s=a(W({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),t),r=a(W({p:1}),s),q=a(W({iframe:1}),s,y),n=W({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),m=a(W({a:0}),q),k=W({tr:1}),j=W({"#":1}),i=a(W({param:1}),n),h=a(W({form:1}),z,w,v,r),g=W({li:1}),f=W({style:1,script:1}),e=W({base:1,link:1,meta:1,title:1}),d=a(e,f),c=W({head:1,body:1}),b=W({html:1});var l=W({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),o=W({area:1,base:1,br:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1});return W({$nonBodyContent:a(b,c,e),$block:l,$inline:m,$body:a(W({script:1,style:1}),l),$cdata:W({script:1,style:1}),$empty:o,$nonChild:W({iframe:1}),$listItem:W({dd:1,dt:1,li:1}),$list:W({ul:1,ol:1,dl:1}),$isNotEmpty:W({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$removeEmpty:W({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:W({p:1,div:1}),$tableContent:W({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:W({pre:1,script:1,style:1,textarea:1}),html:c,head:d,style:j,script:j,body:h,base:{},link:{},meta:{},title:j,col:{},tr:W({td:1,th:1}),img:{},embed:{},colgroup:W({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:h,td:h,br:{},th:h,center:h,kbd:m,button:a(r,v),basefont:{},h5:m,h4:m,samp:m,h6:m,ol:g,h1:m,h3:m,option:j,h2:m,form:a(z,w,v,r),select:W({optgroup:1,option:1}),font:m,ins:m,menu:g,abbr:m,label:m,table:W({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:m,tfoot:k,cite:m,li:h,input:{},iframe:h,strong:m,textarea:j,noframes:h,big:m,small:m,span:{"#":1},hr:m,dt:m,sub:m,optgroup:W({option:1}),param:{},bdo:m,"var":m,div:h,object:i,sup:m,dd:h,strike:m,area:{},dir:g,map:a(W({area:1,form:1,p:1}),z,u,v),applet:i,dl:W({dt:1,dd:1}),del:m,isindex:{},fieldset:a(W({legend:1}),n),thead:k,ul:g,acronym:m,b:m,a:a(W({a:1}),q),blockquote:a(W({td:1,tr:1,tbody:1,li:1}),h),caption:m,i:m,u:m,tbody:k,s:m,address:a(w,r),tt:m,legend:m,q:m,pre:a(t,x),p:a(W({a:1}),m),em:m,dfn:m})})();baidu.editor.dom.domUtils=baidu.editor.dom.domUtils||{};(function(){var g=baidu.editor,f=g.browser,a=g.dom.dtd,j=g.utils,c=f.ie,b={},h=0;function e(r,s,l,k,o,q){var n=k&&r[s],m;!n&&(n=r[l]);while(!n&&(m=(m||r).parentNode)){if(m.tagName=="BODY"){return null}if(q&&!q(m)){return null}n=m[l]}if(n&&o&&!o(n)){return e(n,s,l,false,o)}return n}var i=f.ie&&f.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"};var d=baidu.editor.dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:f.ie&&f.version=="6"?"\ufeff":"\u200B",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(q,n){if(q===n){return 0}var l,o=[q],m=[n];l=q;while(l=l.parentNode){if(l===n){return 10}o.push(l)}l=n;while(l=l.parentNode){if(l===q){return 20}m.push(l)}o.reverse();m.reverse();if(o[0]!==m[0]){return 1}var k=-1;while(k++,o[k]===m[k]){}q=o[k];n=m[k];while(q=q.nextSibling){if(q===n){return 4}}return 2},getNodeIndex:function(l){var m=l.parentNode.childNodes,k=0;while(m[k]!==l){k++}return k},findParent:function(m,k,l){if(!this.isBody(m)){m=l?m:m.parentNode;while(m){if(!k||k(m)||this.isBody(m)){return k&&!k(m)&&this.isBody(m)?null:m}m=m.parentNode}}return null},findParentByTagName:function(m,l,k,n){if(m&&m.nodeType&&!this.isBody(m)&&(m.nodeType==1||m.nodeType)){l=!j.isArray(l)?[l]:l;m=m.nodeType==3||!k?m.parentNode:m;while(m&&m.tagName&&m.nodeType!=9){if(n&&n(m)){return null}if(j.indexOf(l,m.tagName.toLowerCase())>-1){return m}m=m.parentNode}}return null},findParents:function(o,n,k,m){var l=n&&(k&&k(o)||!k)?[o]:[];while(o=d.findParent(o,k)){l.push(o)}if(!m){l.reverse()}return l},insertAfter:function(l,k){return l.parentNode.insertBefore(k,l.nextSibling)},remove:function(l,m){var k=l.parentNode,n;if(k){if(m&&l.hasChildNodes()){while(n=l.firstChild){k.insertBefore(n,l)}}k.removeChild(l)}return l},getNextDomNode:function(n,k,l,m){return e(n,"firstChild","nextSibling",k,l,m)},isBookmarkNode:function(k){return k.nodeType==1&&k.id&&/^_baidu_bookmark_/i.test(k.id)},getWindow:function(k){var l=k.ownerDocument||k;return l.defaultView||l.parentWindow},getCommonAncestor:function(q,n){if(q===n){return q}var o=[q],m=[n],l=q,k=-1;while(l=l.parentNode){if(l===n){return l}o.push(l)}l=n;while(l=l.parentNode){if(l===q){return l}m.push(l)}o.reverse();m.reverse();while(k++,o[k]===m[k]){}return k==0?null:o[k-1]},clearEmptySibling:function(n,l,m){function k(r,o){var q;if(r&&(!d.isBookmarkNode(r)&&d.isEmptyInlineElement(r)||d.isWhitespace(r))){q=r[o];d.remove(r);q&&k(q,o)}}!l&&k(n.nextSibling,"nextSibling");!m&&k(n.previousSibling,"previousSibling")},split:function(n,q){var o=n.ownerDocument;if(f.ie&&q==n.nodeValue.length){var m=o.createTextNode("");return d.insertAfter(n,m)}var k=n.splitText(q);if(f.ie8){var l=o.createTextNode("");d.insertAfter(k,l);d.remove(l)}return k},isWhitespace:function(l){var k=new RegExp("[^ \t\n\r"+d.fillChar+"]");return !k.test(l.nodeValue)},getXY:function(l){var k=0,m=0;while(l.offsetParent){m+=l.offsetTop;k+=l.offsetLeft;l=l.offsetParent}return{x:k,y:m}},on:function(r,q,o){var n=q instanceof Array?q:[q],l=n.length;if(l){while(l--){h++;q=n[l];if(r.addEventListener){r.addEventListener(q,o,false)}else{if(!o._d){o._d={}}var m=q+o.toString();if(!o._d[m]){o._d[m]=function(k){return o.call(k.srcElement,k||window.event)};r.attachEvent("on"+q,o._d[m])}}}}r=null},un:function(r,q,o){var n=q instanceof Array?q:[q],l=n.length;if(l){while(l--){q=n[l];if(r.removeEventListener){r.removeEventListener(q,o,false)}else{var m=q+o.toString();r.detachEvent("on"+q,o._d?o._d[m]:o);if(o._d&&o._d[m]){delete o._d[m]}}}}},isSameElement:function(n,m){if(n.tagName!=m.tagName){return 0}var s=n.attributes,r=m.attributes;if(!c&&s.length!=r.length){return 0}var k,t,q=0,l=0;for(var o=0;k=s[o++];){if(k.nodeName=="style"){if(k.specified){q++}if(d.isSameStyle(n,m)){continue}else{return 0}}if(c){if(k.specified){q++;t=r.getNamedItem(k.nodeName)}else{continue}}else{t=m.attributes[k.nodeName]}if(!t.specified){return 0}if(k.nodeValue!=t.nodeValue){return 0}}if(c){for(o=0;t=r[o++];){if(t.specified){l++}}if(q!=l){return 0}}return 1},isRedundantSpan:function(k){if(k.nodeType==3||k.tagName.toLowerCase()!="span"){return 0}if(f.ie){return k.style.cssText==""?1:0}return !k.attributes.length},isSameStyle:function(n,m){var l=n.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),k=m.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(!l||!k){return l==k?1:0}l=l.split(";");k=k.split(";");if(l.length!=k.length){return 0}for(var q=0,o;o=l[q++];){if(j.indexOf(k,o)==-1){return 0}}return 1},isBlockElm:function(){var l=["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"],k={hr:1};return function(n,m){return n.nodeType==1&&(j.indexOf(l,d.getComputedStyle(n,"display"))!=-1||j.extend(k,m||{})[n.tagName.toLocaleLowerCase()])&&!a.$nonChild[n.tagName]}}(),isBody:function(k){return k&&k.nodeType==1&&k.tagName.toLowerCase()=="body"},breakParent:function(o,m){var l,r=o,q=o,k,n;do{r=r.parentNode;if(k){l=r.cloneNode(false);l.appendChild(k);k=l;l=r.cloneNode(false);l.appendChild(n);n=l}else{k=r.cloneNode(false);n=k.cloneNode(false)}while(l=q.previousSibling){k.insertBefore(l,k.firstChild)}while(l=q.nextSibling){n.appendChild(l)}q=r}while(m!==r);l=m.parentNode;l.insertBefore(k,m);l.insertBefore(n,m);l.insertBefore(o,n);d.remove(m);return o},isEmptyInlineElement:function(k){if(k.nodeType!=1||!a.$removeEmpty[k.tagName]){return 0}k=k.firstChild;while(k){if(d.isBookmarkNode(k)){return 0}if(k.nodeType==1&&!d.isEmptyInlineElement(k)||k.nodeType==3&&!d.isWhitespace(k)){return 0}k=k.nextSibling}return 1},trimWhiteTextNode:function(l){function k(m){var n;while((n=l[m])&&n.nodeType==3&&d.isWhitespace(n)){l.removeChild(n)}}k("firstChild");k("lastChild")},mergChild:function(n,l,u){var r=d.getElementsByTagName(n,n.tagName.toLowerCase());for(var q=0,w;w=r[q++];){if(!w.parentNode||d.isBookmarkNode(w)){continue}if(w.tagName.toLowerCase()=="span"){if(n===w.parentNode){d.trimWhiteTextNode(n);if(n.childNodes.length==1){n.style.cssText=w.style.cssText+";"+n.style.cssText;d.remove(w,true);continue}}w.style.cssText=n.style.cssText+";"+w.style.cssText;if(u){var k=u.style;if(k){k=k.split(";");for(var o=0,v;v=k[o++];){w.style[j.cssStyleToDomStyle(v.split(":")[0])]=v.split(":")[1]}}}if(d.isSameStyle(w,n)){d.remove(w,true)}continue}if(d.isSameElement(n,w)){d.remove(w,true)}}if(l=="span"){var m=d.getElementsByTagName(n,"a");for(var q=0,t;t=m[q++];){t.style.cssText=";"+n.style.cssText;t.style.textDecoration="underline"}}},getElementsByTagName:function(o,l){var q=o.getElementsByTagName(l),k=[];for(var n=0,m;m=q[n++];){k.push(m)}return k},mergToParent:function(l){var k=l.parentNode;while(k&&a.$removeEmpty[k.tagName]){if(k.tagName==l.tagName||k.tagName=="A"){d.trimWhiteTextNode(k);if(k.tagName=="SPAN"&&!d.isSameStyle(k,l)||(k.tagName=="A"&&l.tagName=="SPAN")){if(k.childNodes.length>1||k!==l.parentNode){l.style.cssText=k.style.cssText+";"+l.style.cssText;k=k.parentNode;continue}else{k.style.cssText+=";"+l.style.cssText;if(k.tagName=="A"){k.style.textDecoration="underline"}}}if(k.tagName!="A"){k===l.parentNode&&d.remove(l,true);break}}k=k.parentNode}},mergSibling:function(m,l,k){function n(r,s,q){var o;if((o=q[r])&&!d.isBookmarkNode(o)&&o.nodeType==1&&d.isSameElement(q,o)){while(o.firstChild){if(s=="firstChild"){q.insertBefore(o.lastChild,q.firstChild)}else{q.appendChild(o.firstChild)}}d.remove(o)}}!l&&n("previousSibling","firstChild",m);!k&&n("nextSibling","lastChild",m)},unselectable:f.gecko?function(k){k.style.MozUserSelect="none"}:f.webkit?function(k){k.style.KhtmlUserSelect="none"}:function(m){m.onselectstart=function(){return false};m.onclick=m.onkeyup=m.onkeydown=function(){return false};m.unselectable="on";m.setAttribute("unselectable","on");for(var l=0,k;k=m.all[l++];){switch(k.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:k.unselectable="on";m.setAttribute("unselectable","on")}}},removeAttributes:function(n,o){var m=o.length;if(m){while(m--){var l=o[m];l=i[l]||l;if(l=="className"){n[l]=""}n.removeAttribute(l)}}},setAttributes:function(m,l){for(var k in l){switch(k.toLowerCase()){case"class":m.className=l[k];break;case"style":m.style.cssText=l[k];break;default:m.setAttribute(k.toLowerCase(),l[k])}}return m},getComputedStyle:function(m,l){function o(s,t){if(s=="font-size"&&/pt$/.test(t)){t=Math.round(parseFloat(t)/0.75)+"px"}return t}if(m.nodeType==3){m=m.parentNode}if(f.ie&&f.version<9&&l=="font-size"&&!m.style.fontSize&&!a.$empty[m.tagName]&&!a.$nonChild[m.tagName]){var n=m.ownerDocument.createElement("span");n.style.cssText="padding:0;border:0;font-family:simsun;";n.innerHTML=".";m.appendChild(n);var k=n.offsetHeight;m.removeChild(n);n=null;return k+"px"}try{var q=d.getStyle(m,l)||(window.getComputedStyle?d.getWindow(m).getComputedStyle(m,"").getPropertyValue(l):(m.currentStyle||m.style)[j.cssStyleToDomStyle(l)])}catch(r){return null}return o(l,j.fixColor(l,q))},removeClasses:function(k,l){k.className=(" "+k.className+" ").replace(new RegExp("(?:\\s+(?:"+l.join("|")+"))+\\s+","g")," ")},removeStyle:function(l,k){l.style[j.cssStyleToDomStyle(k)]="";if(l.style.removeAttribute){l.style.removeAttribute(j.cssStyleToDomStyle(k))}if(!l.style.cssText){l.removeAttribute("style")}},hasClass:function(k,l){return(" "+k.className+" ").indexOf(" "+l+" ")>-1},preventDefault:function(k){k.preventDefault?k.preventDefault():(k.returnValue=false)},getStyle:function(l,k){var m=l.style[j.cssStyleToDomStyle(k)];return j.fixColor(k,m)},setStyle:function(l,k,m){l.style[j.cssStyleToDomStyle(k)]=m},setStyles:function(l,m){for(var k in m){if(m.hasOwnProperty(k)){d.setStyle(l,k,m[k])}}},removeDirtyAttr:function(n){for(var m=0,l,k=n.getElementsByTagName("*");l=k[m++];){l.removeAttribute("_moz_dirty")}n.removeAttribute("_moz_dirty")},getChildCount:function(m,k){var l=0,n=m.firstChild;k=k||function(){return 1};while(n){if(k(n)){l++}n=n.nextSibling}return l},clearReduent:function(n,u){var l,m=new RegExp(d.fillChar,"g"),o;for(var r=0,k;k=u[r++];){l=n.getElementsByTagName(k);for(var q=0,s;s=l[q++];){if(s.parentNode&&s[f.ie?"innerText":"textContent"].replace(m,"").length==0&&s.children.length==0){o=s.parentNode;d.remove(s);while(o.childNodes.length==0&&new RegExp(u.join("|"),"i").test(o.tagName)){s=o;o=o.parentNode;d.remove(s)}}}}},isEmptyNode:function(k){var l=k.firstChild;return !l||d.getChildCount(k,function(m){return !d.isBr(m)&&!d.isBookmarkNode(m)&&!d.isWhitespace(m)})==0},clearSelectedArr:function(k){var l;while(l=k.pop()){d.removeAttributes(l,["class"])}},scrollToView:function(m,t,k){var l=function(){var u=t.document,v=u.compatMode=="CSS1Compat";return{width:(v?u.documentElement.clientWidth:u.body.clientWidth)||0,height:(v?u.documentElement.clientHeight:u.body.clientHeight)||0}},s=function(v){if("pageXOffset" in v){return{x:v.pageXOffset||0,y:v.pageYOffset||0}}else{var u=v.document;return{x:u.documentElement.scrollLeft||u.body.scrollLeft||0,y:u.documentElement.scrollTop||u.body.scrollTop||0}}};var q=l().height,r=q*-1+k;r+=(m.offsetHeight||0);var n=d.getXY(m);r+=n.y;var o=s(t).y;if(r>o||r<o-q){t.scrollTo(0,r+(r<0?-20:20))}},isBr:function(k){return k.nodeType==1&&k.tagName=="BR"},isFillChar:function(l){var k=new RegExp(d.fillChar);return l.nodeType==3&&!l.nodeValue.replace(k,"").length},isStartInblock:function(l){var q=l.cloneRange(),k=0,r=q.startContainer,m;while(r&&d.isFillChar(r)){m=r;r=r.previousSibling}if(m){q.setStartBefore(m);r=q.startContainer}if(r.nodeType==1&&d.isEmptyNode(r)&&q.startOffset==1){q.setStart(r,0).collapse(true)}while(!q.startOffset){r=q.startContainer;if(d.isBlockElm(r)||d.isBody(r)){k=1;break}var o=q.startContainer.previousSibling,n;if(!o){q.setStartBefore(q.startContainer)}else{while(o&&d.isFillChar(o)){n=o;o=o.previousSibling}if(n){q.setStartBefore(n)}else{q.setStartBefore(q.startContainer)}}}return k&&!d.isBody(q.startContainer)?1:0},isEmptyBlock:function(l){var k=new RegExp("[ \t\r\n"+d.fillChar+"]","g");if(l[f.ie?"innerText":"textContent"].replace(k,"").length>0){return 0}for(var m in a.$isNotEmpty){if(l.getElementsByTagName(m).length){return 0}}return 1},setViewportOffset:function(k,r){var q=parseInt(k.style.left)|0;var o=parseInt(k.style.top)|0;var m=k.getBoundingClientRect();var n=r.left-m.left;var l=r.top-m.top;if(n){k.style.left=q+n+"px"}if(l){k.style.top=o+l+"px"}},fillNode:function(l,k){k.appendChild(f.ie?l.createTextNode(d.fillChar):l.createElement("br"))},moveChild:function(m,k,l){while(m.firstChild){if(l&&k.firstChild){k.insertBefore(m.lastChild,k.firstChild)}else{k.appendChild(m.firstChild)}}}}})();baidu.editor.dom.Range=baidu.editor.dom.Range||{};(function(){var h=baidu.editor,g=h.browser,e=h.dom.domUtils,a=h.dom.dtd,k=h.utils,i=0,j=e.fillChar;var c=function(m){m.collapsed=m.startContainer&&m.endContainer&&m.startContainer===m.endContainer&&m.startOffset==m.endOffset},b=function(n,o,q,m){if(o.nodeType==1&&(a.$empty[o.tagName]||a.$nonChild[o.tagName])){q=e.getNodeIndex(o)+(n?0:1);o=o.parentNode}if(n){m.startContainer=o;m.startOffset=q;if(!m.endContainer){m.collapse(true)}}else{m.endContainer=o;m.endOffset=q;if(!m.startContainer){m.collapse(false)}}c(m);return m},l=function(t,x){var r=t.startContainer,q=t.endContainer,z=t.startOffset,s=t.endOffset,F=t.document,m=F.createDocumentFragment(),u,w;if(r.nodeType==1){r=r.childNodes[z]||(u=r.appendChild(F.createTextNode("")))}if(q.nodeType==1){q=q.childNodes[s]||(w=q.appendChild(F.createTextNode("")))}if(r===q&&r.nodeType==3){m.appendChild(F.createTextNode(r.substringData(z,s-z)));if(x){r.deleteData(z,s-z);t.collapse(true)}return m}var v,B,D=m,C=e.findParents(r,true),n=e.findParents(q,true);for(var A=0;C[A]==n[A];A++){}for(var y=A,E;E=C[y];y++){v=E.nextSibling;if(E==r){if(!u){if(t.startContainer.nodeType==3){D.appendChild(F.createTextNode(r.nodeValue.slice(z)));if(x){r.deleteData(z,r.nodeValue.length-z)}}else{D.appendChild(!x?r.cloneNode(true):r)}}}else{B=E.cloneNode(false);D.appendChild(B)}while(v){if(v===q||v===n[y]){break}E=v.nextSibling;D.appendChild(!x?v.cloneNode(true):v);v=E}D=B}D=m;if(!C[A]){D.appendChild(C[A-1].cloneNode(false));D=D.firstChild}for(var y=A,o;o=n[y];y++){v=o.previousSibling;if(o==q){if(!w&&t.endContainer.nodeType==3){D.appendChild(F.createTextNode(q.substringData(0,s)));if(x){q.deleteData(0,s)}}}else{B=o.cloneNode(false);D.appendChild(B)}if(y!=A||!C[A]){while(v){if(v===r){break}o=v.previousSibling;D.insertBefore(!x?v.cloneNode(true):v,D.firstChild);v=o}}D=B}if(x){t.setStartBefore(!n[A]?n[A-1]:!C[A]?C[A-1]:n[A]).collapse(true)}u&&e.remove(u);w&&e.remove(w);return m};var d=baidu.editor.dom.Range=function(m){var n=this;n.startContainer=n.startOffset=n.endContainer=n.endOffset=null;n.document=m;n.collapsed=true};function f(o){var n=o.parentNode,m;e.remove(o);while(n&&a.$removeEmpty[n.tagName]&&n.childNodes.length==0){m=n;e.remove(n);n=m.parentNode}}d.prototype={cloneContents:function(){return this.collapsed?null:l(this,0)},deleteContents:function(){if(!this.collapsed){l(this,1)}if(g.webkit){var m=this.startContainer;if(m.nodeType==3&&!m.nodeValue.length){this.setStartBefore(m).collapse(true);e.remove(m)}}return this},extractContents:function(){return this.collapsed?null:l(this,2)},setStart:function(m,n){return b(true,m,n,this)},setEnd:function(m,n){return b(false,m,n,this)},setStartAfter:function(m){return this.setStart(m.parentNode,e.getNodeIndex(m)+1)},setStartBefore:function(m){return this.setStart(m.parentNode,e.getNodeIndex(m))},setEndAfter:function(m){return this.setEnd(m.parentNode,e.getNodeIndex(m)+1)},setEndBefore:function(m){return this.setEnd(m.parentNode,e.getNodeIndex(m))},selectNode:function(m){return this.setStartBefore(m).setEndAfter(m)},selectNodeContents:function(m){return this.setStart(m,0).setEnd(m,m.nodeType==3?m.nodeValue.length:m.childNodes.length)},cloneRange:function(){var n=this,m=new d(n.document);return m.setStart(n.startContainer,n.startOffset).setEnd(n.endContainer,n.endOffset)},collapse:function(m){var n=this;if(m){n.endContainer=n.startContainer;n.endOffset=n.startOffset}else{n.startContainer=n.endContainer;n.startOffset=n.endOffset}n.collapsed=true;return n},shrinkBoundary:function(n){var m=this,q,o=m.collapsed;while(m.startContainer.nodeType==1&&(q=m.startContainer.childNodes[m.startOffset])&&q.nodeType==1&&!e.isBookmarkNode(q)&&!a.$empty[q.tagName]&&!a.$nonChild[q.tagName]){m.setStart(q,0)}if(o){return m.collapse(true)}if(!n){while(m.endContainer.nodeType==1&&m.endOffset>0&&(q=m.endContainer.childNodes[m.endOffset-1])&&q.nodeType==1&&!e.isBookmarkNode(q)&&!a.$empty[q.tagName]&&!a.$nonChild[q.tagName]){m.setEnd(q,q.childNodes.length)}}return m},getCommonAncestor:function(n,o){var q=this.startContainer,m=this.endContainer;if(q===m){if(n&&q.nodeType==1&&this.startOffset==this.endOffset-1){return q.childNodes[this.startOffset]}return o&&q.nodeType==3?q.parentNode:q}return e.getCommonAncestor(q,m)},trimBoundary:function(n){this.txtToElmBoundary();var s=this.startContainer,r=this.startOffset,q=this.collapsed,m=this.endContainer;if(s.nodeType==3){if(r==0){this.setStartBefore(s)}else{if(r>=s.nodeValue.length){this.setStartAfter(s)}else{var o=e.split(s,r);if(s===m){this.setEnd(o,this.endOffset-r)}else{if(s.parentNode===m){this.endOffset+=1}}this.setStartBefore(o)}}if(q){return this.collapse(true)}}if(!n){r=this.endOffset;m=this.endContainer;if(m.nodeType==3){if(r==0){this.setEndBefore(m)}else{if(r>=m.nodeValue.length){this.setEndAfter(m)}else{e.split(m,r);this.setEndAfter(m)}}}}return this},txtToElmBoundary:function(){function m(o,s){var n=o[s+"Container"],q=o[s+"Offset"];if(n.nodeType==3){if(!q){o["set"+s.replace(/(\w)/,function(r){return r.toUpperCase()})+"Before"](n)}else{if(q>=n.nodeValue.length){o["set"+s.replace(/(\w)/,function(r){return r.toUpperCase()})+"After"](n)}}}}if(!this.collapsed){m(this,"start");m(this,"end")}return this},insertNode:function(o){var r=o,n=1;if(o.nodeType==11){r=o.firstChild;n=o.childNodes.length}this.trimBoundary(true);var s=this.startContainer,q=this.startOffset;var m=s.childNodes[q];if(m){s.insertBefore(o,m)}else{s.appendChild(o)}if(r.parentNode===this.endContainer){this.endOffset=this.endOffset+n}return this.setStartBefore(r)},setCursor:function(n,m){return this.collapse(n?false:true).select(m)},createBookmark:function(o,q){var m,n=this.document.createElement("span");n.style.cssText="display:none;line-height:0px;";n.appendChild(this.document.createTextNode("\uFEFF"));n.id="_baidu_bookmark_start_"+(q?"":i++);if(!this.collapsed){m=n.cloneNode(true);m.id="_baidu_bookmark_end_"+(q?"":i++)}this.insertNode(n);if(m){this.collapse(false).insertNode(m);this.setEndBefore(m)}this.setStartAfter(n);return{start:o?n.id:n,end:m?o?m.id:m:null,id:o}},moveToBookmark:function(n){var o=n.id?this.document.getElementById(n.start):n.start,m=n.end&&n.id?this.document.getElementById(n.end):n.end;this.setStartBefore(o);e.remove(o);if(m){this.setEndBefore(m);e.remove(m)}else{this.collapse(true)}return this},enlarge:function(n,r){var m=e.isBody,s,q,o=this.document.createTextNode("");if(n){q=this.startContainer;if(q.nodeType==1){if(q.childNodes[this.startOffset]){s=q=q.childNodes[this.startOffset]}else{q.appendChild(o);s=q=o}}else{s=q}while(1){if(e.isBlockElm(q)){q=s;while((s=q.previousSibling)&&!e.isBlockElm(s)){q=s}this.setStartBefore(q);break}s=q;q=q.parentNode}q=this.endContainer;if(q.nodeType==1){if(s=q.childNodes[this.endOffset]){q.insertBefore(o,s)}else{q.appendChild(o)}s=q=o}else{s=q}while(1){if(e.isBlockElm(q)){q=s;while((s=q.nextSibling)&&!e.isBlockElm(s)){q=s}this.setEndAfter(q);break}s=q;q=q.parentNode}if(o.parentNode===this.endContainer){this.endOffset--}e.remove(o)}if(!this.collapsed){while(this.startOffset==0){if(r&&r(this.startContainer)){break}if(m(this.startContainer)){break}this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(r&&r(this.endContainer)){break}if(m(this.endContainer)){break}this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!e.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!e.isBody(this.endContainer)&&!this.endOffset){this.setEndBefore(this.endContainer)}}return this},applyInlineStyle:function(o,A,w){if(this.collapsed){return this}this.trimBoundary().enlarge(false,function(E){return E.nodeType==1&&e.isBlockElm(E)}).adjustmentBoundary();var x=this.createBookmark(),s=x.end,C=function(E){return E.nodeType==1?E.tagName.toLowerCase()!="br":!e.isWhitespace(E)},v=e.getNextDomNode(x.start,false,C),q,r,u=this.cloneRange();while(v&&(e.getPosition(v,s)&e.POSITION_PRECEDING)){if(v.nodeType==3||a[o][v.tagName]){u.setStartBefore(v);q=v;while(q&&(q.nodeType==3||a[o][q.tagName])&&q!==s){r=q;q=e.getNextDomNode(q,q.nodeType==1,null,function(E){return a[o][E.tagName]})}var B=u.setEndAfter(r).extractContents(),y;if(w&&w.length>0){var m,z;z=m=w[0].cloneNode(false);for(var t=1,D;D=w[t++];){m.appendChild(D.cloneNode(false));m=m.firstChild}y=m}else{y=u.document.createElement(o)}if(A){e.setAttributes(y,A)}y.appendChild(B);u.insertNode(w?z:y);var n;if(o=="span"&&A.style&&/text\-decoration/.test(A.style)&&(n=e.findParentByTagName(y,"a",true))){e.setAttributes(n,A);e.remove(y,true);y=n}else{e.mergSibling(y);e.clearEmptySibling(y)}e.mergChild(y,o,A);v=e.getNextDomNode(y,false,C);e.mergToParent(y);if(q===s){break}}else{v=e.getNextDomNode(v,true,C)}}return this.moveToBookmark(x)},removeInlineStyle:function(n){if(this.collapsed){return this}n=k.isArray(n)?n:[n];this.shrinkBoundary().adjustmentBoundary();var u=this.startContainer,m=this.endContainer;while(1){if(u.nodeType==1){if(k.indexOf(n,u.tagName.toLowerCase())>-1){break}if(u.tagName.toLowerCase()=="body"){u=null;break}}u=u.parentNode}while(1){if(m.nodeType==1){if(k.indexOf(n,m.tagName.toLowerCase())>-1){break}if(m.tagName.toLowerCase()=="body"){m=null;break}}m=m.parentNode}var q=this.createBookmark(),t,s;if(u){s=this.cloneRange().setEndBefore(q.start).setStartBefore(u);t=s.extractContents();s.insertNode(t);e.clearEmptySibling(u,true);u.parentNode.insertBefore(q.start,u)}if(m){s=this.cloneRange().setStartAfter(q.end).setEndAfter(m);t=s.extractContents();s.insertNode(t);e.clearEmptySibling(m,false,true);m.parentNode.insertBefore(q.end,m.nextSibling)}var r=e.getNextDomNode(q.start,false,function(v){return v.nodeType==1}),o;while(r&&r!==q.end){o=e.getNextDomNode(r,true,function(v){return v.nodeType==1});if(k.indexOf(n,r.tagName.toLowerCase())>-1){e.remove(r,true)}r=o}return this.moveToBookmark(q)},getClosedNode:function(){var n;if(!this.collapsed){var m=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(m.startContainer.nodeType==1&&m.startContainer===m.endContainer&&m.endOffset-m.startOffset==1){var o=m.startContainer.childNodes[m.startOffset];if(o&&o.nodeType==1&&(a.$empty[o.tagName]||a.$nonChild[o.tagName])){n=o}}}return n},select:g.ie?function(m,y){var u;if(!this.collapsed){this.shrinkBoundary()}var q=this.getClosedNode();if(q&&!y){try{u=this.document.body.createControlRange();u.addElement(q);u.select()}catch(v){}return this}var w=this.createBookmark(),o=w.start,r;u=this.document.body.createTextRange();u.moveToElementText(o);u.moveStart("character",1);if(!this.collapsed){var t=this.document.body.createTextRange();r=w.end;t.moveToElementText(r);u.setEndPoint("EndToEnd",t)}else{if(!m&&this.startContainer.nodeType!=3){var n=h.fillData,x,s=this.document.createElement("span");try{if(n&&n.parentNode&&!n.nodeValue.replace(new RegExp(e.fillChar,"g"),"").length){f(n)}}catch(v){}x=h.fillData=this.document.createTextNode(j);s.appendChild(this.document.createTextNode(j));o.parentNode.insertBefore(s,o);o.parentNode.insertBefore(x,o);u.moveStart("character",-1);u.collapse(true)}}this.moveToBookmark(w);s&&e.remove(s);u.select();return this}:function(o){var t=e.getWindow(this.document),s=t.getSelection(),r;g.gecko?this.document.body.focus():t.focus();function n(u){if(u&&u.nodeType==3&&!u.nodeValue.replace(new RegExp(e.fillChar,"g"),"").length){e.remove(u)}}if(s){s.removeAllRanges();if(this.collapsed&&!o){var m=h.fillData;r=this.document.createTextNode(j);h.fillData=r;this.insertNode(r);if(m&&m.parentNode){if(!m.nodeValue.replace(new RegExp(e.fillChar,"g"),"").length){f(m)}else{m.nodeValue=m.nodeValue.replace(new RegExp(e.fillChar,"g"),"")}}n(r.previousSibling);n(r.nextSibling);this.setStart(r,g.webkit?1:0).collapse(true)}var q=this.document.createRange();q.setStart(this.startContainer,this.startOffset);q.setEnd(this.endContainer,this.endOffset);s.addRange(q)}return this},scrollToView:function(o,q){o=o?window:e.getWindow(this.document);var m=this.document.createElement("span");m.innerHTML="&nbsp;";var n=this.cloneRange();n.insertNode(m);e.scrollToView(m,o,q);e.remove(m);return this}}})();baidu.editor.dom.Selection=baidu.editor.dom.Selection||{};(function(){baidu.editor.dom.Selection=b;var a=baidu.editor.dom.domUtils,e=baidu.editor.dom.dtd,g=baidu.editor.browser.ie;function f(s,j){var k=a.getNodeIndex;s=s.duplicate();s.collapse(j);var w=s.parentElement();if(!w.hasChildNodes()){return{container:w,offset:0}}var v=w.children,l,n=s.duplicate(),x=0,r=v.length-1,t=-1,h;while(x<=r){t=Math.floor((x+r)/2);l=v[t];n.moveToElementText(l);var q=n.compareEndPoints("StartToStart",s);if(q>0){r=t-1}else{if(q<0){x=t+1}else{return{container:w,offset:k(l)}}}}if(t==-1){n.moveToElementText(w);n.setEndPoint("StartToStart",s);h=n.text.replace(/(\r\n|\r)/g,"\n").length;v=w.childNodes;if(!h){l=v[v.length-1];return{container:l,offset:l.nodeValue.length}}var o=v.length;while(h>0){h-=v[--o].nodeValue.length}return{container:v[o],offset:-h}}n.collapse(q>0);n.setEndPoint(q>0?"StartToStart":"EndToStart",s);h=n.text.replace(/(\r\n|\r)/g,"\n").length;if(!h){return e.$empty[l.tagName]||e.$nonChild[l.tagName]?{container:w,offset:k(l)+(q>0?0:1)}:{container:l,offset:q>0?0:l.childNodes.length}}while(h>0){try{var m=l;l=l[q>0?"previousSibling":"nextSibling"];h-=l.nodeValue.length}catch(u){return{container:w,offset:k(m)}}}return{container:l,offset:q>0?-h:l.nodeValue.length+h}}function d(j,i){if(j.item){i.selectNode(j.item(0))}else{var h=f(j,true);i.setStart(h.container,h.offset);if(j.compareEndPoints("StartToEnd",j)!=0){h=f(j,false);i.setEnd(h.container,h.offset)}}return i}function c(j){var i;try{i=j.getNative().createRange()}catch(k){return null}var h=i.item?i.item(0):i.parentElement();if((h.ownerDocument||h)===j.document){return i}return null}function b(j){var i=this,h;i.document=j;if(g){h=a.getWindow(j).frameElement;a.on(h,"beforedeactivate",function(){i._bakIERange=i.getIERange()});a.on(h,"activate",function(){try{if(!c(i)&&i._bakIERange){i._bakIERange.select()}}catch(k){}i._bakIERange=null})}h=j=null}b.prototype={getNative:function(){if(!this.document){return null}if(g){return this.document.selection}else{return a.getWindow(this.document).getSelection()}},getIERange:function(){var h=c(this);if(!h){if(this._bakIERange){return this._bakIERange}}return h},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart()},clear:function(){this._cachedRange=this._cachedStartElement=null},getRange:function(){var k=this;function j(o){var r=k.document.body.firstChild,q=o.collapsed;while(r&&r.firstChild){o.setStart(r,0);r=r.firstChild}if(!o.startContainer){o.setStart(k.document.body,0)}if(q){o.collapse(true)}}if(k._cachedRange!=null){return this._cachedRange}var i=new baidu.editor.dom.Range(k.document);if(g){var m=k.getIERange();if(m){d(m,i)}else{j(i)}}else{var l=k.getNative();if(l&&l.rangeCount){var h=l.getRangeAt(0);var n=l.getRangeAt(l.rangeCount-1);i.setStart(h.startContainer,h.startOffset).setEnd(n.endContainer,n.endOffset);if(i.collapsed&&a.isBody(i.startContainer)&&!i.startOffset){j(i)}}else{j(i)}}return i},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var h=g?this.getIERange():this.getRange(),k,l,i,j;if(g){if(!h){return this.document.body.firstChild}if(h.item){return h.item(0)}k=h.duplicate();k.text.length>0&&k.moveStart("character",1);k.collapse(1);l=k.parentElement();j=i=h.parentElement();while(i=i.parentNode){if(i==l){l=j;break}}}else{h.shrinkBoundary();l=h.startContainer;if(l.nodeType==1&&l.hasChildNodes()){l=l.childNodes[Math.min(l.childNodes.length-1,h.startOffset)]}if(l.nodeType==3){return l.parentNode}}return l},getText:function(){var h=this.getNative(),i;if(h){i=baidu.editor.browser.ie?h.createRange():h.getRangeAt(0)}else{return""}return i.text||i.toString()}}})();(function(){baidu.editor.Editor=g;var h=baidu.editor,j=h.utils,e=h.EventBase,d=h.dom.domUtils,l=h.dom.Selection,b=h.browser.ie,i=0,f=h.browser,a=h.dom.dtd,c;function k(t){var s=t.getElementsByTagName("img"),r;for(var q=0,o;o=s[q++];){if(r=o.getAttribute("orgSrc")){o.src=r;o.removeAttribute("orgSrc")}}var n=t.getElementsByTagName("a");for(var q=0,m;m=n[q++];q++){if(m.getAttribute("data_ue_src")){m.setAttribute("href",m.getAttribute("data_ue_src"))}}}function g(m){var n=this;n.uid=i++;e.call(n);n.commands={};n.options=j.extend(m||{},UEDITOR_CONFIG,true);n.initPlugins()}g.prototype={destroy:function(){this.fireEvent("destroy");this.container.innerHTML="";d.remove(this.container)},render:function(m){if(m.constructor===String){m=document.getElementById(m)}if(m){m.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%" scroll="no" frameborder="0"></iframe>';m.style.overflow="hidden";this._setup(m.firstChild.contentWindow.document)}},_setup:function(s){var n=this.options,r=this;!f.webkit&&s.open();var m=b&&f.version<9;s.write((b&&f.version<9?"":"<!DOCTYPE html>")+'<html xmlns="http://www.w3.org/1999/xhtml"'+(!m?' class="view"':"")+"><head>"+(n.iframeCssUrl?'<link rel="stylesheet" type="text/css" href="'+j.unhtml(/^http/.test(n.iframeCssUrl)?n.iframeCssUrl:(n.UEDITOR_HOME_URL+n.iframeCssUrl))+'"/>':"")+'<style type="text/css">'+(n.initialStyle||" ")+"</style></head><body"+(m?' class="view"':"")+"></body></html>");!f.webkit&&s.close();if(b){s.body.disabled=true;s.body.contentEditable=true;s.body.disabled=false}else{s.body.contentEditable=true;s.body.spellcheck=false}this.document=s;this.window=s.defaultView||s.parentWindow;this.iframe=this.window.frameElement;this.body=s.body;if(this.options.minFrameHeight){this.setHeight(this.options.minFrameHeight);this.body.style.height=this.options.minFrameHeight}this.selection=new l(s);this._initEvents();if(r.options.initialContent){if(r.options.autoClearinitialContent){var o=r.execCommand;r.execCommand=function(){r.fireEvent("firstBeforeExecCommand");o.apply(r,arguments)};this.setDefaultContent(this.options.initialContent)}else{this.setContent(this.options.initialContent,true)}}for(var q=this.iframe.parentNode;!d.isBody(q);q=q.parentNode){if(q.tagName=="FORM"){d.on(q,"submit",function(){var t=document.getElementById("ueditor_textarea_"+r.options.textarea);if(!t){t=document.createElement("textarea");t.setAttribute("name",r.options.textarea);t.id="ueditor_textarea_"+r.options.textarea;t.style.display="none";this.appendChild(t)}t.value=r.getContent()});break}}if(d.isEmptyNode(r.body)){this.body.innerHTML="<p>"+(f.ie?d.fillChar:"<br/>")+"</p>"}if(r.options.focus){setTimeout(function(){r.selection.getRange().setStartBefore(r.body.firstChild).setCursor(false,true);!r.options.autoClearinitialContent&&r._selectionChange()})}if(!this.container){this.container=this.iframe.parentNode}this.fireEvent("ready");if(f.gecko&&f.version<=10902){setInterval(function(){r.body.style.height=r.iframe.offsetHeight-20+"px"},100)}},sync:function(q){var n=this,m;function o(s){var r=document.getElementById("ueditor_textarea_"+n.options.textarea);if(!r){r=document.createElement("textarea");r.setAttribute("name",n.options.textarea);r.id="ueditor_textarea_"+n.options.textarea;r.style.display="none";s.appendChild(r)}r.value=n.getContent()}if(q){m=document.getElementById(q);m&&o(m)}else{for(m=n.iframe.parentNode;!d.isBody(m);m=m.parentNode){if(m.tagName=="FORM"){o(m);break}}}},setHeight:function(m){if(m!==parseInt(this.iframe.parentNode.style.height)){this.iframe.parentNode.style.height=m+"px"}if(f.ie&&f.version==9){this.document.body.style.height=m-20+"px"}},getContent:function(q){this.fireEvent("beforegetcontent",q);var n=new RegExp(d.fillChar,"g"),m=this.document.body.innerHTML.replace(n,"");this.fireEvent("aftergetcontent",q);if(this.serialize){var o=this.serialize.parseHTML(m);o=this.serialize.transformOutput(o);m=this.serialize.toHTML(o)}return m},getContentTxt:function(){var m=new RegExp(d.fillChar,"g");return this.body[f.ie?"innerText":"textContent"].replace(m,"")},setContent:function(n,m){var s=this;s.fireEvent("beforesetcontent");var q=this.serialize;if(q){var r=q.parseHTML(n);r=q.transformInput(r);r=q.filter(r);n=q.toHTML(r)}this.document.body.innerHTML=n.replace(new RegExp("[\r"+d.fillChar+"]*","g"),"");if(f.ie&&f.version<7&&s.options.relativePath){k(this.document.body)}if(s.options.enterTag=="p"){var u=this.body.firstChild,t=s.document.createElement("p"),o;if(!u||u.nodeType==1&&a.$cdata[u.tagName]){this.body.innerHTML="<p>"+(f.ie?"":"<br/>")+"</p>"+this.body.innerHTML}else{while(u){if(u.nodeType==3||u.nodeType==1&&a.p[u.tagName]){o=u.nextSibling;t.appendChild(u);u=o;if(!u){s.body.appendChild(t)}}else{if(t.firstChild){s.body.insertBefore(t,u);t=s.document.createElement("p")}u=u.nextSibling}}}}s.adjustTable&&s.adjustTable(s.body);s.fireEvent("aftersetcontent");!m&&s._selectionChange()},focus:function(){f.gecko?this.body.focus():d.getWindow(this.document).focus()},initPlugins:function(n){var q,m=baidu.editor.plugins;if(n){for(var o=0,r;r=n[o++];){if(j.indexOf(this.options.plugins,r)==-1&&(q=baidu.editor.plugins[r])){this.options.plugins.push(r);q.call(this)}}}else{n=this.options.plugins;if(n){for(o=0;r=m[n[o++]];){r.call(this)}}else{this.options.plugins=[];for(r in m){this.options.plugins.push(r);m[r].call(this)}}}},_initEvents:function(){var n=this,s=n.document,r=n.window;n._proxyDomEvent=j.bind(n._proxyDomEvent,n);d.on(s,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],n._proxyDomEvent);d.on(r,["focus","blur"],n._proxyDomEvent);d.on(s,["mouseup","keydown"],function(t){if(t.type=="keydown"&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)){return}if(t.button==2){return}n._selectionChange(250,t)});var m=0,o=f.ie?n.body:n.document,q;d.on(o,"dragstart",function(){m=1});d.on(o,f.webkit?"dragover":"drop",function(){return f.webkit?function(){clearTimeout(q);q=setTimeout(function(){if(!m){var x=n.selection,t=x.getRange();if(t){var u=t.getCommonAncestor();if(u&&n.serialize){var w=n.serialize,v=w.filter(w.transformInput(w.parseHTML(w.word(u.innerHTML))));u.innerHTML=w.toHTML(v)}}}m=0},200)}:function(t){if(!m){t.preventDefault?t.preventDefault():(t.returnValue=false)}m=0}}())},_proxyDomEvent:function(m){return this.fireEvent(m.type.replace(/^on/,""),m)},_selectionChange:function(q,m){var t=this;var s=false;var r,o;if(f.ie&&f.version<9&&m&&m.type=="mouseup"){var n=this.selection.getRange();if(!n.collapsed){s=true;r=m.clientX;o=m.clientY}}clearTimeout(c);c=setTimeout(function(){if(!t.selection.getNative()){return}var v;if(s&&t.selection.getNative().type=="None"){v=t.document.body.createTextRange();try{v.moveToPoint(r,o)}catch(u){v=null}}var w;if(v){w=t.selection.getIERange;t.selection.getIERange=function(){return v}}t.selection.cache();if(w){t.selection.getIERange=w}if(t.selection._cachedRange&&t.selection._cachedStartElement){t.fireEvent("beforeselectionchange");t.fireEvent("selectionchange",!!m);t.fireEvent("afterselectionchange");t.selection.clear()}},q||50)},_callCmdFn:function(r,n){var m=n[0].toLowerCase(),q,o;o=(q=this.commands[m])&&q[r]||(q=baidu.editor.commands[m])&&q[r];if(q&&!o&&r=="queryCommandState"){return false}else{if(o){return o.apply(this,n)}}},execCommand:function(n){n=n.toLowerCase();var o=this,m,q=o.commands[n]||baidu.editor.commands[n];if(!q||!q.execCommand){return}if(!q.notNeedUndo&&!o.__hasEnterExecCommand){o.__hasEnterExecCommand=true;o.fireEvent("beforeexeccommand",n);m=this._callCmdFn("execCommand",arguments);o.fireEvent("afterexeccommand",n);o.__hasEnterExecCommand=false}else{m=this._callCmdFn("execCommand",arguments)}o._selectionChange();return m},queryCommandState:function(m){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(m){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(m){if(m){for(var o=0,n;n=m[o++];){if(this.document.getElementsByTagName(n).length>0){return true}}}if(!d.isEmptyBlock(this.body)){return true}return false},reset:function(){this.fireEvent("reset")},setDefaultContent:function(){function m(){var o=this;if(o.document.getElementById("initContent")){o.document.body.innerHTML="<p>"+(baidu.editor.browser.ie?"":"<br/>")+"</p>";var n=o.selection.getRange();o.removeListener("firstBeforeExecCommand",m);o.removeListener("mousedown",m);setTimeout(function(){n.setStart(o.document.body.firstChild,0).collapse(true).select(true);o._selectionChange()})}}return function(n){var o=this;o.document.body.innerHTML='<p id="initContent">'+n+"</p>";if(f.ie&&f.version<7&&o.options.relativePath){k(o.document.body)}o.addListener("firstBeforeExecCommand",m);o.addListener("mousedown",m)}}()};j.inherits(g,e)})();(function(){var b=baidu.editor.dom.domUtils,c=baidu.editor.browser,a=baidu.editor.dom.dtd,g=baidu.editor.utils,e=0,h=b.keys,i={B:"strong",I:"em",FONT:"span"},d=[0,10,12,16,18,24,32,48],f={OL:["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman"],UL:["circle","disc","square"]};baidu.editor.plugins.keystrokes=function(){var j=this;j.addListener("keydown",function(l,y){var r=y.keyCode||y.which;if(r==8){var v=j.selection.getRange(),F,n,m;if(v.collapsed){n=v.startContainer;if(b.isWhitespace(n)){n=n.parentNode}if(b.isEmptyNode(n)&&n===j.body.firstChild){if(n.tagName!="P"){p=j.document.createElement("p");j.body.insertBefore(p,n);b.fillNode(j.document,p);v.setStart(p,0).setCursor(false,true)}b.preventDefault(y);return}}if(v.collapsed&&v.startContainer.nodeType==3&&v.startContainer.nodeValue.replace(new RegExp(b.fillChar,"g"),"").length==0){v.setStartBefore(v.startContainer).collapse(true)}if(n=v.getClosedNode()){j.undoManger&&j.undoManger.save();v.setStartBefore(n);b.remove(n);v.setCursor();j.undoManger&&j.undoManger.save();b.preventDefault(y);return}if(!c.ie){n=b.findParentByTagName(v.startContainer,"table",true);m=b.findParentByTagName(v.endContainer,"table",true);if(n&&!m||!n&&m||n!==m){y.preventDefault();return}if(c.webkit&&v.collapsed&&n){F=v.cloneRange().txtToElmBoundary();n=F.startContainer;if(b.isBlockElm(n)&&n.nodeType==1&&!a.$tableContent[n.tagName]&&!b.getChildCount(n,function(G){return G.nodeType==1?G.tagName!=="BR":1})){F.setStartBefore(n).setCursor();b.remove(n,true);y.preventDefault();return}}}if(j.undoManger){if(!v.collapsed){j.undoManger.save();e=1}}}if(r==9){v=j.selection.getRange();j.undoManger&&j.undoManger.save();for(var D=0,w="";D<j.options.tabSize;D++){w+=j.options.tabNode}var C=j.document.createElement("span");C.innerHTML=w;if(v.collapsed){li=b.findParentByTagName(v.startContainer,"li",true);if(li&&b.isStartInblock(v)){k=v.createBookmark();var B=li.parentNode,E=j.document.createElement(B.tagName);var o=g.indexOf(f[E.tagName],b.getComputedStyle(B,"list-style-type"));o=o+1==f[E.tagName].length?0:o+1;b.setStyle(E,"list-style-type",f[E.tagName][o]);B.insertBefore(E,li);E.appendChild(li);v.moveToBookmark(k).select()}else{v.insertNode(C.cloneNode(true).firstChild).setCursor(true)}}else{n=b.findParentByTagName(v.startContainer,"table",true);m=b.findParentByTagName(v.endContainer,"table",true);if(n||m){y.preventDefault?y.preventDefault():(y.returnValue=false);return}n=b.findParentByTagName(v.startContainer,["ol","ul"],true);m=b.findParentByTagName(v.endContainer,["ol","ul"],true);if(n&&m&&n===m){var k=v.createBookmark();n=b.findParentByTagName(v.startContainer,"li",true);m=b.findParentByTagName(v.endContainer,"li",true);if(n===n.parentNode.firstChild){var u=j.document.createElement(n.parentNode.tagName);n.parentNode.parentNode.insertBefore(u,n.parentNode);u.appendChild(n.parentNode)}else{B=n.parentNode,E=j.document.createElement(B.tagName);o=g.indexOf(f[E.tagName],b.getComputedStyle(B,"list-style-type"));o=o+1==f[E.tagName].length?0:o+1;b.setStyle(E,"list-style-type",f[E.tagName][o]);n.parentNode.insertBefore(E,n);var t;while(n!==m){t=n.nextSibling;E.appendChild(n);n=t}E.appendChild(m)}v.moveToBookmark(k).select()}else{if(n||m){y.preventDefault?y.preventDefault():(y.returnValue=false);return}n=b.findParent(v.startContainer,x);m=b.findParent(v.endContainer,x);if(n&&m&&n===m){v.deleteContents();v.insertNode(C.cloneNode(true).firstChild).setCursor(true)}else{var q=v.createBookmark(),x=function(G){return b.isBlockElm(G)};v.enlarge(true);var A=v.createBookmark(),z=b.getNextDomNode(A.start,false,x);while(z&&!(b.getPosition(z,A.end)&b.POSITION_FOLLOWING)){z.insertBefore(C.cloneNode(true).firstChild,z.firstChild);z=b.getNextDomNode(z,false,x)}v.moveToBookmark(A).moveToBookmark(q).select()}}}j.undoManger&&j.undoManger.save();y.preventDefault?y.preventDefault():(y.returnValue=false)}if(c.gecko&&r==46){v=j.selection.getRange();if(v.collapsed){n=v.startContainer;if(b.isEmptyBlock(n)){var s=n.parentNode;while(b.getChildCount(s)==1&&!b.isBody(s)){n=s;s=s.parentNode}if(n===s.lastChild){y.preventDefault()}return}}}});j.addListener("keyup",function(u,x){var B=x.keyCode||x.which;if(!c.gecko&&!h[B]&&!x.ctrlKey&&!x.metaKey&&!x.shiftKey&&!x.altKey){s=j.selection.getRange();if(s.collapsed){var l=s.startContainer,m=0;while(!b.isBlockElm(l)){if(l.nodeType==1&&g.indexOf(["FONT","B","I"],l.tagName)!=-1){var n=j.document.createElement(i[l.tagName]);if(l.tagName=="FONT"){n.style.cssText=(l.getAttribute("size")?"font-size:"+(d[l.getAttribute("size")]||12)+"px":"")+";"+(l.getAttribute("color")?"color:"+l.getAttribute("color"):"")+";"+(l.getAttribute("face")?"font-family:"+l.getAttribute("face"):"")+";"+l.style.cssText}while(l.firstChild){n.appendChild(l.firstChild)}l.parentNode.insertBefore(n,l);b.remove(l);if(!m){s.setEnd(n,n.childNodes.length).collapse(true)}l=n;m=1}l=l.parentNode}m&&s.select()}}if(B==8){if(c.gecko){for(var q=0,y,A=b.getElementsByTagName(this.body,"li");y=A[q++];){if(b.isEmptyNode(y)&&!y.previousSibling){var z=y.parentNode;b.remove(y);if(b.isEmptyNode(z)){b.remove(z)}}}}var s,l,w,o=this.currentSelectedArr;if(o&&o.length>0){for(var q=0,k;k=o[q++];){k.innerHTML=c.ie?(c.version<9?"&#65279":""):"<br/>"}s=new baidu.editor.dom.Range(this.document);s.setStart(o[0],0).setCursor();if(e){j.undoManger.save();e=0}if(c.webkit){x.preventDefault()}return}s=j.selection.getRange();if(b.isEmptyBlock(j.body)&&!s.startOffset){j.body.innerHTML="<p>"+(c.ie?"&nbsp;":"<br/>")+"</p>";s.setStart(j.body.firstChild,0).setCursor(false,true);j.undoManger&&j.undoManger.save();c.ie&&j._selectionChange();return}l=s.startContainer;if(b.isWhitespace(l)){l=l.parentNode}var t=0;while(l.nodeType==1&&b.isEmptyNode(l)&&a.$removeEmpty[l.tagName]){t=1;w=l.parentNode;b.remove(l);l=w}if(t&&l.nodeType==1&&b.isEmptyNode(l)){if(c.ie){var v=s.document.createElement("span");l.appendChild(v);s.setStart(l,0).setCursor();y=b.findParentByTagName(l,"li",true);if(y){var r=y.nextSibling;while(r){if(b.isEmptyBlock(r)){y=r;r=r.nextSibling;b.remove(y);continue}break}}}else{l.innerHTML="<br/>";s.setStart(l,0).setCursor(false,true)}setTimeout(function(){if(c.ie){b.remove(v)}if(e){j.undoManger.save();e=0}},0)}else{if(e){j.undoManger.save();e=0}}}})}})();baidu.editor.plugins.fiximgclick=function(){var b=this,a=baidu.editor.browser;if(a.webkit){b.addListener("click",function(d,f){if(f.target.tagName=="IMG"){var c=new baidu.editor.dom.Range(b.document);c.selectNode(f.target).select()}})}};var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){var d=baidu.editor.browser,c=baidu.editor.dom.domUtils;var g="$EDITORUI";var f=window[g]={};var a="ID"+g;var i=0;var b=baidu.editor.ui.uiUtils={uid:function(j){return(j?j[a]||(j[a]=++i):++i)},hook:function(j,l){var k;if(j&&j._callbacks){k=j}else{k=function(){var s;if(j){s=j.apply(this,arguments)}var o=k._callbacks;var m=o.length;while(m--){var n=o[m].apply(this,arguments);if(s===undefined){s=n}}return s};k._callbacks=[]}k._callbacks.push(l);return k},createElementByHtml:function(j){var k=document.createElement("div");k.innerHTML=j;k=k.firstChild;k.parentNode.removeChild(k);return k},getViewportElement:function(){return(d.ie&&d.quirks)?document.body:document.documentElement},getClientRect:function(j){var m=j.getBoundingClientRect();var k={left:Math.round(m.left),top:Math.round(m.top),height:Math.round(m.bottom-m.top),width:Math.round(m.right-m.left)};var l;while((l=j.ownerDocument)!==document&&(j=c.getWindow(l).frameElement)){m=j.getBoundingClientRect();k.left+=m.left;k.top+=m.top}k.bottom=k.top+k.height;k.right=k.left+k.width;return k},getViewportRect:function(){var k=b.getViewportElement();var l=(window.innerWidth||k.clientWidth)|0;var j=(window.innerHeight||k.clientHeight)|0;return{left:0,top:0,height:j,width:l,bottom:j,right:l}},setViewportOffset:function(j,m){var k;var l=b.getFixedLayer();if(j.parentNode===l){j.style.left=m.left+"px";j.style.top=m.top+"px"}else{c.setViewportOffset(j,m)}},getEventOffset:function(j){var k=j.target||j.srcElement;var l=b.getClientRect(k);var m=b.getViewportOffsetByEvent(j);return{left:m.left-l.left,top:m.top-l.top}},getViewportOffsetByEvent:function(k){var l=k.target||k.srcElement;var j=c.getWindow(l).frameElement;var n={left:k.clientX,top:k.clientY};if(j&&l.ownerDocument!==document){var m=b.getClientRect(j);n.left+=m.left;n.top+=m.top}return n},setGlobal:function(k,j){f[k]=j;return g+'["'+k+'"]'},unsetGlobal:function(j){delete f[j]},copyAttributes:function(o,n){var l=n.attributes;var j=l.length;while(j--){var m=l[j];if(m.nodeName!="style"&&m.nodeName!="class"&&(!d.ie||m.specified)){o.setAttribute(m.nodeName,m.nodeValue)}}if(n.className){o.className+=" "+n.className}if(n.style.cssText){o.style.cssText+=";"+n.style.cssText}},removeStyle:function(k,j){if(k.style.removeProperty){k.style.removeProperty(j)}else{if(k.style.removeAttribute){k.style.removeAttribute(j)}else{throw""}}},contains:function(k,j){return k&&j&&(k===j?false:(k.contains?k.contains(j):k.compareDocumentPosition(j)&16))},startDrag:function(s,n){var q=document;var m=s.clientX;var l=s.clientY;function k(u){var t=u.clientX-m;var v=u.clientY-l;n.ondragmove(t,v);if(u.stopPropagation){u.stopPropagation()}else{u.cancelBubble=true}}if(q.addEventListener){function r(t){q.removeEventListener("mousemove",k,true);q.removeEventListener("mouseup",k,true);n.ondragstop()}q.addEventListener("mousemove",k,true);q.addEventListener("mouseup",r,true);s.preventDefault()}else{var o=s.srcElement;o.setCapture();function j(){o.releaseCapture();o.detachEvent("onmousemove",k);o.detachEvent("onmouseup",j);o.detachEvent("onlosecaptrue",j);n.ondragstop()}o.attachEvent("onmousemove",k);o.attachEvent("onmouseup",j);o.attachEvent("onlosecaptrue",j);s.returnValue=false}n.ondragstart()},getFixedLayer:function(){var j=document.getElementById("edui_fixedlayer");if(j==null){j=document.createElement("div");j.id="edui_fixedlayer";document.body.appendChild(j);if(d.ie&&d.version<=8){j.style.position="absolute";h();setTimeout(e)}else{j.style.position="fixed"}j.style.left="0";j.style.top="0";j.style.width="0";j.style.height="0"}return j},makeUnselectable:function(k){if(d.opera||(d.ie&&d.version<9)){k.unselectable="on";if(k.hasChildNodes()){for(var j=0;j<k.childNodes.length;j++){if(k.childNodes[j].nodeType==1){b.makeUnselectable(k.childNodes[j])}}}}else{if(k.style.MozUserSelect!==undefined){k.style.MozUserSelect="none"}else{if(k.style.WebkitUserSelect!==undefined){k.style.WebkitUserSelect="none"}else{if(k.style.KhtmlUserSelect!==undefined){k.style.KhtmlUserSelect="none"}}}}}};function e(){var j=document.getElementById("edui_fixedlayer");b.setViewportOffset(j,{left:0,top:0})}function h(j){c.on(window,"scroll",e);c.on(window,"resize",baidu.editor.utils.defer(e,0,true))}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.EventBase,d=baidu.editor.ui.UIBase=function(){};d.prototype={className:"",uiName:"",initOptions:function(f){var g=this;for(var e in f){g[e]=f[e]}this.id=this.id||"edui"+b.uid()},initUIBase:function(){this._globalKey=a.unhtml(b.setGlobal(this.id,this))},render:function(f){var e=this.renderHtml();var g=b.createElementByHtml(e);var h=this.getDom();if(h!=null){h.parentNode.replaceChild(g,h);b.copyAttributes(g,h)}else{if(typeof f=="string"){f=document.getElementById(f)}f=f||b.getFixedLayer();f.appendChild(g)}this.postRender()},getDom:function(e){if(!e){return document.getElementById(this.id)}else{return document.getElementById(this.id+"_"+e)}},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var f="edui-"+this.uiName;return(e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?f+"-":"").replace(/%%/g,(this.uiName?f:"")+" "+this.className).replace(/\$\$/g,this._globalKey))},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();if(e){baidu.editor.dom.domUtils.remove(e)}b.unsetGlobal(this.id)}};a.inherits(d,c)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.Separator=function(d){this.initOptions(d);this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};a.inherits(c,b)})();(function(){var b=baidu.editor.utils,a=baidu.editor.dom.domUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.uiUtils;var e=baidu.editor.ui.Mask=function(f){this.initOptions(f);this.initUIBase()};e.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var f=this;a.on(window,"resize",function(){setTimeout(function(){if(!f.isHidden()){f._fill()}})})},show:function(f){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=f},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_fill:function(){var f=this.getDom();var g=c.getViewportRect();f.style.width=g.width+"px";f.style.height=g.height+"px"}};b.inherits(e,d)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,h=baidu.editor.ui.UIBase,g=baidu.editor.ui.Popup=function(i){this.initOptions(i);this.initPopup()};var b=[];function f(l){var m=[];for(var k=0;k<b.length;k++){var j=b[k];if(!j.isHidden()){if(j.queryAutoHide(l)!==false){j.hide()}}}}g.postHide=f;var d=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];g.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,canSideUp:true,initPopup:function(){this.initUIBase();b.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: white;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(typeof this.content=="string"){return this.content}return this.content.renderHtml()},_UIBase_postRender:h.prototype.postRender,postRender:function(){if(this.content instanceof h){this.content.postRender()}this.hide(true);this._UIBase_postRender()},_doAutoRender:function(){if(!this.getDom()&&this.autoRender){this.render()}},mesureSize:function(){var i=this.getDom("content");return e.getClientRect(i)},fitSize:function(){var i=this.getDom("body");i.style.width="";i.style.height="";var j=this.mesureSize();i.style.width=j.width+"px";i.style.height=j.height+"px";return j},showAnchor:function(j,i){this.showAnchorRect(e.getClientRect(j),i)},showAnchorRect:function(q,m,n){this._doAutoRender();var k=e.getViewportRect();this._show();var j=this.fitSize();var r,l,i,o;if(m){r=this.canSideLeft&&(q.right+j.width>k.right&&q.left>j.width);l=this.canSideUp&&(q.top+j.height>k.bottom&&q.bottom>j.height);i=(r?q.left-j.width:q.right);o=(l?q.bottom-j.height:q.top)}else{r=this.canSideLeft&&(q.right+j.width>k.right&&q.left>j.width);l=this.canSideUp&&(q.top+j.height>k.bottom&&q.bottom>j.height);i=(r?q.right-j.width:q.left);o=(l?q.top-j.height:q.bottom)}var s=this.getDom();e.setViewportOffset(s,{left:i,top:o});a.removeClasses(s,d);s.className+=" "+d[(l?1:0)*2+(r?1:0)];if(this.editor){s.style.zIndex=this.editor.container.style.zIndex*1+10;baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=s.style.zIndex-1}},showAt:function(l){var k=l.left;var j=l.top;var i={left:k,top:j,right:k,bottom:j,height:0,width:0};this.showAnchorRect(i,false,true)},_show:function(){if(this._hidden){var i=this.getDom();i.style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(i){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;if(!i){this.fireEvent("hide")}}},queryAutoHide:function(i){return !i||!e.contains(this.getDom(),i)}};c.inherits(g,h);a.on(document,"mousedown",function(i){var j=i.target||i.srcElement;f(j)});a.on(window,"scroll",function(){f()})})();(function(){var a=baidu.editor.utils,c=baidu.editor.ui.UIBase,b=baidu.editor.ui.ColorPicker=function(f){this.initOptions(f);this.noColorText=this.noColorText||"不设置颜色";this.initUIBase()};b.prototype={getHtmlTpl:function(){return e(this.noColorText)},_onTableClick:function(f){var h=f.target||f.srcElement;var g=h.getAttribute("data-color");if(g){this.fireEvent("pickcolor",g)}},_onTableOver:function(f){var h=f.target||f.srcElement;var g=h.getAttribute("data-color");if(g){this.getDom("preview").style.backgroundColor=g}},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};a.inherits(b,c);var d=("ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,").split(",");function e(f){var h='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+f+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;padding-top: 2px"><td colspan="10">主题颜色</td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(var g=0;g<d.length;g++){if(g&&g%10===0){h+="</tr>"+(g==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;"><td colspan="10">标准颜色</td></tr>':"")+"<tr"+(g==60?' class="edui-colorpicker-tablefirstrow"':"")+">"}h+=g<70?'<td style="padding: 0 2px;"><a hidefocus title="'+d[g]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+d[g]+'" style="background-color:#'+d[g]+";border:solid #ccc;"+(g<10||g>=60?"border-width:1px;":g>=10&&g<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':""}h+="</tr></table></div>";return h}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase;var d=baidu.editor.ui.TablePicker=function(e){this.initOptions(e);this.initTablePicker()};d.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span><span class="edui-clickable" onclick="$$._onMore();">更多</span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:c.prototype.render,render:function(e){this._UIBase_render(e);this.getDom("label").innerHTML="0列 x 0行"},_track:function(i,h){var f=this.getDom("overlay").style;var g=this.lengthOfCellSide;f.width=i*g+"px";f.height=h*g+"px";var e=this.getDom("label");e.innerHTML=i+"列 x "+h+"行";this.numCols=i;this.numRows=h},_onMouseOver:function(f,g){var e=f.relatedTarget||f.fromElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0列 x 0行";this.getDom("overlay").style.visibility=""}},_onMouseOut:function(f,g){var e=f.relatedTarget||f.toElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0列 x 0行";this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(e,g){var f=this.getDom("overlay").style;var k=b.getEventOffset(e);var i=this.lengthOfCellSide;var j=Math.ceil(k.left/i);var h=Math.ceil(k.top/i);this._track(j,h)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)},_onMore:function(){this.fireEvent("more")}};a.inherits(d,c)})();(function(){var c=baidu.editor.browser,a=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils;var d='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(c.ie?(' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"'):(' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'));baidu.editor.ui.Stateful={alwalysHoverable:false,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return d})},Stateful_onMouseEnter:function(e,f){if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,f){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseEnter(f,g)}},Stateful_onMouseOut:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseLeave(f,g)}},Stateful_onMouseDown:function(e,f){if(!this.isDisabled()){this.addState("active")}},Stateful_onMouseUp:function(e,f){if(!this.isDisabled()){this.removeState("active")}},Stateful_postRender:function(){if(this.disabled&&!this.hasState("disabled")){this.addState("disabled")}},hasState:function(e){return a.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){if(!this.hasState(e)){this.getStateDom().className+=" edui-state-"+e}},removeState:function(e){if(this.hasState(e)){a.removeClasses(this.getStateDom(),["edui-state-"+e])}},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){if(!this.isDisabled()&&e){this.addState("checked")}else{this.removeState("checked")}},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else{this.removeState("disabled")}}}})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Stateful,a=baidu.editor.ui.Button=function(e){this.initOptions(e);this.initButton()};a.prototype={uiName:"button",label:"",title:"",showIcon:true,showText:true,initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender()},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click")}}};b.inherits(a,d);b.extend(a.prototype,c)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,f=baidu.editor.ui.UIBase,d=baidu.editor.ui.Stateful,b=baidu.editor.ui.SplitButton=function(g){this.initOptions(g);this.initSplitButton()};b.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var h=this;if(this.popup!=null){var g=this.popup;this.popup=null;this.setPopup(g)}},_UIBase_postRender:f.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(g){if(this.popup===g){return}if(this.popup!=null){this.popup.dispose()}g.addListener("show",c.bind(this._onPopupShow,this));g.addListener("hide",c.bind(this._onPopupHide,this));g.addListener("postrender",c.bind(function(){g.getDom("body").appendChild(e.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(e.getClientRect(this.getDom()).width-2)+'px"></div>'));g.getDom().className+=" "+this.className},this));this.popup=g},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var g=e.getClientRect(this.getDom());g.top-=this.popup.SHADOW_RADIUS;g.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(g)},_onArrowClick:function(h,g){if(!this.isDisabled()){this.showPopup()}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick")}}};c.inherits(b,f);c.extend(b.prototype,d,true)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.ColorPicker,f=baidu.editor.ui.Popup,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.ColorButton=function(g){this.initOptions(g);this.initColorButton()};e.prototype={initColorButton:function(){var g=this;this.popup=new f({content:new d({noColorText:"清除颜色",onpickcolor:function(i,h){g._onPickColor(h)},onpicknocolor:function(i,h){g._onPickNoColor(h)}}),editor:g.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(c.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(g){this.getDom("colorlump").style.backgroundColor=g;this.color=g},_onPickColor:function(g){if(this.fireEvent("pickcolor",g)!==false){this.setColor(g);this.popup.hide()}},_onPickNoColor:function(g){if(this.fireEvent("picknocolor")!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Popup,d=baidu.editor.ui.TablePicker,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.TableButton=function(f){this.initOptions(f);this.initTableButton()};e.prototype={initTableButton:function(){var f=this;this.popup=new c({content:new d({onpicktable:function(g,i,h){f._onPickTable(i,h)},onmore:function(){f.popup.hide();f.fireEvent("more")}}),editor:f.editor});this.initSplitButton()},_onPickTable:function(g,f){if(this.fireEvent("picktable",g,f)!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};c.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){var f=[];for(var e=0;e<this.items.length;e++){f[e]=this.items[e].renderHtml()}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+f.join("")+"</div>"},postRender:function(){var f=this.getDom();for(var e=0;e<this.items.length;e++){this.items[e].postRender()}b.makeUnselectable(f)},_onMouseDown:function(){return false}};a.inherits(c,d)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup,a=baidu.editor.ui.Stateful,e=baidu.editor.ui.Menu=function(j){this.initOptions(j);this.initMenu()};var f={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return true}};e.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var j=0;j<this.items.length;j++){var k=this.items[j];if(k=="-"){this.items[j]=this.getSeparator()}else{if(!(k instanceof g)){this.items[j]=this.createItem(k)}}}},getSeparator:function(){return f},createItem:function(j){return new g(j)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0){return this._Popup_getContentHtmlTpl()}var l=[];for(var j=0;j<this.items.length;j++){var k=this.items[j];l[j]=k.renderHtml()}return('<div class="%%-body">'+l.join("")+"</div>")},_Popup_postRender:i.prototype.postRender,postRender:function(){var l=this;for(var j=0;j<this.items.length;j++){var k=this.items[j];k.ownerMenu=this;k.postRender()}d.on(this.getDom(),"mouseover",function(n){n=n||event;var m=n.relatedTarget||n.fromElement;var o=l.getDom();if(!b.contains(o,m)&&o!==m){l.fireEvent("over")}});this._Popup_postRender()},queryAutoHide:function(k){if(k){if(b.contains(this.getDom(),k)){return false}for(var j=0;j<this.items.length;j++){var l=this.items[j];if(l.queryAutoHide(k)===false){return false}}}},clearItems:function(){for(var j=0;j<this.items.length;j++){var k=this.items[j];clearTimeout(k._showingTimer);clearTimeout(k._closingTimer);if(k.subMenu){k.subMenu.destroy()}}this.items=[]},destroy:function(){if(this.getDom()){d.remove(this.getDom())}this.clearItems()},dispose:function(){this.destroy()}};h.inherits(e,i);var g=baidu.editor.ui.MenuItem=function(j){this.initOptions(j);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof e)){this.subMenu=new e(this.subMenu)}};g.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var j=this;this.addListener("over",function(){j.ownerMenu.fireEvent("submenuover",j);if(j.subMenu){j.delayShowSubMenu()}});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){j.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(j._closingTimer);j._closingTimer=null;j.addState("opened")});this.ownerMenu.addListener("hide",function(){j.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(l,k){if(k!==j){j.delayHideSubMenu()}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(k){if(k&&b.contains(j.getDom(),k)){return false}return this._bakQueryAutoHide(k)}}this.getDom().style.tabIndex="-1";b.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var j=this;if(!j.isDisabled()){j.addState("opened");clearTimeout(j._showingTimer);clearTimeout(j._closingTimer);j._closingTimer=null;j._showingTimer=setTimeout(function(){j.showSubMenu()},250)}},delayHideSubMenu:function(){var j=this;if(!j.isDisabled()){j.removeState("opened");clearTimeout(j._showingTimer);if(!j._closingTimer){j._closingTimer=setTimeout(function(){if(!j.hasState("opened")){j.hideSubMenu()}j._closingTimer=null},400)}}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(j){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(j)}},_onClick:function(j,k){if(this.hasState("disabled")){return}if(this.fireEvent("click",j,k)!==false){if(this.subMenu){this.showSubMenu()}else{i.postHide()}}},showSubMenu:function(){var j=b.getClientRect(this.getDom());j.right-=5;j.left+=2;j.width-=7;j.top-=4;j.bottom+=4;j.height+=8;this.subMenu.showAnchorRect(j,true,true)},hideSubMenu:function(){this.subMenu.hide()}};h.inherits(g,c);h.extend(g.prototype,a,true)})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,c=baidu.editor.ui.Combox=function(f){this.initOptions(f);this.initCombox()};c.prototype={uiName:"combox",initCombox:function(){var h=this;this.items=this.items||[];for(var f=0;f<this.items.length;f++){var g=this.items[f];g.uiName="listitem";g.index=f;g.onclick=function(){h.selectByIndex(this.index)}}this.popup=new e({items:this.items,uiName:"list",editor:this.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var f=d.getClientRect(this.getDom());f.top+=1;f.bottom-=1;f.height-=2;this.popup.showAnchorRect(f)},getValue:function(){return this.value},setValue:function(g){var f=this.indexByValue(g);if(f!=-1){this.selectedIndex=f;this.setLabel(this.items[f].label);this.value=this.items[f].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(g));this.value=g}},setLabel:function(f){this.getDom("button_body").innerHTML=f;this.label=f},getLabelForUnknowValue:function(f){return f},indexByValue:function(g){for(var f=0;f<this.items.length;f++){if(g==this.items[f].value){return f}}return -1},getItem:function(f){return this.items[f]},selectByIndex:function(f){if(f<this.items.length&&this.fireEvent("select",f)!==false){this.selectedIndex=f;this.value=this.items[f].value;this.setLabel(this.items[f].label)}}};b.inherits(c,a)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,a=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Mask,b=baidu.editor.ui.UIBase,f=baidu.editor.ui.Button,g=baidu.editor.ui.Dialog=function(j){this.initOptions(j);this.initDialog()};var c;var i;g.prototype={draggable:false,uiName:"dialog",initDialog:function(){var k=this;this.initUIBase();this.modalMask=(c||(c=new e({className:"edui-dialog-modalmask"})));this.dragMask=(i||(i=new e({className:"edui-dialog-dragmask"})));this.closeButton=new f({className:"edui-dialog-closebutton",title:"关闭对话框",onclick:function(){k.close(false)}});if(this.buttons){for(var j=0;j<this.buttons.length;j++){if(!(this.buttons[j] instanceof f)){this.buttons[j]=new f(this.buttons[j])}}}},fitSize:function(){var j=this.getDom("body");var k=this.mesureSize();j.style.width=k.width+"px";j.style.height=k.height+"px";return k},safeSetOffset:function(q){var l=this;var j=l.getDom();var o=a.getViewportRect();var k=a.getClientRect(j);var n=q.left;if(n+k.width>o.right){n=o.right-k.width}var m=q.top;if(m+k.height>o.bottom){m=o.bottom-k.height}j.style.left=Math.max(n,0)+"px";j.style.top=Math.max(m,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var o=a.getViewportRect();var j=this.fitSize();var n=this.getDom("titlebar").offsetHeight|0;var m=o.width/2-j.width/2;var l=o.height/2-(j.height-n)/2-n;var k=this.getDom();this.safeSetOffset({left:Math.max(m|0,0),top:Math.max(l|0,0)});if(!d.hasClass(k,"edui-state-centered")){k.className+=" edui-state-centered"}this._show()},getContentHtml:function(){var j="";if(typeof this.content=="string"){j=this.content}else{if(this.iframeUrl){j='<iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'}}return j},getHtmlTpl:function(){var k="";if(this.buttons){var l=[];for(var j=0;j<this.buttons.length;j++){l[j]=this.buttons[j].renderHtml()}k='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+l.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+k+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var k=this;this.addListener("show",function(){k.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){k.modalMask.hide()});if(this.buttons){for(var j=0;j<this.buttons.length;j++){this.buttons[j].postRender()}}d.on(window,"resize",function(){setTimeout(function(){if(!k.isHidden()){k.safeSetOffset(a.getClientRect(k.getDom()))}})});this._hide()},mesureSize:function(){var j=this.getDom("body");var k=a.getClientRect(this.getDom("content")).width;var l=j.style;l.width=k;return a.getClientRect(j)},_onTitlebarMouseDown:function(j,k){if(this.draggable){var m;var n=a.getViewportRect();var l=this;a.startDrag(j,{ondragstart:function(){m=a.getClientRect(l.getDom());l.dragMask.show(l.getDom().style.zIndex-1)},ondragmove:function(o,s){var r=m.left+o;var q=m.top+s;l.safeSetOffset({left:r,top:q})},ondragstop:function(){d.removeClasses(l.getDom(),["edui-state-centered"]);l.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){this.getDom().style.display="none";this.getDom().style.zIndex="";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset){this.reset()}this.showAtCenter();if(this.iframeUrl){try{this.getDom("iframe").focus()}catch(j){}}},_onCloseButtonClick:function(j,k){this.close(false)},close:function(j){if(this.fireEvent("close",j)!==false){this._hide()}}};h.inherits(g,b)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,d=baidu.editor.ui.MenuButton=function(e){this.initOptions(e);this.initMenuButton()};d.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton";this.popup=new c({items:e.items,className:e.className,editor:e.editor});this.popup.addListener("show",function(){var g=this;for(var f=0;f<g.items.length;f++){g.items[f].removeState("checked");if(g.items[f].value==e._value){g.items[f].addState("checked");this.value=e._value}}});this.initSplitButton()},setValue:function(e){this._value=e}};b.inherits(d,a)})();(function(){var d=baidu.editor.utils;var f=baidu.editor.ui.Popup;var c=baidu.editor.ui.SplitButton;var g;var e;(function(){var i,h=i=h||{version:"1.3.9"};h.guid="$BAIDU$";window[h.guid]=window[h.guid]||{};h.ui=h.ui||{version:"1.3.9"};h.ui.getUI=function(m){var m=m.split("-"),j=h.ui,k=m.length,l=0;for(;l<k;l++){j=j[m[l].charAt(0).toUpperCase()+m[l].slice(1)]}return j};h.lang=h.lang||{};h.lang.isString=function(j){return"[object String]"==Object.prototype.toString.call(j)};h.isString=h.lang.isString;h.ui.create=function(j,k){if(h.lang.isString(j)){j=h.ui.getUI(j)}return new j(k)};h.dom=h.dom||{};h.dom.g=function(j){if("string"==typeof j||j instanceof String){return document.getElementById(j)}else{if(j&&j.nodeName&&(j.nodeType==1||j.nodeType==9)){return j}}return null};h.g=h.G=h.dom.g;(function(){var j=window[h.guid];h.lang.guid=function(){return"TANGRAM__"+(j._counter++).toString(36)};j._counter=j._counter||1})();window[h.guid]._instances=window[h.guid]._instances||{};h.lang.isFunction=function(j){return"[object Function]"==Object.prototype.toString.call(j)};h.lang.Class=function(j){this.guid=j||h.lang.guid();window[h.guid]._instances[this.guid]=this};window[h.guid]._instances=window[h.guid]._instances||{};h.lang.Class.prototype.dispose=function(){delete window[h.guid]._instances[this.guid];for(var j in this){if(!h.lang.isFunction(this[j])){delete this[j]}}this.disposed=true};h.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};h.lang.Event=function(k,j){this.type=k;this.returnValue=true;this.target=j||null;this.currentTarget=null};h.lang.Class.prototype.addEventListener=function(m,n,j){if(!h.lang.isFunction(n)){return}!this.__listeners&&(this.__listeners={});var k=this.__listeners,l;if(typeof j=="string"&&j){if(/[^\w\-]/.test(j)){throw ("nonstandard key:"+j)}else{n.hashCode=j;l=j}}m.indexOf("on")!=0&&(m="on"+m);typeof k[m]!="object"&&(k[m]={});l=l||h.lang.guid();n.hashCode=l;k[m][l]=n};h.lang.Class.prototype.removeEventListener=function(l,m){if(typeof m!="undefined"){if((h.lang.isFunction(m)&&!(m=m.hashCode))||(!h.lang.isString(m))){return}}!this.__listeners&&(this.__listeners={});l.indexOf("on")!=0&&(l="on"+l);var j=this.__listeners;if(!j[l]){return}if(typeof m!="undefined"){j[l][m]&&delete j[l][m]}else{for(var k in j[l]){delete j[l][k]}}};h.lang.Class.prototype.dispatchEvent=function(m,k){if(h.lang.isString(m)){m=new h.lang.Event(m)}!this.__listeners&&(this.__listeners={});k=k||{};for(var n in k){m[n]=k[n]}var n,j=this.__listeners,l=m.type;m.target=m.target||this;m.currentTarget=this;l.indexOf("on")!=0&&(l="on"+l);h.lang.isFunction(this[l])&&this[l].apply(this,arguments);if(typeof j[l]=="object"){for(n in j[l]){j[l][n].apply(this,arguments)}}return m.returnValue};h.event=h.event||{};h.event._listeners=h.event._listeners||[];h.dom._g=function(j){if(h.lang.isString(j)){return document.getElementById(j)}return j};h._g=h.dom._g;h.event.on=function(j,o,m){o=o.replace(/^on/i,"");j=h.dom._g(j);var n=function(s){m.call(j,s)},k=h.event._listeners,q=h.event._eventFilter,l,r=o;o=o.toLowerCase();if(q&&q[o]){l=q[o](j,o,n);r=l.type;n=l.listener}if(j.addEventListener){j.addEventListener(r,n,false)}else{if(j.attachEvent){j.attachEvent("on"+r,n)}}k[k.length]=[j,o,m,n,r];return j};h.on=h.event.on;h.event.un=function(q,m,r){q=h.dom._g(q);m=m.replace(/^on/i,"").toLowerCase();var j=h.event._listeners,o=j.length,n=!r,k,l,s;while(o--){k=j[o];if(k[1]===m&&k[0]===q&&(n||k[2]===r)){l=k[4];s=k[3];if(q.removeEventListener){q.removeEventListener(l,s,false)}else{if(q.detachEvent){q.detachEvent("on"+l,s)}}j.splice(o,1)}}return q};h.un=h.event.un;h.ui.Base={id:"",getId:function(k){var l=this,j;j="tangram-"+l.uiType+"--"+(l.id?l.id:l.guid);return k?j+"-"+k:j},getClass:function(j){var l=this,m=l.classPrefix,k=l.skin;if(j){m+="-"+j;k+="-"+j}if(l.skin){m+=" "+k}return m},getMain:function(){return h.g(this.mainId)},getBody:function(){return h.g(this.getId())},uiType:"",getCallRef:function(){return"window['$BAIDU$']._instances['"+this.guid+"']"},getCallString:function(l){var m=0,j=Array.prototype.slice.call(arguments,1),k=j.length;for(;m<k;m++){if(typeof j[m]=="string"){j[m]="'"+j[m]+"'"}}return this.getCallRef()+"."+l+"("+j.join(",")+");"},on:function(k,j,l){h.on(k,j,l);this.addEventListener("ondispose",function(){h.un(k,j,l)})},renderMain:function(j){var l=this,m=0,k;if(l.getMain()){return}j=h.g(j);if(!j){j=document.createElement("div");document.body.appendChild(j);j.style.position="absolute";j.className=l.getClass("main")}if(!j.id){j.id=l.getId("main")}l.mainId=j.id;j.setAttribute("data-guid",l.guid);return j},dispose:function(){this.dispatchEvent("dispose");h.lang.Class.prototype.dispose.call(this)}};h.object=h.object||{};h.extend=h.object.extend=function(l,k){for(var j in k){if(k.hasOwnProperty(j)){l[j]=k[j]}}return l};h.ui.createUI=function(r,k){k=k||{};var m=k.superClass||h.lang.Class,n=m==h.lang.Class?1:0,q,s,l=function(u,v){var j=this;u=u||{};m.call(j,!n?u:(u.guid||""),true);h.object.extend(j,l.options);h.object.extend(j,u);j.classPrefix=j.classPrefix||"tangram-"+j.uiType.toLowerCase();for(q in h.ui.behavior){if(typeof j[q]!="undefined"&&j[q]){h.object.extend(j,h.ui.behavior[q]);if(h.lang.isFunction(j[q])){j.addEventListener("onload",function(){h.ui.behavior[q].call(j[q].apply(j))})}else{h.ui.behavior[q].call(j)}}}r.apply(j,arguments);for(q=0,s=l._addons.length;q<s;q++){l._addons[q](j)}if(u.parent&&j.setParent){j.setParent(u.parent)}if(!v&&u.autoRender){j.render(u.element)}},t=function(){};t.prototype=m.prototype;var o=l.prototype=new t();for(q in h.ui.Base){o[q]=h.ui.Base[q]}l.extend=function(j){for(q in j){l.prototype[q]=j[q]}return l};l._addons=[];l.register=function(j){if(typeof j=="function"){l._addons.push(j)}};l.options={};return l};h.ui.behavior=h.ui.behavior||{};h.string=h.string||{};(function(){var j=new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+\x24)","g");h.string.trim=function(k){return String(k).replace(j,"")}})();h.trim=h.string.trim;h.dom.addClass=function(m,l){m=h.dom.g(m);var j=l.split(/\s+/),k=m.className,n=" "+k+" ",o=0,q=j.length;for(;o<q;o++){if(n.indexOf(" "+j[o]+" ")<0){k+=(k?" ":"")+j[o]}}m.className=k;return m};h.addClass=h.dom.addClass;h.dom.removeClass=function(n,m){n=h.dom.g(n);var q=n.className.split(/\s+/),l=m.split(/\s+/),j,k=l.length,r,o=0;for(;o<k;++o){for(r=0,j=q.length;r<j;++r){if(q[r]==l[o]){q.splice(r,1);break}}}n.className=q.join(" ");return n};h.removeClass=h.dom.removeClass;h.dom.hasClass=function(m,l){m=h.dom.g(m);var j=h.string.trim(l).split(/\s+/),k=j.length;l=m.className.split(/\s+/).join(" ");while(k--){if(!(new RegExp("(^| )"+j[k]+"( |\x24)")).test(l)){return false}}return true};h.event.getTarget=function(j){return j.target||j.srcElement};h.array=h.array||{};h.each=h.array.forEach=h.array.each=function(l,n,j){var o,m,q,k=l.length;if("function"==typeof n){for(q=0;q<k;q++){m=l[q];o=n.call(j||l,m,q);if(o===false){break}}}return l};h.object.each=function(l,n){var j,k,m;if("function"==typeof n){for(k in l){if(l.hasOwnProperty(k)){m=l[k];j=n.call(l,m,k);if(j===false){break}}}}return l};h.fn=h.fn||{};h.fn.bind=function(j,k){var l=arguments.length>2?[].slice.call(arguments,2):null;return function(){var m=h.lang.isString(j)?k[j]:j,n=(l)?l.concat([].slice.call(arguments,0)):arguments;return m.apply(k||m,n)}};h.lang.Class.prototype.addEventListeners=function(n,m){if(typeof m=="undefined"){for(var j in n){this.addEventListener(j,n[j])}}else{n=n.split(",");var j=0,k=n.length,l;for(;j<k;j++){this.addEventListener(h.trim(n[j]),m)}}};(function(){var j=h.ui.behavior.statable=function(){var k=this;k.addEventListeners("ondisable,onenable",function(m,o){var n,l;o=o||{};elementId=(o.element||k.getMain()).id;l=o.group;if(m.type=="ondisable"&&!k.getState(elementId,l)["disabled"]){k.removeState("press",elementId,l);k.removeState("hover",elementId,l);k.setState("disabled",elementId,l)}else{if(m.type=="onenable"&&k.getState(elementId,l)["disabled"]){k.removeState("disabled",elementId,l)}}})};j._states={};j._allStates=["hover","press","disabled"];j._allEventsName=["mouseover","mouseout","mousedown","mouseup"];j._eventsHandler={mouseover:function(l,m){var k=this;if(!k.getState(l,m)["disabled"]){k.setState("hover",l,m);return true}},mouseout:function(l,m){var k=this;if(!k.getState(l,m)["disabled"]){k.removeState("hover",l,m);k.removeState("press",l,m);return true}},mousedown:function(l,m){var k=this;if(!k.getState(l,m)["disabled"]){k.setState("press",l,m);return true}},mouseup:function(l,m){var k=this;if(!k.getState(l,m)["disabled"]){k.removeState("press",l,m);return true}}};j._getStateHandlerString=function(l,n){var m=this,o=0,k=m._allEventsName.length,r=[],q;if(typeof l=="undefined"){l=n=""}for(;o<k;o++){q=m._allEventsName[o];r[o]="on"+q+'="'+m.getCallRef()+"._fireEvent('"+q+"', '"+l+"', '"+n+"', event)\""}return r.join(" ")};j._fireEvent=function(q,m,k,n){var o=this,l=o.getId(m+k);if(o._eventsHandler[q].call(o,l,m)){o.dispatchEvent(q,{element:l,group:m,key:k,DOMEvent:n})}};j.addState=function(l,k,n){var m=this;m._allStates.push(l);if(k){m._allEventsName.push(k);if(!n){n=function(){return true}}m._eventsHandler[k]=n}};j.getState=function(k,l){var m=this,n;l=l?l+"-":"";k=k?k:m.getId();n=m._states[l+k];return n?n:{}};j.setState=function(n,k,m){var o=this,l,q;m=m?m+"-":"";k=k?k:o.getId();l=m+k;o._states[l]=o._states[l]||{};q=o._states[l][n];if(!q){o._states[l][n]=1;h.addClass(k,o.getClass(m+n))}};j.removeState=function(n,k,m){var o=this,l;m=m?m+"-":"";k=k?k:o.getId();l=m+k;if(o._states[l]){o._states[l][n]=0;h.removeClass(k,o.getClass(m+n))}}})();h.browser=h.browser||{};h.browser.opera=/opera(\/| )(\d+(\.\d+)?)(.+?(version\/(\d+(\.\d+)?)))?/i.test(navigator.userAgent)?+(RegExp["\x246"]||RegExp["\x242"]):undefined;h.dom.insertHTML=function(m,k,n){m=h.dom.g(m);var j,l;if(m.insertAdjacentHTML&&!h.browser.opera){m.insertAdjacentHTML(k,n)}else{j=m.ownerDocument.createRange();k=k.toUpperCase();if(k=="AFTERBEGIN"||k=="BEFOREEND"){j.selectNodeContents(m);j.collapse(k=="AFTERBEGIN")}else{l=k=="BEFOREBEGIN";j[l?"setStartBefore":"setEndAfter"](m);j.collapse(l)}j.insertNode(j.createContextualFragment(n))}return m};h.insertHTML=h.dom.insertHTML;h.string.format=function(m,k){m=String(m);var j=Array.prototype.slice.call(arguments,1),l=Object.prototype.toString;if(j.length){j=j.length==1?(k!==null&&(/\[object Array\]|\[object Object\]/.test(l.call(k)))?k:j):j;return m.replace(/#\{(.+?)\}/g,function(q,n){var o=j[n];if("[object Function]"==l.call(o)){o=o(n)}return("undefined"==typeof o?"":o)})}return m};h.format=h.string.format;h.ui.Base.setParent=function(j){var l=this,k=l._parent;k&&k.dispatchEvent("removechild");if(j.dispatchEvent("appendchild",{child:l})){l._parent=j}};h.ui.Base.getParent=function(){return this._parent||null};h.browser.ie=h.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?(document.documentMode||+RegExp["\x241"]):undefined;h.dom.remove=function(k){k=h.dom._g(k);var j=k.parentNode;j&&j.removeChild(k)};h.ui.Button=h.ui.createUI(new Function).extend({uiType:"button",tplBody:'<div id="#{id}" #{statable} class="#{class}">#{content}</div>',disabled:false,statable:true,_getString:function(){var j=this;return h.format(j.tplBody,{id:j.getId(),statable:j._getStateHandlerString(),"class":j.getClass(),content:j.content})},render:function(l){var j=this,k;j.addState("click","click");h.dom.insertHTML(j.renderMain(l),"beforeEnd",j._getString());k=h.g(l).lastChild;if(j.title){k.title=j.title}j.disabled&&j.setState("disabled");j.dispatchEvent("onload")},isDisabled:function(){var k=this,j=k.getId();return k.getState()["disabled"]},dispose:function(){var j=this,k=j.getBody();j.dispatchEvent("dispose");h.each(j._allEventsName,function(l,m){k["on"+l]=null});h.dom.remove(k);j.dispatchEvent("ondispose");h.lang.Class.prototype.dispose.call(j)},disable:function(){var j=this,k=j.getBody();j.dispatchEvent("ondisable",{element:k})},enable:function(){var j=this;body=j.getBody();j.dispatchEvent("onenable",{element:body})},fire:function(k,l){var j=this,k=k.toLowerCase();if(j.getState()["disabled"]){return}j._fireEvent(k,null,null,l)},update:function(k){var j=this;h.extend(j,k);k.content&&(j.getBody().innerHTML=k.content);j.dispatchEvent("onupdate")}});h.lang.isBoolean=function(j){return typeof j==="boolean"};h.ui.Button.register(function(j){if(!j.poll){return}h.lang.isBoolean(j.poll)&&(j.poll={});j.addEventListener("mousedown",function(k){var m=0,n=j.poll.interval||100,l=j.poll.time||0;(function(){if(j.getState()["press"]){m++>l&&j.onmousedown&&j.onmousedown();j.poll.timeOut=setTimeout(arguments.callee,n)}})()});j.addEventListener("dispose",function(){if(j.poll.timeOut){j.disable();window.clearTimeout(j.poll.timeOut)}})});h.date=h.date||{};h.number=h.number||{};h.number.pad=function(m,n){var l="",j=(m<0),k=String(Math.abs(m));if(k.length<n){l=(new Array(n-k.length+1)).join("0")}return(j?"-":"")+l+k};h.date.format=function(u,o){if("string"!=typeof o){return u.toString()}function r(j,v){o=o.replace(j,v)}var t=h.number.pad,n=u.getFullYear(),q=u.getMonth()+1,k=u.getDate(),m=u.getHours(),s=u.getMinutes(),l=u.getSeconds();r(/yyyy/g,t(n,4));r(/yy/g,t(parseInt(n.toString().slice(2),10),2));r(/MM/g,t(q,2));r(/M/g,q);r(/dd/g,t(k,2));r(/d/g,k);r(/HH/g,t(m,2));r(/H/g,m);r(/hh/g,t(m%12,2));r(/h/g,m%12);r(/mm/g,t(s,2));r(/m/g,s);r(/ss/g,t(l,2));r(/s/g,l);return o};h.array.indexOf=function(l,j,m){var k=l.length,n=j;m=m|0;if(m<0){m=Math.max(0,k+m)}for(;m<k;m++){if(m in l&&l[m]===j){return m}}return -1};h.array.some=function(l,m,j){var n=0,k=l.length;for(;n<k;n++){if(n in l&&m.call(j||l,l[n],n)){return true}}return false};h.lang.isDate=function(j){return{}.toString.call(j)==="[object Date]"&&j.toString()!=="Invalid Date"&&!isNaN(j)};h.lang.isNumber=function(j){return"[object Number]"==Object.prototype.toString.call(j)&&isFinite(j)};h.i18n=h.i18n||{};h.i18n.cultures=h.i18n.cultures||{};h.i18n.cultures["zh-CN"]=h.object.extend(h.i18n.cultures["zh-CN"]||{},{calendar:{dateFormat:"yyyy-MM-dd",titleNames:"#{yyyy}年&nbsp;#{MM}月",monthNames:["一","二","三","四","五","六","七","八","九","十","十一","十二"],dayNames:{mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六",sun:"日"}},timeZone:8,whitespace:new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+\x24)","g"),number:{group:",",groupLength:3,decimal:".",positive:"",negative:"-",_format:function(j,k){return h.i18n.number._format(j,{group:this.group,groupLength:this.groupLength,decimal:this.decimal,symbol:k?this.negative:this.positive})}},currency:{symbol:"￥"},language:{ok:"确定",cancel:"取消",signin:"注册",signup:"登录"}});h.i18n.currentLocale=h.i18n.currentLocale||"zh-CN";h.i18n.date=h.i18n.date||{getDaysInMonth:function(k,j){var l=[31,28,31,30,31,30,31,31,30,31,30,31];if(j==1&&h.i18n.date.isLeapYear(k)){return 29}return l[j]},isLeapYear:function(j){return !(j%400)||(!(j%4)&&!!(j%100))},toLocaleDate:function(j,k,l){return this._basicDate(j,k,l||h.i18n.currentLocale)},_basicDate:function(n,r,l){var k=h.i18n.cultures[l||h.i18n.currentLocale].timeZone,m=k*60,j,q,o=n.getTime();if(r){j=h.i18n.cultures[r].timeZone;q=j*60}else{q=-1*n.getTimezoneOffset();j=j/60}return new Date(j!=k?(o+(m-q)*60000):o)}};h.ui.Calendar=h.ui.createUI(function(k){var j=this;j.flipContent=h.object.extend({prev:"&lt;",next:"&gt;"},j.flipContent);j.addEventListener("mouseup",function(o){var l=o.element,n=j._dates[l],m=h.dom.g(j._currElementId);m&&h.dom.removeClass(m,j.getClass("date-current"));j._currElementId=l;j._initDate=n;h.dom.addClass(h.dom.g(l),j.getClass("date-current"));j.dispatchEvent("clickdate",{date:n})})}).extend({uiType:"calendar",weekStart:"Sun",statable:true,language:"zh-CN",tplDOM:'<div id="#{id}" class="#{class}">#{content}</div>',tplTable:'<table border="0" cellpadding="0" cellspacing="1" class="#{class}"><thead class="#{headClass}">#{head}</thead><tbody class="#{bodyClass}">#{body}</tbody></table>',tplDateCell:'<td id="#{id}" class="#{class}" #{handler}>#{content}</td>',tplTitle:'<div id="#{id}" class="#{class}"><div id="#{labelId}" class="#{labelClass}">#{text}</div><div id="#{prevId}" class="#{prevClass}"></div><div id="#{nextId}" class="#{nextClass}"></div></div>',_initialize:function(){var k=this;function j(l){var m=[];h.array.each(l,function(n){m.push(h.lang.isDate(n)?k._toLocalDate(n):{start:k._toLocalDate(n.start),end:k._toLocalDate(n.end)})});return m}k._highlightDates=j(k.highlightDates||[]);k._disableDates=j(k.disableDates||[]);k._initDate=k._toLocalDate(k.initDate||new Date());k._currDate=new Date(k._initDate.getTime());k.weekStart=k.weekStart.toLowerCase()},_getDateJson:function(j){var n=this,k=h.lang.guid(),l=n._currDate,q=[],o;function m(s,t){return s.getDate()==t.getDate()&&Math.abs(s.getTime()-t.getTime())<24*60*60*1000}function r(s,u){var t=u.getTime();return h.array.some(s,function(v){if(h.lang.isDate(v)){return m(v,u)}else{return m(v.start,u)||t>v.start.getTime()&&t<=v.end.getTime()}})}j.getMonth()!=l.getMonth()&&q.push(n.getClass("date-other"));r(n._highlightDates,j)&&q.push(n.getClass("date-highlight"));if(m(n._initDate,j)){q.push(n.getClass("date-current"));n._currElementId=n.getId(k)}m(n._toLocalDate(new Date()),j)&&q.push(n.getClass("date-today"));o=r(n._disableDates,j)&&(q=[]);return{id:n.getId(k),"class":q.join("\x20"),handler:n._getStateHandlerString("",k),date:j,disabled:o}},_getMonthCount:function(n,l){var k=h.i18n.date.getDaysInMonth,j=[31,28,31,30,31,30,31,31,30,31,30,31],m;k&&(m=k(n,l));if(!h.lang.isNumber(m)){m=1==l&&(n%4)&&(n%100!=0||n%400==0)?29:j[l]}return m},_getDateTableString:function(){var v=this,C=h.i18n.cultures[v.language].calendar,H=["sun","mon","tue","wed","thu","fri","sat"],I=v._currDate,u=I.getFullYear(),w=I.getMonth(),t=new Date(u,w,1).getDay(),B=0,D=[],x=[],A=[],j=v._disabledIds=[],E=0,F=0,y=H.length,z,G;for(;E<y;E++){H[E]==v.weekStart&&(B=E);(B>0?D:A).push("<td>",C.dayNames[H[E]],"</td>")}D=D.concat(A);D.unshift("<tr>");D.push("</tr>");t=(t<B?t+7:t)-B;z=Math.ceil((v._getMonthCount(u,w)+t)/y);v._dates={};for(E=0;E<z;E++){x.push("<tr>");for(F=0;F<y;F++){G=v._getDateJson(new Date(u,w,E*y+F+1-t));v._dates[G.id]=G.date;G.disabled&&j.push(G.id);x.push(h.string.format(v.tplDateCell,{id:G.id,"class":G["class"],handler:G.handler,content:G.date.getDate()}))}x.push("</tr>")}return h.string.format(v.tplTable,{"class":v.getClass("table"),headClass:v.getClass("week"),bodyClass:v.getClass("date"),head:D.join(""),body:x.join("")})},getString:function(){var j=this;return h.string.format(j.tplDOM,{id:j.getId(),"class":j.getClass(),content:h.string.format(j.tplDOM,{id:j.getId("content"),"class":j.getClass("content")})})},_toLocalDate:function(j){return j?h.i18n.date.toLocaleDate(j,null,this.language):j},_renderDate:function(){var j=this;h.dom.g(j.getId("content")).innerHTML=j._getDateTableString();h.array.each(j._disabledIds,function(k){j.setState("disabled",k)})},_basicFlipMonth:function(l){var j=this,m=j._currDate,n=m.getMonth()+(l=="prev"?-1:1),k=m.getFullYear()+(n<0?-1:(n>11?1:0));n=n<0?12:(n>11?0:n);m.setYear(k);j.gotoMonth(n);j.dispatchEvent(l+"month",{date:new Date(m.getTime())})},renderTitle:function(){var o=this,q,r,l=o._currDate,m=h.i18n.cultures[o.language].calendar,n=h.dom.g(o.getId("label")),k=h.string.format(m.titleNames,{yyyy:l.getFullYear(),MM:m.monthNames[l.getMonth()],dd:l.getDate()});if(n){n.innerHTML=k;return}h.dom.insertHTML(o.getBody(),"afterBegin",h.string.format(o.tplTitle,{id:o.getId("title"),"class":o.getClass("title"),labelId:o.getId("label"),labelClass:o.getClass("label"),text:k,prevId:o.getId("prev"),prevClass:o.getClass("prev"),nextId:o.getId("next"),nextClass:o.getClass("next")}));function j(s){return{classPrefix:o.classPrefix+"-"+s+"btn",skin:o.skin?o.skin+"-"+s:"",content:o.flipContent[s],poll:{time:4},element:o.getId(s),autoRender:true,onmousedown:function(){o._basicFlipMonth(s)}}}q=new h.ui.Button(j("prev"));r=new h.ui.Button(j("next"));o.addEventListener("ondispose",function(){q.dispose();r.dispose()})},render:function(l){var k=this,j=k.skin;if(!l||k.getMain()){return}h.dom.insertHTML(k.renderMain(l),"beforeEnd",k.getString());k._initialize();k.renderTitle();k._renderDate();h.dom.g(k.getId("content")).style.height=(k.getBody().clientHeight||k.getBody().offsetHeight)-h.dom.g(k.getId("title")).offsetHeight+"px";k.dispatchEvent("onload")},update:function(k){var j=this;h.object.extend(j,k||{});j._initialize();j.renderTitle();j._renderDate();j.dispatchEvent("onupdate")},gotoDate:function(k){var j=this;j._currDate=j._toLocalDate(k);j._initDate=j._toLocalDate(k);j.renderTitle();j._renderDate();j.dispatchEvent("ongotodate")},gotoYear:function(j){var n=this,l=n._currDate,m=l.getMonth(),k=l.getDate(),o;if(1==m){o=n._getMonthCount(j,m);k>o&&l.setDate(o)}l.setFullYear(j);n.renderTitle();n._renderDate();n.dispatchEvent("ongotoyear")},gotoMonth:function(l){var n=this,m=n._currDate,l=Math.min(Math.max(l,0),11),k=m.getDate(),j=n._getMonthCount(m.getFullYear(),l);k>j&&m.setDate(j);m.setMonth(l);n.renderTitle();n._renderDate();n.dispatchEvent("ongotomonth")},getToday:function(){return me._toLocalDate(new Date())},getDate:function(){return new Date(this._initDate.getTime())},setDate:function(k){if(h.lang.isDate(k)){var j=this;j._initDate=k;j._currDate=k}},prevMonth:function(){this._basicFlipMonth("prev")},nextMonth:function(){this._basicFlipMonth("next")},dispose:function(){var j=this;j.dispatchEvent("dispose");h.dom.remove(j.getMain());h.lang.Class.prototype.dispose.call(j)}});g=h.ui.Calendar;e=h.date.format})();var a=function(h){this.initOptions(h);this.initPopup();var i=this;this._calendar=new g({onclickdate:function(j){i.fireEvent("pickdate",j.date)}})};a.prototype={content:"",_Popup_postRender:f.prototype.postRender,postRender:function(){this._calendar.render(this.getDom("content"));this._Popup_postRender()}};d.inherits(a,f);var b=baidu.editor.ui.DateButton=function(h){this.initOptions(h);this.initDateButton()};b.prototype={initDateButton:function(){var h=this;this.popup=new a({onpickdate:function(j,i){if(h.fireEvent("pickdate",e(i,"yyyy-MM-dd"))!==false){h.popup.hide()}},editor:h.editor});this.initSplitButton()}};d.inherits(b,c)})();(function(){var h=baidu.editor.utils;var g=baidu.editor.ui;var e=g.Dialog;g.Dialog=function(j){var k=new e(j);k.addListener("hide",function(){if(k.editor){var m=k.editor;try{if(baidu.editor.browser.ie){m.selection._bakIERange.select()}else{m.focus()}}catch(l){}}});return k};var d,c;var f=["Undo","Redo","FormatMatch","Bold","Italic","Underline","StrikeThrough","Subscript","Superscript","Source","Indent","Outdent","BlockQuote","PastePlain","PageBreak","SelectAll","Print","Preview","Horizontal","RemoveFormat","Time","Date","Unlink","InsertParagraphBeforeTable","InsertRow","InsertCol","MergeRight","MergeDown","DeleteRow","DeleteCol","SplittoRows","SplittoCols","SplittoCells","MergeCells","DeleteTable"];d=f.length;while(d--){c=f[d];g[c]=function(j){return function(k,m){m=m||k.options.labelMap[j.toLowerCase()]||"";var l=new g.Button({className:"edui-for-"+j.toLowerCase(),title:m,onclick:function(){k.execCommand(j)},showText:false});k.addListener("selectionchange",function(o,n,r){var q=k.queryCommandState(j.toLowerCase());if(q==-1){l.setDisabled(true);l.setChecked(false)}else{if(!r){l.setDisabled(false);l.setChecked(q)}}});return l}}(c)}g.ClearDoc=function(j,m){var l="ClearDoc";m=m||j.options.labelMap[l.toLowerCase()]||"";var k=new g.Button({className:"edui-for-"+l.toLowerCase(),title:m,onclick:function(){if(confirm("确定清空文档吗？")){j.execCommand("cleardoc")}}});j.addListener("selectionchange",function(){var n=j.queryCommandState("cleardoc");k.setDisabled(n==-1)});return k};g.Justify=function(k,j,m){j=(j||"left").toLowerCase();m=m||k.options.labelMap["justify"+j.toLowerCase()]||"";var l=new g.Button({className:"edui-for-justify"+j.toLowerCase(),title:m,onclick:function(){k.execCommand("Justify",j)}});k.addListener("selectionchange",function(o,n,s){var r=k.queryCommandState("Justify");l.setDisabled(r==-1);var q=k.queryCommandValue("Justify");l.setChecked(q==j&&!s)});return l};g.JustifyLeft=function(j,k){return g.Justify(j,"left",k)};g.JustifyCenter=function(j,k){return g.Justify(j,"center",k)};g.JustifyRight=function(j,k){return g.Justify(j,"right",k)};g.JustifyJustify=function(j,k){return g.Justify(j,"justify",k)};g.ImageFloat=function(k,j,m){j=(j||"none").toLowerCase();m=m||k.options.labelMap["image"+j.toLowerCase()]||"";var l=new g.Button({className:"edui-for-image"+j.toLowerCase(),title:m,onclick:function(){k.execCommand("imagefloat",j)}});k.addListener("selectionchange",function(n){var o=k.queryCommandState("imagefloat");l.setDisabled(o==-1);var o=k.queryCommandValue("imagefloat");l.setChecked(o==j)});return l};g.ImageNone=function(j,k){return g.ImageFloat(j,k)};g.ImageLeft=function(j,k){return g.ImageFloat(j,"left",k)};g.ImageRight=function(j,k){return g.ImageFloat(j,"right",k)};g.ImageCenter=function(j,k){return g.ImageFloat(j,"center",k)};g.Directionality=function(k,j,m){j=(j||"left").toLowerCase();m=m||k.options.labelMap["directionality"+j.toLowerCase()]||"";var l=new g.Button({className:"edui-for-directionality"+j.toLowerCase(),title:m,onclick:function(){k.execCommand("directionality",j)},type:j});k.addListener("selectionchange",function(o,n,s){var r=k.queryCommandState("directionality");l.setDisabled(r==-1);var q=k.queryCommandValue("directionality");l.setChecked(q==l.type&&!s)});return l};g.DirectionalityLtr=function(j,k){return new g.Directionality(j,"ltr",k)};g.DirectionalityRtl=function(j,k){return new g.Directionality(j,"rtl",k)};var i=["BackColor","ForeColor"];d=i.length;while(d--){c=i[d];g[c]=function(j){return function(k,m){m=m||k.options.labelMap[j.toLowerCase()]||"";var l=new g.ColorButton({className:"edui-for-"+j.toLowerCase(),color:"default",title:m,editor:k,onpickcolor:function(o,n){k.execCommand(j,n)},onpicknocolor:function(){k.execCommand(j,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){k.execCommand(j,this.color)}});k.addListener("selectionchange",function(){var n=k.queryCommandState(j);if(n==-1){l.setDisabled(true)}else{l.setDisabled(false)}});return l}}(c)}var a=["SearchReplace","Help","Spechars"];d=a.length;while(d--){c=a[d];g[c]=function(j){j=j.toLowerCase();return function(m,l,o){l=l||m.options.iframeUrlMap[j.toLowerCase()]||"about:blank";l=m.ui.mapUrl(l);o=o||m.options.labelMap[j.toLowerCase()]||"";var k=new g.Dialog({iframeUrl:l,autoReset:true,draggable:true,editor:m,className:"edui-for-"+j,title:o,onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});k.render();var n=new g.Button({className:"edui-for-"+j,title:o,onclick:function(){k.open()}});m.addListener("selectionchange",function(){var q=m.queryCommandState(j);if(q==-1){n.setDisabled(true)}else{n.setDisabled(false)}});return n}}(c)}var b=["Anchor","Link","InsertImage","Map","GMap","InsertVideo","TableSuper","HighlightCode","InsertFrame"];d=b.length;while(d--){c=b[d];g[c]=function(j){j=j.toLowerCase();return function(m,l,o){l=l||m.options.iframeUrlMap[j.toLowerCase()]||"about:blank";l=m.ui.mapUrl(l);o=o||m.options.labelMap[j.toLowerCase()]||"";var k=new g.Dialog({iframeUrl:l,autoReset:true,draggable:true,editor:m,className:"edui-for-"+j,title:o,buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){k.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){k.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});k.render();var n=new g.Button({className:"edui-for-"+j,title:o,onclick:function(){k.open()}});m.addListener("selectionchange",function(){var q=m.queryCommandState(j);if(q==-1){n.setDisabled(true)}else{n.setChecked(q);n.setDisabled(false)}});return n}}(c)}g.CheckImage=function(j){var k=new g.Button({className:"edui-for-checkimage",title:"图片转存",onclick:function(){j.execCommand("checkimage","_localImages");j.ui._dialogs.wordImageDialog.open()}});j.addListener("selectionchange",function(){var l=j.queryCommandState("checkimage","word_img");if(l==-1){k.setDisabled(true)}else{k.setDisabled(false);k.setChecked(l)}});return k};g.FontFamily=function(l,m,s){m=m||l.options.listMap.fontfamily||[];s=s||l.options.labelMap.fontfamily||"";var n=[];for(var k=0;k<m.length;k++){var j=m[k];var q=l.options.fontMap[j];var t='"'+j+'"';var r=new RegExp(j,"i");if(q){t='"'+q.join('","')+'"';r=new RegExp("(?:\\|)"+q.join("|")+"(?:\\|)","i")}n.push({label:j,value:t,regex:r,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+h.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}var o=new g.Combox({editor:l,items:n,onselect:function(v,u){l.execCommand("FontFamily",this.items[u].value)},onbuttonclick:function(){this.showPopup()},title:s,initValue:l.options.ComboxInitial.FONT_FAMILY,className:"edui-for-fontfamily",indexByValue:function(w){w="|"+w.replace(/,/g,"|").replace(/"/g,"")+"|";w.replace(/\s*|\s*/g,"|");for(var u=0;u<this.items.length;u++){var v=this.items[u];if(v.regex.test(w)){return u}}return -1}});l.addListener("selectionchange",function(v,u,y){if(!y){var x=l.queryCommandState("FontFamily");if(x==-1){o.setDisabled(true)}else{o.setDisabled(false);var w=l.queryCommandValue("FontFamily");o.setValue(w)}}});return o};g.FontSize=function(m,o,q){o=o||m.options.listMap.fontsize||[];q=q||m.options.labelMap.fontsize||"";var j=[];for(var l=0;l<o.length;l++){var k=o[l]+"px";j.push({label:k,value:k,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var n=new g.Combox({editor:m,items:j,title:q,initValue:m.options.ComboxInitial.FONT_SIZE,onselect:function(s,r){m.execCommand("FontSize",this.items[r].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});m.addListener("selectionchange",function(s,r,u){if(!u){var t=m.queryCommandState("FontSize");if(t==-1){n.setDisabled(true)}else{n.setDisabled(false);n.setValue(m.queryCommandValue("FontSize"))}}});return n};g.RowSpacing=function(k,l,o){l=l||k.options.listMap.rowspacing||[];o=o||k.options.labelMap.rowspacing||"";var m=[];for(var j=0;j<l.length;j++){var r=l[j].split(":");var s=r[0];var q=r[1];m.push({label:s,value:q,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-size:12px">'+(this.label||"")+"</div>"}})}var n=new g.Combox({editor:k,items:m,title:o,initValue:k.options.ComboxInitial.ROW_SPACING,onselect:function(v,u){k.execCommand("RowSpacing",this.items[u].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-rowspacing"});k.addListener("selectionchange",function(u,t,w){if(!w){var v=k.queryCommandState("RowSpacing");if(v==-1){n.setDisabled(true)}else{n.setDisabled(false);n.setValue(k.queryCommandValue("RowSpacing"))}}});return n};g.Paragraph=function(k,l,o){l=l||k.options.listMap.paragraph||[];o=o||k.options.labelMap.paragraph||"";var m=[];for(var j=0;j<l.length;j++){var r=l[j].split(":");var s=r[0];var q=r[1];m.push({label:q,value:s,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var n=new g.Combox({editor:k,items:m,title:o,initValue:k.options.ComboxInitial.PARAGRAPH,className:"edui-for-paragraph",onselect:function(v,u){k.execCommand("Paragraph",this.items[u].value)},onbuttonclick:function(){this.showPopup()}});k.addListener("selectionchange",function(v,u,y){if(!y){var x=k.queryCommandState("Paragraph");if(x==-1){n.setDisabled(true)}else{n.setDisabled(false);var w=k.queryCommandValue("Paragraph");var t=n.indexByValue(w);if(t!=-1){n.setValue(w)}else{n.setValue(n.initValue)}}}});return n};g.LineHeight=function(k,l,o){l=l||k.options.listMap.lineheight||[];o=o||k.options.labelMap.lineheight||"";var m=[];for(var j=0;j<l.length;j++){var r=l[j].split(":");var s=r[0];var q=r[1];m.push({label:q,value:s,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-size:12px">'+(this.label||"")+"</div>"}})}var n=new g.Combox({editor:k,items:m,title:o,initValue:k.options.ComboxInitial.LINE_HEIGHT,className:"edui-for-lineheight",onselect:function(v,u){k.execCommand("lineheight",this.items[u].value)},onbuttonclick:function(){this.showPopup()}});k.addListener("selectionchange",function(u,t,w){if(!w){var v=k.queryCommandState("lineheight");if(v==-1){n.setDisabled(true)}else{n.setDisabled(false);n.setValue(k.queryCommandValue("lineheight"))}}});return n};g.CustomStyle=function(m,o,q){o=o||m.options.listMap.customstyle||[];q=q||m.options.labelMap.customstyle||"";for(var l=0,j=[],k;k=o[l++];){(function(r){j.push({label:r.label,value:r,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+r.tag+" "+(r.className?' class="'+r.className+'"':"")+(r.style?' style="'+r.style+'"':"")+">"+r.label+"</"+r.tag+"></div>"}})})(k)}var n=new g.Combox({editor:m,items:j,title:q,initValue:m.options.ComboxInitial.CUSTOMSTYLE,className:"edui-for-customstyle",onselect:function(s,r){m.execCommand("customstyle",this.items[r].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(t){for(var r=0,s;s=this.items[r++];){if(s.label==t){return r-1}}return -1}});m.addListener("selectionchange",function(t,s,w){if(!w){var v=m.queryCommandState("customstyle");if(v==-1){n.setDisabled(true)}else{n.setDisabled(false);var u=m.queryCommandValue("customstyle");var r=n.indexByValue(u);if(r!=-1){n.setValue(u)}else{n.setValue(n.initValue)}}}});return n};g.InsertTable=function(l,k,n){k=k||l.options.iframeUrlMap.inserttable||"about:blank";k=l.ui.mapUrl(k);n=n||l.options.labelMap.inserttable||"";var j=new g.Dialog({iframeUrl:k,autoReset:true,draggable:true,editor:l,className:"edui-for-inserttable",title:n,buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){j.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){j.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(q,o){if(o){return this.onok()}else{return this.oncancel()}}});j.render();l.tableDialog=j;var m=new g.TableButton({editor:l,title:n,className:"edui-for-inserttable",onpicktable:function(o,r,q){l.execCommand("InsertTable",{numRows:q,numCols:r})},onmore:function(){j.open()},onbuttonclick:function(){j.open()}});l.addListener("selectionchange",function(){var o=l.queryCommandState("inserttable");if(o==-1){m.setDisabled(true)}else{m.setDisabled(false)}});return m};g.InsertOrderedList=function(j,l){l=l||j.options.labelMap.insertorderedlist||"";var m=function(){j.execCommand("InsertOrderedList",this.value)};var k=new g.MenuButton({editor:j,className:"edui-for-insertorderedlist",title:l,items:[{label:"1,2,3...",value:"decimal",onclick:m},{label:"a,b,c ...",value:"lower-alpha",onclick:m},{label:"i,ii,iii...",value:"lower-roman",onclick:m},{label:"A,B,C",value:"upper-alpha",onclick:m},{label:"I,II,III...",value:"upper-roman",onclick:m}],onbuttonclick:function(){var n=j.queryCommandValue("InsertOrderedList")||this.value;j.execCommand("InsertOrderedList",n)}});j.addListener("selectionchange",function(){var o=j.queryCommandState("InsertOrderedList");if(o==-1){k.setDisabled(true)}else{k.setDisabled(false);var n=j.queryCommandValue("InsertOrderedList");k.setValue(n);k.setChecked(o)}});return k};g.InsertUnorderedList=function(j,l){l=l||j.options.labelMap.insertunorderedlist||"";var m=function(){j.execCommand("InsertUnorderedList",this.value)};var k=new g.MenuButton({editor:j,className:"edui-for-insertunorderedlist",title:l,items:[{label:"○ 小圆圈",value:"circle",onclick:m},{label:"● 小圆点",value:"disc",onclick:m},{label:"■ 小方块",value:"square",onclick:m}],onbuttonclick:function(){var n=j.queryCommandValue("InsertUnorderedList")||this.value;j.execCommand("InsertUnorderedList",n)}});j.addListener("selectionchange",function(){var o=j.queryCommandState("InsertUnorderedList");if(o==-1){k.setDisabled(true)}else{k.setDisabled(false);var n=j.queryCommandValue("InsertUnorderedList");k.setValue(n);k.setChecked(o)}});return k};g.FullScreen=function(j,l){l=l||j.options.labelMap.fullscreen||"";var k=new g.Button({className:"edui-for-fullscreen",title:l,onclick:function(){if(j.ui){j.ui.setFullScreen(!j.ui.isFullScreen())}this.setChecked(j.ui.isFullScreen())}});j.addListener("selectionchange",function(){var m=j.queryCommandState("fullscreen");k.setDisabled(m==-1);k.setChecked(j.ui.isFullScreen())});return k};g.Emotion=function(k,j,m){m=m||k.options.labelMap.emotion||"";j=j||k.options.iframeUrlMap.emotion||"about:blank";j=k.ui.mapUrl(j);var l=new g.MultiMenuPop({title:m,editor:k,className:"edui-for-emotion",iframeUrl:j});k.addListener("selectionchange",function(){var n=k.queryCommandState("emotion");if(n==-1){l.setDisabled(true)}else{l.setDisabled(false)}});return l};g.Date=function(j){var k=new g.DateButton({editor:j,onpickdate:function(m,l){j.execCommand("inserthtml",l)},onbuttonclick:function(){j.execCommand("date")},className:"edui-for-date"});j.addListener("selectionchange",function(){var l=j.queryCommandState("inserthtml");if(l==-1){k.setDisabled(true)}else{k.setDisabled(false)}});return k}})();(function(){var a=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase;function b(e){this.initOptions(e);this.initEditorUI()}b.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var l=this.editor;l.addListener("ready",function(){baidu.editor.dom.domUtils.on(l.window,"scroll",function(){baidu.editor.ui.Popup.postHide()});if(l.options.elementPathEnabled){l.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">path:</div>'}if(l.options.wordCount){l.ui.getDom("wordcount").innerHTML="字数统计"}if(l.selection.getNative()){l.fireEvent("selectionchange",false,true)}});l.addListener("mousedown",function(r,q){var s=q.target||q.srcElement;baidu.editor.ui.Popup.postHide(s)});l.addListener("contextmenu",function(r,q){baidu.editor.ui.Popup.postHide()});var m=this;l.addListener("selectionchange",function(){m._updateElementPath();m._wordCount()});l.addListener("sourcemodechanged",function(q,r){if(l.options.elementPathEnabled){if(r){m.disableElementPath()}else{m.enableElementPath()}}if(l.options.wordCount){if(r){m.disableWordCount()}else{m.enableWordCount()}}});var o=new baidu.editor.ui.Dialog({iframeUrl:l.ui.mapUrl(m.editor.options.iframeUrlMap.link),autoReset:true,draggable:true,editor:l,className:"edui-for-link",title:"超链接",buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){o.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){o.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});o.render();var i=new baidu.editor.ui.Dialog({iframeUrl:l.ui.mapUrl(m.editor.options.iframeUrlMap.insertimage),autoReset:true,draggable:true,editor:l,className:"edui-for-insertimage",title:"图片",buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){i.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){i.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});i.render();var j=new baidu.editor.ui.Dialog({iframeUrl:l.ui.mapUrl(m.editor.options.iframeUrlMap.anchor),autoReset:true,draggable:true,editor:l,className:"edui-for-anchor",title:"锚点",buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){j.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){j.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});j.render();var h=new baidu.editor.ui.Dialog({iframeUrl:l.ui.mapUrl(m.editor.options.iframeUrlMap.insertvideo),autoReset:true,draggable:true,editor:l,className:"edui-for-insertvideo",title:"视频",buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){h.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){h.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});h.render();var f=new baidu.editor.ui.Dialog({iframeUrl:l.ui.mapUrl(m.editor.options.iframeUrlMap.wordimage),autoReset:true,draggable:true,editor:l,className:"edui-for-wordimage",title:"图片转存",buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){f.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){f.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});f.render();m._dialogs.wordImageDialog=f;var g=new baidu.editor.ui.Dialog({iframeUrl:l.ui.mapUrl(m.editor.options.iframeUrlMap.map),autoReset:true,draggable:true,editor:l,className:"edui-for-map",title:"地图",buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){g.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){g.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});g.render();var k=new baidu.editor.ui.Dialog({iframeUrl:l.ui.mapUrl(m.editor.options.iframeUrlMap.gmap),autoReset:true,draggable:true,editor:l,className:"edui-for-gmap",title:"Google地图",buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){k.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){k.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});k.render();var e=new baidu.editor.ui.Popup({editor:l,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();o.open()},_onImgEditButtonClick:function(){this.hide();var r=l.selection.getRange().getClosedNode();var q=baidu.editor.dom.domUtils.findParentByTagName(r,"img",true);if(q&&q.className.indexOf("edui-faked-video")!=-1){h.open()}else{if(q&&q.src.indexOf("http://api.map.baidu.com")!=-1){g.open()}else{if(q&&q.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){k.open()}else{if(q&&q.getAttribute("anchorname")){j.open()}else{i.open()}}}}},_getImg:function(){var q=l.selection.getRange().getClosedNode();if(q&&(q.nodeName=="img"||q.nodeName=="IMG")){return q}return null},_onImgSetFloat:function(r){if(this._getImg()){l.execCommand("imagefloat",r);var q=this._getImg();if(q){this.showAnchor(q)}}},_setIframeAlign:function(q){var r=e.anchorEl;var s=r.cloneNode(true);switch(q){case -2:s.setAttribute("align","");break;case -1:s.setAttribute("align","left");break;case 1:s.setAttribute("align","right");break;case 2:s.setAttribute("align","middle");break}r.parentNode.insertBefore(s,r);baidu.editor.dom.domUtils.remove(r);e.anchorEl=s;e.showAnchor(e.anchorEl)},_updateIframe:function(){l._iframe=e.anchorEl;n.open();e.hide()},_onRemoveButtonClick:function(){var r=l.selection.getRange().getClosedNode();var q=baidu.editor.dom.domUtils.findParentByTagName(r,"img",true);if(q&&q.getAttribute("anchorname")){l.execCommand("anchor")}else{l.execCommand("unlink")}this.hide()},queryAutoHide:function(q){if(q&&q.ownerDocument==l.document){if(q.tagName.toLowerCase()=="img"||baidu.editor.dom.domUtils.findParentByTagName(q,"a",true)){return q!==e.anchorEl}}return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,q)}});e.render();var n=new baidu.editor.ui.Dialog({iframeUrl:l.ui.mapUrl(m.editor.options.iframeUrlMap.insertframe),autoReset:true,draggable:true,editor:l,className:"edui-for-insertframe",title:"插入iframe",buttons:[{className:"edui-okbutton",label:"确认",onclick:function(){n.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){n.close(false)}}],onok:function(){},oncancel:function(){},onclose:function(r,q){if(q){return this.onok()}else{return this.oncancel()}}});n.render();l.addListener("mouseover",function(s,q){q=q||window.event;var u=q.target||q.srcElement;if(/iframe/ig.test(u.tagName)&&l.options.imagePopup){var r=e.formatHtml('<nobr>属性: <span onclick=$$._setIframeAlign(-2) class="edui-clickable">默认</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">左对齐</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">右对齐</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(2) class="edui-clickable">居中</span> <span onclick="$$._updateIframe( this);" class="edui-clickable">修改</span></nobr>');if(r){e.getDom("content").innerHTML=r;e.anchorEl=u;e.showAnchor(e.anchorEl)}else{e.hide()}}});l.addListener("selectionchange",function(w,u){if(!u){return}var v="";var r=l.selection.getRange().getClosedNode();if(r!=null&&r.tagName.toLowerCase()=="img"){if(r.getAttribute("anchorname")){v+=e.formatHtml('<nobr>属性: <span onclick=$$._onImgEditButtonClick(event) class="edui-clickable">修改</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick(event) class="edui-clickable">删除</span></nobr>')}else{if(l.options.imagePopup){v+=e.formatHtml('<nobr>属性: <span onclick=$$._onImgSetFloat("none") class="edui-clickable">默认</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">居左</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">居右</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">居中</span> <span onclick="$$._onImgEditButtonClick(event, this);" class="edui-clickable">修改</span></nobr>')}}}var x;if(l.selection.getRange().collapsed){x=l.queryCommandValue("link")}else{x=l.selection.getStart()}x=baidu.editor.dom.domUtils.findParentByTagName(x,"a",true);var s;if(x!=null&&(s=(x.getAttribute("data_ue_src")||x.getAttribute("href",2)))!=null){var q=s;if(s.length>30){q=s.substring(0,20)+"..."}if(v){v+='<div style="height:5px;"></div>'}v+=e.formatHtml('<nobr>链接: <a target="_blank" href="'+s+'" title="'+s+'" >'+q+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick(event, this);">修改</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(event, this);"> 清除</span></nobr>');e.showAnchor(x)}if(v){e.getDom("content").innerHTML=v;e.anchorEl=r||x;e.showAnchor(e.anchorEl)}else{e.hide()}})},_initToolbars:function(){var m=this.editor;var o=this.toolbars||[];var g=[];for(var l=0;l<o.length;l++){var n=o[l];var h=new baidu.editor.ui.Toolbar();for(var k=0;k<n.length;k++){var e=n[k];var f=null;if(typeof e=="string"){if(e=="|"){e="Separator"}if(baidu.editor.ui[e]){f=new baidu.editor.ui[e](m)}if(e=="FullScreen"){if(g&&g[0]){g[0].items.splice(0,0,f)}else{h.items.splice(0,0,f)}continue}}else{f=e}if(f){h.add(f)}}g[l]=h}this.toolbars=g},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox"><div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+'</div></div><div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">点此上传</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td></tr></table></div></div>'},showWordImageDialog:function(){this.editor.execCommand("checkimage","_localImages");this._dialogs.wordImageDialog.open()},renderToolbarBoxHtml:function(){var f=[];for(var e=0;e<this.toolbars.length;e++){f.push(this.toolbars[e].renderHtml())}return f.join("")},setFullScreen:function(i){function g(j){j.body.contentEditable=false;setTimeout(function(){j.body.contentEditable=true},200)}if(this._fullscreen!=i){this._fullscreen=i;this.editor.fireEvent("beforefullscreenchange",i);var h=this.editor;if(baidu.editor.browser.gecko){var e=h.selection.getRange().createBookmark()}if(i){this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this._bakAutoHeight){this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;this._updateFullScreen()}else{this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;window.scrollTo(0,this._bakScrollTop)}if(baidu.editor.browser.gecko){var f=document.createElement("input");document.body.appendChild(f);h.body.contentEditable=false;setTimeout(function(){f.focus();setTimeout(function(){h.body.contentEditable=true;h.selection.getRange().moveToBookmark(e).select(true);baidu.editor.dom.domUtils.remove(f);i&&window.scroll(0,0)})})}this.editor.fireEvent("fullscreenchanged",i);this.triggerLayout()}},_wordCount:function(){var e=this.getDom("wordcount");if(!this.editor.options.wordCount){e.style.display="none";return}e.innerHTML=this.editor.queryCommandValue("wordcount")},disableWordCount:function(){var e=this.getDom("wordcount");e.innerHTML="";e.style.display="none";this.wordcount=false},enableWordCount:function(){var e=this.getDom("wordcount");e.style.display="";this.wordcount=true;this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var e=c.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);c.setViewportOffset(this.getDom(),{left:0,top:0});this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight)}},_updateElementPath:function(){var e=this.getDom("elementpath");if(this.elementPathEnabled){var h=this.editor.queryCommandValue("elementpath");var j=[];for(var g=0,f;f=h[g];g++){j[g]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+g+'&quot;);">'+f+"</span>")}e.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">path: '+j.join(" &gt; ")+"</div>"}else{e.style.display="none"}},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="";e.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){var e=this.getDom("elementpath");e.style.display="";this.elementPathEnabled=true;this._updateElementPath()},isFullScreen:function(){return this._fullscreen},postRender:function(){d.prototype.postRender.call(this);for(var g=0;g<this.toolbars.length;g++){this.toolbars[g].postRender()}var h=this;var f,e=baidu.editor.dom.domUtils,j=function(){clearTimeout(f);f=setTimeout(function(){h._updateFullScreen()})};e.on(window,"resize",j);h.addListener("destroy",function(){e.un(window,"resize",j);clearTimeout(f)})},showToolbarMsg:function(g,f){this.getDom("toolbarmsg_label").innerHTML=g;this.getDom("toolbarmsg").style.display="";if(!f){var e=this.getDom("upload_dialog");e.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e.replace("~/",this.editor.options.UEDITOR_HOME_URL||"")},triggerLayout:function(){var e=this.getDom();if(e.style.zoom=="1"){e.style.zoom="100%"}else{e.style.zoom="1"}}};a.inherits(b,baidu.editor.ui.UIBase);baidu.editor.ui.Editor=function(e){var g=new baidu.editor.Editor(e);g.options.editor=g;new b(g.options);var f=g.render;g.render=function(j){if(j){if(j.constructor===String){j=document.getElementById(j)}j&&j.getAttribute("name")&&(g.options.textarea=j.getAttribute("name"));if(j&&/script|textarea/ig.test(j.tagName)){var i=document.createElement("div");j.parentNode.insertBefore(i,j);g.options.initialContent=j.value||j.innerHTML;j.id&&(i.id=j.id);j.className&&(i.className=j.className);j.style.cssText&&(i.style.cssText=j.style.cssText);j.parentNode.removeChild(j);j=i;j.innerHTML=""}}g.ui.render(j);var h=g.ui.getDom("iframeholder");g.container=g.ui.getDom();g.container.style.zIndex=g.options.zIndex;f.call(g,h)};return g}})();(function(){var c=baidu.editor.utils,d=baidu.editor.ui.Popup,b=baidu.editor.ui.SplitButton,a=baidu.editor.ui.MultiMenuPop=function(e){this.initOptions(e);this.initMultiMenu()};a.prototype={initMultiMenu:function(){var e=this;this.popup=new d({content:"",iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>';e.editor.container.style.zIndex&&(this.getDom().style.zIndex=e.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};c.inherits(a,b)})();(function(){var a=baidu.editor.dom.domUtils,f=a.isBlockElm,e=["TD","LI","PRE"],b=baidu.editor.utils,c=baidu.editor.browser,d=function(i,g,n){var k=i.createBookmark(),o=function(s){return s.nodeType==1?s.tagName.toLowerCase()!="br"&&!a.isBookmarkNode(s):!a.isWhitespace(s)},r;i.enlarge(true);var q=i.createBookmark(),j=a.getNextDomNode(q.start,false,o),m=i.cloneRange(),h;while(j&&!(a.getPosition(j,q.end)&a.POSITION_FOLLOWING)){if(j.nodeType==3||!f(j)){m.setStartBefore(j);while(j&&j!==q.end&&!f(j)){h=j;j=a.getNextDomNode(j,false,null,function(s){return !f(s)})}m.setEndAfter(h);r=i.document.createElement(g);if(n){a.setAttributes(r,n)}r.appendChild(m.extractContents());if(a.isEmptyNode(r)){a.fillChar(i.document,r)}m.insertNode(r);var l=r.parentNode;if(f(l)&&!a.isBody(r.parentNode)&&b.indexOf(e,l.tagName)==-1){l.getAttribute("dir")&&r.setAttribute("dir",l.getAttribute("dir"));l.style.cssText&&(r.style.cssText=l.style.cssText+";"+r.style.cssText);l.style.textAlign&&!r.style.textAlign&&(r.style.textAlign=l.style.textAlign);l.style.textIndent&&!r.style.textIndent&&(r.style.textIndent=l.style.textIndent);l.style.padding&&!r.style.padding&&(r.style.padding=l.style.padding);if(n&&/h\d/i.test(l.tagName)){a.setAttributes(l,n);a.remove(r,true);r=l}else{a.remove(r.parentNode,true)}}if(b.indexOf(e,l.tagName)!=-1){j=l}else{j=r}j=a.getNextDomNode(j,false,o)}else{j=a.getNextDomNode(j,true,o)}}return i.moveToBookmark(q).moveToBookmark(k)};baidu.editor.commands.paragraph={execCommand:function(t,g,s){var q=new baidu.editor.dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var o=0,h;h=this.currentSelectedArr[o++];){if(h.style.display=="none"){continue}if(a.isEmptyNode(h)){var m=this.document.createTextNode("paragraph");h.innerHTML="";h.appendChild(m)}d(q.selectNodeContents(h),g,s);if(m){var r=m.parentNode;a.remove(m);if(a.isEmptyNode(r)){a.fillNode(this.document,r)}}}var l=this.currentSelectedArr[0];if(a.isEmptyBlock(l)){q.setStart(l,0).setCursor(false,true)}else{q.selectNode(l).select()}}else{q=this.selection.getRange();if(q.collapsed){var n=this.document.createTextNode("p");q.insertNode(n);if(c.ie){var k=n.previousSibling;if(k&&a.isWhitespace(k)){a.remove(k)}k=n.nextSibling;if(k&&a.isWhitespace(k)){a.remove(k)}}}q=d(q,g,s);if(n){q.setStartBefore(n).collapse(true);r=n.parentNode;a.remove(n);if(a.isBlockElm(r)&&a.isEmptyNode(r)){a.fillNode(this.document,r)}}if(c.gecko&&q.collapsed&&q.startContainer.nodeType==1){var j=q.startContainer.childNodes[q.startOffset];if(j&&j.nodeType==1&&j.tagName.toLowerCase()==g){q.setStart(j,0).collapse(true)}}q.select()}return true},queryCommandValue:function(){var g=this.selection.getStart(),h=a.findParentByTagName(g,["p","h1","h2","h3","h4","h5","h6"],true);return h&&h.tagName.toLowerCase()},queryCommandState:function(){return this.highlight?-1:0}}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.dom.dtd;baidu.editor.commands.removeformat={execCommand:function(o,s,c,m,n){var h=new RegExp("^(?:"+(s||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),f=c?[]:(m||this.options.removeFormatAttributes).split(","),j=new baidu.editor.dom.Range(this.document),k,e,l,d=function(i){return i.nodeType==1};function q(y){var i=y.createBookmark();if(y.collapsed){y.enlarge(true)}if(!n){var t=a.findParentByTagName(y.startContainer,"a",true);if(t){y.setStartBefore(t)}t=a.findParentByTagName(y.endContainer,"a",true);if(t){y.setEndAfter(t)}}k=y.createBookmark();u=k.start;while((l=u.parentNode)&&!a.isBlockElm(l)){a.breakParent(u,l);a.clearEmptySibling(u)}if(k.end){u=k.end;while((l=u.parentNode)&&!a.isBlockElm(l)){a.breakParent(u,l);a.clearEmptySibling(u)}var z=a.getNextDomNode(k.start,false,d),x;while(z){if(z==k.end){break}x=a.getNextDomNode(z,true,d);if(!b.$empty[z.tagName.toLowerCase()]&&!a.isBookmarkNode(z)){if(h.test(z.tagName)){if(c){a.removeStyle(z,c);if(a.isRedundantSpan(z)&&c!="text-decoration"){a.remove(z,true)}}else{a.remove(z,true)}}else{if(!b.$tableContent[z.tagName]&&!b.$list[z.tagName]){a.removeAttributes(z,f);if(a.isRedundantSpan(z)){a.remove(z,true)}}}}z=x}}var A=k.start.parentNode;if(a.isBlockElm(A)&&!b.$tableContent[A.tagName]&&!b.$list[A.tagName]){a.removeAttributes(A,f)}A=k.end.parentNode;if(k.end&&a.isBlockElm(A)&&!b.$tableContent[A.tagName]&&!b.$list[A.tagName]){a.removeAttributes(A,f)}y.moveToBookmark(k).moveToBookmark(i);var u=y.startContainer,w,v=y.collapsed;while(u.nodeType==1&&a.isEmptyNode(u)&&b.$removeEmpty[u.tagName]){w=u.parentNode;y.setStartBefore(u);if(y.startContainer===y.endContainer){y.endOffset--}a.remove(u);u=w}if(!v){u=y.endContainer;while(u.nodeType==1&&a.isEmptyNode(u)&&b.$removeEmpty[u.tagName]){w=u.parentNode;y.setEndBefore(u);a.remove(u);u=w}}}if(this.currentSelectedArr&&this.currentSelectedArr.length){for(var g=0,r;r=this.currentSelectedArr[g++];){j.selectNodeContents(r);q(j)}j.selectNodeContents(this.currentSelectedArr[0]).select()}else{j=this.selection.getRange();q(j);j.select()}},queryCommandState:function(){return this.highlight?-1:0}}})();(function(){var a=baidu.editor.dom.domUtils,f={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"},d=new RegExp(a.fillChar,"g"),c=baidu.editor.browser,b=0;for(var e in f){(function(h,g){baidu.editor.commands[h]={execCommand:function(q,m){m=m||(this.queryCommandState(q)?"none":q=="underline"?"underline":"line-through");var l=this,k=this.selection.getRange(),o;if(!b){l.addListener("beforegetcontent",function(){a.clearReduent(l.document,["span"])});b=1}if(m=="default"){if(k.collapsed){o=l.document.createTextNode("font");k.insertNode(o).select()}l.execCommand("removeFormat","span,a",g);if(o){k.setStartBefore(o).setCursor();a.remove(o)}}else{if(l.currentSelectedArr&&l.currentSelectedArr.length>0){for(var j=0,s;s=l.currentSelectedArr[j++];){k.selectNodeContents(s);k.applyInlineStyle("span",{style:g+":"+m})}k.selectNodeContents(this.currentSelectedArr[0]).select()}else{if(!k.collapsed){if((h=="underline"||h=="strikethrough")&&l.queryCommandValue(h)){l.execCommand("removeFormat","span,a",g)}k=l.selection.getRange();k.applyInlineStyle("span",{style:g+":"+m}).select()}else{var n=a.findParentByTagName(k.startContainer,"span",true);o=l.document.createTextNode("font");if(n&&!n.children.length&&!n[c.ie?"innerText":"textContent"].replace(d,"").length){k.insertNode(o);if(h=="underline"||h=="strikethrough"){k.selectNode(o).select();l.execCommand("removeFormat","span,a",g,null);n=a.findParentByTagName(o,"span",true);k.setStartBefore(o)}n.style.cssText=n.style.cssText+";"+g+":"+m;k.collapse(true).select()}else{k.insertNode(o);k.selectNode(o).select();n=k.document.createElement("span");if(h=="underline"||h=="strikethrough"){if(a.findParentByTagName(o,"a",true)){k.setStartBefore(o).setCursor();a.remove(o);return}l.execCommand("removeFormat","span,a",g)}n.style.cssText=g+":"+m;o.parentNode.insertBefore(n,o);if(!c.ie||c.ie&&c.version==9){var r=n.parentNode;while(!a.isBlockElm(r)){if(r.tagName=="SPAN"){n.style.cssText=r.style.cssText+n.style.cssText}r=r.parentNode}}k.setStart(n,0).setCursor()}a.remove(o)}}}return true},queryCommandValue:function(j){var i=this.selection.getStart();if(j=="underline"||j=="strikethrough"){var k=i,l;while(k&&!a.isBlockElm(k)&&!a.isBody(k)){if(k.nodeType==1){l=a.getComputedStyle(k,g);if(l!="none"){return l}}k=k.parentNode}return"none"}return a.getComputedStyle(i,g)},queryCommandState:function(i){if(this.highlight){return -1}if(!(i=="underline"||i=="strikethrough")){return 0}return this.queryCommandValue(i)==(i=="underline"?"underline":"line-through")}}})(e,f[e])}})();(function(){var a=baidu.editor.dom.domUtils,d=baidu.editor.dom.dtd,b=baidu.editor.utils,c=baidu.editor.browser;baidu.editor.commands.inserthtml={execCommand:function(k,q){var s=this,r,v,n,x,g,m=s.currentSelectedArr;r=s.selection.getRange();g=r.document.createElement("div");g.style.display="inline";g.innerHTML=b.trim(q);try{s.adjustTable&&s.adjustTable(g)}catch(u){}if(m&&m.length){for(var n=0,f;f=m[n++];){f.className=""}m[0].innerHTML="";r.setStart(m[0],0).collapse(true);s.currentSelectedArr=[]}if(!r.collapsed){r.deleteContents();if(r.startContainer.nodeType==1){var h=r.startContainer.childNodes[r.startOffset],j;if(h&&a.isBlockElm(h)&&(j=h.previousSibling)&&a.isBlockElm(j)){r.setEnd(j,j.childNodes.length).collapse();while(h.firstChild){j.appendChild(h.firstChild)}a.remove(h)}}}var h,w,j,l,t=0;while(h=g.firstChild){r.insertNode(h);if(!t&&h.nodeType==a.NODE_ELEMENT&&a.isBlockElm(h)){w=a.findParent(h,function(e){return a.isBlockElm(e)});if(w&&w.tagName.toLowerCase()!="body"&&!(d[w.tagName][h.nodeName]&&h.parentNode===w)){if(!d[w.tagName][h.nodeName]){j=w}else{l=h.parentNode;while(l!==w){j=l;l=l.parentNode}}a.breakParent(h,j||l);var j=h.previousSibling;a.trimWhiteTextNode(j);if(!j.childNodes.length){a.remove(j)}t=1}}var o=h.nextSibling;if(!g.firstChild&&o&&a.isBlockElm(o)){r.setStart(o,0).collapse(true);break}r.setEndAfter(h).collapse()}h=r.startContainer;if(a.isBlockElm(h)&&a.isEmptyNode(h)){h.innerHTML=baidu.editor.browser.ie?"":"<br/>"}r.select(true);setTimeout(function(){r=s.selection.getRange();r.scrollToView(s.autoHeightEnabled,s.autoHeightEnabled?a.getXY(s.iframe).y:0)},200)}}}());(function(){baidu.editor.commands.spechars={execCommand:function(){},queryCommandState:function(){return this.highlight?-1:0}}})();(function(){var a=baidu.editor.browser;baidu.editor.commands.selectall={execCommand:function(){this.document.execCommand("selectAll",false,null);!a.ie&&this.focus()},notNeedUndo:1}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.dom.dtd,c=function(e){var d=e.selection.getStart();return a.findParentByTagName(d,"blockquote",true)};baidu.editor.commands.blockquote={execCommand:function(o,t){var s=this.selection.getRange(),r=c(this),e=b.blockquote,n=s.createBookmark(),w=this.currentSelectedArr;if(r){if(w&&w.length){a.remove(r,true)}else{var l=s.startContainer,m=a.isBlockElm(l)?l:a.findParent(l,function(i){return a.isBlockElm(i)}),g=s.endContainer,h=a.isBlockElm(g)?g:a.findParent(g,function(i){return a.isBlockElm(i)});m=a.findParentByTagName(m,"li",true)||m;h=a.findParentByTagName(h,"li",true)||h;if(m.tagName=="LI"||m.tagName=="TD"||m===r){a.remove(r,true)}else{a.breakParent(m,r)}if(m!==h){r=a.findParentByTagName(h,"blockquote");if(r){if(h.tagName=="LI"||h.tagName=="TD"){a.remove(r,true)}else{a.breakParent(h,r)}}}var k=a.getElementsByTagName(this.document,"blockquote");for(var x=0,f;f=k[x++];){if(!f.childNodes.length){a.remove(f)}else{if(a.getPosition(f,m)&a.POSITION_FOLLOWING&&a.getPosition(f,h)&a.POSITION_PRECEDING){a.remove(f,true)}}}}}else{var y=s.cloneRange(),u=y.startContainer.nodeType==1?y.startContainer:y.startContainer.parentNode,d=u,v=1;while(1){if(a.isBody(u)){if(d!==u){if(s.collapsed){y.selectNode(d);v=0}else{y.setStartBefore(d)}}else{y.setStart(u,0)}break}if(!e[u.tagName]){if(s.collapsed){y.selectNode(d)}else{y.setStartBefore(d)}break}d=u;u=u.parentNode}if(v){d=u=u=y.endContainer.nodeType==1?y.endContainer:y.endContainer.parentNode;while(1){if(a.isBody(u)){if(d!==u){y.setEndAfter(d)}else{y.setEnd(u,u.childNodes.length)}break}if(!e[u.tagName]){y.setEndAfter(d);break}d=u;u=u.parentNode}}u=s.document.createElement("blockquote");a.setAttributes(u,t);u.appendChild(y.extractContents());y.insertNode(u);var j=a.getElementsByTagName(u,"blockquote");for(var x=0,q;q=j[x++];){if(q.parentNode){a.remove(q,true)}}}s.moveToBookmark(n).select()},queryCommandState:function(){if(this.highlight){return -1}return c(this)?1:0}}})();(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.anchor={execCommand:function(f,e){var c=this.selection.getRange();var b=c.getClosedNode();if(b&&b.getAttribute("anchorname")){if(e){b.setAttribute("anchorname",e)}else{c.setStartBefore(b).setCursor();a.remove(b)}}else{if(e){var d=this.document.createElement("img");c.collapse(true);d.setAttribute("anchorname",e);d.className="anchorclass";c.insertNode(d).setStartAfter(d).collapse(true).select(true)}}},queryCommandState:function(){return this.highlight?-1:0}}})();(function(){var a=baidu.editor.dom.domUtils,c=baidu.editor.utils,b={left:1,right:1,center:1},d=baidu.editor.dom.dtd;baidu.editor.commands.imagefloat={execCommand:function(j,l){var g=this.selection.getRange();if(!g.collapsed){var f=g.getClosedNode();if(f&&f.tagName=="IMG"){switch(l){case"left":case"right":case"none":var e=f.parentNode,i,k,h;while(d.$inline[e.tagName]||e.tagName=="A"){e=e.parentNode}i=e;if(i.tagName=="P"&&a.getStyle(i,"text-align")=="center"){if(!a.isBody(i)&&a.getChildCount(i,function(m){return !a.isBr(m)&&!a.isWhitespace(m)})==1){k=i.previousSibling;h=i.nextSibling;if(k&&h&&k.nodeType==1&&h.nodeType==1&&k.tagName==h.tagName&&a.isBlockElm(k)){k.appendChild(i.firstChild);while(h.firstChild){k.appendChild(h.firstChild)}a.remove(i);a.remove(h)}else{a.setStyle(i,"text-align","")}}g.selectNode(f).select()}a.setStyle(f,"float",l);break;case"center":if(this.queryCommandValue("imagefloat")!="center"){e=f.parentNode;a.setStyle(f,"float","none");i=f;while(e&&a.getChildCount(e,function(m){return !a.isBr(m)&&!a.isWhitespace(m)})==1&&(d.$inline[e.tagName]||e.tagName=="A")){i=e;e=e.parentNode}g.setStartBefore(i).setCursor(false);e=this.document.createElement("div");e.appendChild(i);a.setStyle(i,"float","");this.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+e.innerHTML+"</p>");i=this.document.getElementById("_img_parent_tmp");i.removeAttribute("id");i=i.firstChild;g.selectNode(i).select();h=i.parentNode.nextSibling;if(h&&a.isEmptyNode(h)){a.remove(h)}}break}}}},queryCommandValue:function(){var e=this.selection.getRange(),f,g;if(e.collapsed){return"none"}f=e.getClosedNode();if(f&&f.nodeType==1&&f.tagName=="IMG"){g=a.getComputedStyle(f,"float");if(g=="none"){g=a.getComputedStyle(f.parentNode,"text-align")=="center"?"center":g}return b[g]?g:"none"}return"none"},queryCommandState:function(){if(this.highlight){return -1}var e=this.selection.getRange(),f;if(e.collapsed){return -1}f=e.getClosedNode();if(f&&f.nodeType==1&&f.tagName=="IMG"){return 0}return -1}};baidu.editor.commands.insertimage={execCommand:function(f,e){e=c.isArray(e)?e:[e];var l=this.selection.getRange(),h=l.getClosedNode();if(h&&/img/i.test(h.tagName)&&h.className!="edui-faked-video"&&!h.getAttribute("word_img")){var j=e.shift();var n=j.floatStyle;delete j.floatStyle;a.setAttributes(h,j);this.execCommand("imagefloat",n);if(e.length>0){l.setStartAfter(h).setCursor(false,true);this.execCommand("insertimage",e)}}else{var k=[],m="",o;o=e[0];if(e.length==1){m='<img src="'+o.src+'" '+(o.data_ue_src?' data_ue_src="'+o.data_ue_src+'" ':"")+(o.width?'width="'+o.width+'" ':"")+(o.height?' height="'+o.height+'" ':"")+(o.floatStyle&&o.floatStyle!="center"?' style="float:'+o.floatStyle+';"':"")+(o.title?' title="'+o.title+'"':"")+' border="'+(o.border||0)+'" hspace = "'+(o.hspace||0)+'" vspace = "'+(o.vspace||0)+'" />';if(o.floatStyle=="center"){m='<p style="text-align: center">'+m+"</p>"}k.push(m)}else{for(var g=0;o=e[g++];){m="<p "+(o.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+o.src+'" '+(o.width?'width="'+o.width+'" ':"")+(o.data_ue_src?' data_ue_src="'+o.data_ue_src+'" ':"")+(o.height?' height="'+o.height+'" ':"")+' style="'+(o.floatStyle&&o.floatStyle!="center"?"float:"+o.floatStyle+";":"")+(o.border||"")+'" '+(o.title?' title="'+o.title+'"':"")+" /></p>";k.push(m)}}this.execCommand("insertHtml",k.join(""))}},queryCommandState:function(){return this.highlight?-1:0}}})();(function(){baidu.editor.commands.emotion={queryCommandState:function(){return this.highlight?-1:0}}})();(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.rowspacing={execCommand:function(b,c){this.execCommand("paragraph","p",{style:"padding:"+c+"px 0"});return true},queryCommandValue:function(){var c=this.selection.getStart(),b=a.findParent(c,function(e){return a.isBlockElm(e)},true),d;if(b){d=a.getComputedStyle(b,"padding-top").replace(/[^\d]/g,"");return d*1<=10?0:d}return 0},queryCommandState:function(){return this.highlight?-1:0}}})();(function(){function a(b,c){b.setStart(c,0).setCursor()}baidu.editor.commands.cleardoc={execCommand:function(e){var f=this,c=f.options.enterTag,d=baidu.editor.browser,b=this.selection.getRange();if(c=="br"){this.body.innerHTML="<br/>";a(b,this.body)}else{this.body.innerHTML="<p>"+(d.ie?"":"<br/>")+"</p>";f.focus();a(b,f.body.firstChild)}}}})();(function(){baidu.editor.commands.gmap=baidu.editor.commands.map={execCommand:function(){},queryCommandState:function(){return this.highlight?-1:0}}})();(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.lineheight={execCommand:function(b,c){this.execCommand("paragraph","p",{style:"line-height:"+c+"%"});return true},queryCommandValue:function(){var c=this.selection.getStart(),b=a.findParent(c,function(e){return a.isBlockElm(e)},true),d;if(b){d=a.getComputedStyle(b,"line-height").replace(/[^\d]*/ig,"");return(d=="normal"||d<100)?100:d+"%"}return 100},queryCommandState:function(){return this.highlight?-1:0}}})();baidu.editor.commands.preview={execCommand:function(){var g=this,c=window.open("","_blank",""),i=c.document,b=baidu.editor.utils,e=g.document.getElementById("syntaxhighlighter_css"),h=document.getElementById("syntaxhighlighter_js"),f="<style type='text/css'>"+g.options.initialStyle+"</style>",a=g.getContent();if(baidu.editor.browser.ie){a=a.replace(/<\s*br\s*\/?\s*>/gi,"<br/><br/>")}i.open();i.write("<html><head>"+f+'<link rel="stylesheet" type="text/css" href="'+g.options.UEDITOR_HOME_URL+b.unhtml(this.options.iframeCssUrl)+'"/>'+(e?'<link rel="stylesheet" type="text/css" href="'+e.href+'"/>':"")+(e?' <script type="text/javascript" charset="utf-8" src="'+h.src+'"><\/script>':"")+"<title></title></head><body >"+a+'</body><script type="text/javascript">'+(baidu.editor.browser.ie?"window.onload = function(){SyntaxHighlighter.all()}":"SyntaxHighlighter.all()")+"<\/script></html>");i.close()},notNeedUndo:1};(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.indent={execCommand:function(){var b=this,c=b.queryCommandState("indent")?"0em":b.options.indentValue||"2em";b.execCommand("Paragraph","p",{style:"text-indent:"+c})},queryCommandState:function(){if(this.highlight){return -1}var d=this.selection.getStart(),c=a.findParentByTagName(d,["p","h1","h2","h3","h4","h5","h6"],true),b=c&&c.style.textIndent?parseInt(c.style.textIndent):"";return b?1:0}}})();(function(){var a=baidu.editor.dom.domUtils,d=a.isBlockElm,c=function(j){var f=j.selection.getStart(),e;if(f){e=a.findParents(f,true,d,true);for(var h=0,g;g=e[h++];){if(g.getAttribute("dir")){return g}}}},b=function(i,j,h){var m,q=function(s){return s.nodeType==1?!a.isBookmarkNode(s):!a.isWhitespace(s)},g=c(j);if(g&&i.collapsed){g.setAttribute("dir",h);return i}m=i.createBookmark();i.enlarge(true);var r=i.createBookmark(),l=a.getNextDomNode(r.start,false,q),n=i.cloneRange(),f;while(l&&!(a.getPosition(l,r.end)&a.POSITION_FOLLOWING)){if(l.nodeType==3||!d(l)){n.setStartBefore(l);while(l&&l!==r.end&&!d(l)){f=l;l=a.getNextDomNode(l,false,null,function(s){return !d(s)})}n.setEndAfter(f);var k=n.getCommonAncestor();if(!a.isBody(k)&&d(k)){k.setAttribute("dir",h);l=k}else{var e=i.document.createElement("p");e.setAttribute("dir",h);var o=n.extractContents();e.appendChild(o);n.insertNode(e);l=e}l=a.getNextDomNode(l,false,q)}else{l=a.getNextDomNode(l,true,q)}}return i.moveToBookmark(r).moveToBookmark(m)};baidu.editor.commands.directionality={execCommand:function(h,g){var f=new baidu.editor.dom.Range(this.document);if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var j=0,k;k=this.currentSelectedArr[j++];){if(k.style.display!="none"){b(f.selectNode(k),this,g)}}f.selectNode(this.currentSelectedArr[0]).select()}else{f=this.selection.getRange();if(f.collapsed){var e=this.document.createTextNode("d");f.insertNode(e)}b(f,this,g);if(e){f.setStartBefore(e).collapse(true);a.remove(e)}f.select()}return true},queryCommandValue:function(){var e=c(this);return e?e.getAttribute("dir"):"ltr"},queryCommandState:function(){return this.highlight?-1:0}}})();baidu.editor.commands.wordcount={queryCommandValue:function(e,f){var b,a,c;if(f){c=new RegExp("[\r\t\n]","g");a=this.getContentTxt().replace(c,"");return a.length}var g=this.options.wordCount,i=this.options.maximumWords,d=this.options.messages.wordCountMsg,h=this.options.messages.wordOverFlowMsg;if(!g){return""}c=new RegExp("[\r\t\n]","g");a=this.getContentTxt().replace(c,"");b=a.length;if(i-b<0){return"<span style='color:red;direction: none'>"+h+"</span> "}d=d.replace("{#leave}",i-b>=0?i-b:0);d=d.replace("{#count}",b);return d}};(function(){var a=baidu.editor.dom.domUtils;baidu.editor.commands.horizontal={execCommand:function(c){if(this.queryCommandState(c)!==-1){this.execCommand("insertHtml","<hr>");var b=this.selection.getRange(),e=b.startContainer;if(e.nodeType==1&&!e.childNodes[b.startOffset]){var d;if(d=e.childNodes[b.startOffset-1]){if(d.nodeType==1&&d.tagName=="HR"){if(this.options.enterTag=="p"){d=this.document.createElement("p");b.insertNode(d);b.setStart(d,0).setCursor()}else{d=this.document.createElement("br");b.insertNode(d);b.setStartBefore(d).setCursor()}}}}return true}},queryCommandState:function(){if(this.highlight){return -1}var b=this.selection.getRange();return a.findParentByTagName(b.startContainer,"table")||a.findParentByTagName(b.endContainer,"table")?-1:0}}})();(function(){baidu.editor.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1}})();(function(){var d=baidu.editor.dom,a=d.domUtils,b=baidu.editor.browser;function c(g){var h=g.startContainer,f=g.endContainer;if(h=a.findParentByTagName(h,"a",true)){g.setStartBefore(h)}if(f=a.findParentByTagName(f,"a",true)){g.setEndAfter(f)}}baidu.editor.commands.unlink={execCommand:function(){var f,g=new baidu.editor.dom.Range(this.document),n=this.currentSelectedArr,m;if(n&&n.length>0){for(var k=0,l;l=n[k++];){f=a.getElementsByTagName(l,"a");for(var h=0,o;o=f[h++];){a.remove(o,true)}}if(a.isEmptyNode(n[0])){g.setStart(n[0],0).setCursor()}else{g.selectNodeContents(n[0]).select()}}else{g=this.selection.getRange();if(g.collapsed&&!a.findParentByTagName(g.startContainer,"a",true)){return}m=g.createBookmark();c(g);g.removeInlineStyle("a").moveToBookmark(m).select()}},queryCommandState:function(){if(this.highlight){return -1}return this.queryCommandValue("link")?0:-1}};function e(g,h){c(g=g.adjustmentBoundary());var i=g.startContainer;if(i.nodeType==1){i=i.childNodes[g.startOffset];if(i&&i.nodeType==1&&i.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(i[b.ie?"innerText":"textContent"])){i.innerHTML=h.href}}g.removeInlineStyle("a");if(g.collapsed){var f=g.document.createElement("a");a.setAttributes(f,h);f.innerHTML=h.href;g.insertNode(f).selectNode(f)}else{g.applyInlineStyle("a",h)}}baidu.editor.commands.link={queryCommandState:function(){return this.highlight?-1:0},execCommand:function(g,j){var f=new baidu.editor.dom.Range(this.document),l=this.currentSelectedArr;if(l&&l.length){for(var h=0,k;k=l[h++];){if(a.isEmptyNode(k)){k.innerHTML=j.href}e(f.selectNodeContents(k),j)}f.selectNodeContents(l[0]).select()}else{e(f=this.selection.getRange(),j);f.collapse().select(b.gecko?true:false)}},queryCommandValue:function(){var o=new baidu.editor.dom.Range(this.document),m=this.currentSelectedArr,k,j;if(m&&m.length){for(var n=0,g;g=m[n++];){k=g.getElementsByTagName("a");if(k[0]){return k[0]}}}else{o=this.selection.getRange();if(o.collapsed){j=this.selection.getStart();if(j&&(j=a.findParentByTagName(j,"a",true))){return j}}else{o.shrinkBoundary();var h=o.startContainer.nodeType==3||!o.startContainer.childNodes[o.startOffset]?o.startContainer:o.startContainer.childNodes[o.startOffset],l=o.endContainer.nodeType==3||o.endOffset==0?o.endContainer:o.endContainer.childNodes[o.endOffset-1],q=o.getCommonAncestor();j=a.findParentByTagName(q,"a",true);if(!j&&q.nodeType==1){var k=q.getElementsByTagName("a"),f,r;for(var n=0,s;s=k[n++];){f=a.getPosition(s,h),r=a.getPosition(s,l);if((f&a.POSITION_FOLLOWING||f&a.POSITION_CONTAINS)&&(r&a.POSITION_PRECEDING||r&a.POSITION_CONTAINS)){j=s;break}}}return j}}}}})();(function(){var b=baidu.editor.dom.domUtils,e=baidu.editor.dom.dtd,f=b.isBlockElm,d={left:1,right:1,center:1,justify:1},c=baidu.editor.utils,a=function(j,g){var m=j.createBookmark(),q=function(s){return s.nodeType==1?s.tagName.toLowerCase()!="br"&&!b.isBookmarkNode(s):!b.isWhitespace(s)};j.enlarge(true);var r=j.createBookmark(),l=b.getNextDomNode(r.start,false,q),n=j.cloneRange(),i;while(l&&!(b.getPosition(l,r.end)&b.POSITION_FOLLOWING)){if(l.nodeType==3||!f(l)){n.setStartBefore(l);while(l&&l!==r.end&&!f(l)){i=l;l=b.getNextDomNode(l,false,null,function(s){return !f(s)})}n.setEndAfter(i);var k=n.getCommonAncestor();if(!b.isBody(k)&&f(k)){b.setStyles(k,c.isString(g)?{"text-align":g}:g);l=k}else{var h=j.document.createElement("p");b.setStyles(h,c.isString(g)?{"text-align":g}:g);var o=n.extractContents();h.appendChild(o);n.insertNode(h);l=h}l=b.getNextDomNode(l,false,q)}else{l=b.getNextDomNode(l,true,q)}}return j.moveToBookmark(r).moveToBookmark(m)};baidu.editor.commands.justify={execCommand:function(j,m){var h=this.selection.getRange(),g;if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(var k=0,l;l=this.currentSelectedArr[k++];){if(b.isEmptyNode(l)){g=this.document.createTextNode("p");h.setStart(l,0).collapse(true).insertNode(g).selectNode(g)}else{h.selectNodeContents(l)}a(h,m);g&&b.remove(g)}h.selectNode(this.currentSelectedArr[0]).select()}else{if(h.collapsed){g=this.document.createTextNode("p");h.insertNode(g)}a(h,m);if(g){h.setStartBefore(g).collapse(true);b.remove(g)}h.select()}return true},queryCommandValue:function(){var g=this.selection.getStart(),h=b.getComputedStyle(g,"text-align");return d[h]?h:"left"},queryCommandState:function(){if(this.highlight){return -1}return this.queryCommandState("highlightcode")==1?-1:0}}})();baidu.editor.commands.time={execCommand:function(){var b=new Date,c=b.getMinutes(),d=b.getSeconds(),a=[b.getHours(),c<10?"0"+c:c,d<10?"0"+d:d];this.execCommand("insertHtml",a.join(":"));return true},queryCommandState:function(){return this.highlight?-1:0}};baidu.editor.commands.date={execCommand:function(){var c=new Date,d=c.getMonth()+1,b=c.getDate(),a=[c.getFullYear(),d<10?"0"+d:d,b<10?"0"+b:b];this.execCommand("insertHtml",a.join("-"));return true},queryCommandState:function(){return this.highlight?-1:0}};(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.browser,c=baidu.editor.dom.dtd;baidu.editor.commands["delete"]={execCommand:function(){var j=this.selection.getRange(),g=0,m=0,l=this;if(l.currentSelectedArr&&l.currentSelectedArr.length>0){for(var h=0,o;o=l.currentSelectedArr[h++];){if(o.style.display!="none"){o.innerHTML=b.ie?a.fillChar:"<br/>"}}j.setStart(l.currentSelectedArr[0],0).setCursor();return}if(j.collapsed){return}j.txtToElmBoundary();while(!j.startOffset&&!a.isBody(j.startContainer)&&!c.$tableContent[j.startContainer.tagName]){g=1;j.setStartBefore(j.startContainer)}while(!a.isBody(j.endContainer)&&!c.$tableContent[j.endContainer.tagName]){var e,n=j.endContainer,k=j.endOffset;e=n.childNodes[k];if(!e||a.isBr(e)&&n.lastChild===e){j.setEndAfter(n);continue}break}if(g){var d=l.document.createElement("span");d.innerHTML="start";d.id="_baidu_cut_start";j.insertNode(d).setStartBefore(d)}if(m){var f=l.document.createElement("span");f.innerHTML="end";f.id="_baidu_cut_end";j.cloneRange().collapse(false).insertNode(f);j.setEndAfter(f)}j.deleteContents();if(a.isBody(j.startContainer)&&a.isEmptyBlock(l.body)){l.body.innerHTML="<p>"+(b.ie?"":"<br/>")+"</p>";j.setStart(l.body.firstChild,0).collapse(true)}else{if(!b.ie&&a.isEmptyBlock(j.startContainer)){j.startContainer.innerHTML="<br/>"}}j.select(true)},queryCommandState:function(){if(this.currentSelectedArr&&this.currentSelectedArr.length>0){return 0}return this.selection.getRange().collapsed?-1:0}}})();(function(){baidu.editor.commands.insertframe={execCommand:function(){},queryCommandState:function(){return this.highlight?-1:0}}})();baidu.editor.plugins.checkimage=function(){var b=[],a=this;a.commands.checkimage={execCommand:function(d,c){if(b.length){this[c]=b}},queryCommandState:function(e,d){b=[];var c=this.document.getElementsByTagName("img");for(var g=0,f;f=c[g++];){if(f.getAttribute(d)){b.push(f.getAttribute(d))}}return b.length?1:-1}}};(function(){var c=baidu.editor,a=c.dom.domUtils,b=["td"];baidu.editor.plugins.pagebreak=function(){var e=this;var d=e.hasContents;e.hasContents=function(f){for(var g=0,j,h=e.document.getElementsByTagName("div");j=h[g++];){if(a.hasClass(j,"pagebreak")){return true}}return d.call(e,f)};e.commands.pagebreak={execCommand:function(){var g=e.selection.getRange();var l=e.document.createElement("div");l.className="pagebreak";a.unselectable(l);var j=a.findParentByTagName(g.startContainer,b,true),h=[],f;if(j){switch(j.tagName){case"TD":f=j.parentNode;if(!f.previousSibling){var i=a.findParentByTagName(f,"table");i.parentNode.insertBefore(l,i);h=a.findParents(l,true)}else{f.parentNode.insertBefore(l,f);h=a.findParents(l)}f=h[1];if(l!==f){a.breakParent(l,f)}a.clearSelectedArr(e.currentSelectedArr)}}else{if(!g.collapsed){g.deleteContents();var k=g.startContainer;while(a.isBlockElm(k)&&a.isEmptyNode(k)){g.setStartBefore(k).collapse(true);a.remove(k);k=g.startContainer}}h=a.findParents(g.startContainer,true);f=h[1];g.insertNode(l);f&&a.breakParent(l,f);g.setEndAfter(l).setCursor(true,true)}},queryCommandState:function(){return this.highlight?-1:0}}}})();(function(){var c=baidu.editor,b=c.browser,a=c.dom.domUtils;baidu.editor.plugins.autolink=function(){var d=0;if(b.ie){return}var e=this;e.addListener("reset",function(){d=0});e.addListener("keydown",function(k,m){var q=m.keyCode||m.which;if(q==32||q==13){var h=e.selection.getNative(),j=h.getRangeAt(0).cloneRange(),i,o;var g=j.startContainer;while(g.nodeType==1&&j.startOffset>0){g=j.startContainer.childNodes[j.startOffset-1];if(!g){break}j.setStart(g,g.nodeType==1?g.childNodes.length:g.nodeValue.length);j.collapse(true);g=j.startContainer}do{if(j.startOffset==0){g=j.startContainer.previousSibling;while(g&&g.nodeType==1){g=g.lastChild}if(!g||a.isFillChar(g)){break}i=g.nodeValue.length}else{g=j.startContainer;i=j.startOffset}j.setStart(g,i-1);o=j.toString().charCodeAt(0)}while(o!=160&&o!=32);if(j.toString().replace(new RegExp(a.fillChar,"g"),"").match(/^(\s*)(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){var l=e.document.createElement("a"),n=e.document.createTextNode(" "),f;if(RegExp.$1.length){j.setStart(j.startContainer,j.startOffset+RegExp.$1.length)}l.appendChild(j.extractContents());l.href=l.innerHTML=l.innerHTML.replace(/<[^>]+>/g,"");f=l.getAttribute("href").replace(new RegExp(a.fillChar,"g"),"");l.href=/^(?:https?:\/\/)/ig.test(f)?f:"http://"+f;j.insertNode(l);l.parentNode.insertBefore(n,l.nextSibling);j.setStart(n,0);j.collapse(true);h.removeAllRanges();h.addRange(j)}}})}})();(function(){var a=baidu.editor.dom.domUtils,b=new RegExp(baidu.editor.dom.domUtils.fillChar+"|</hr>","gi"),c=baidu.editor.browser;baidu.editor.plugins.undo=function(){var i=this,k=i.options.maxUndoCount,h=i.options.maxInputCount,d=/\b(?:href|src|name)="[^"]*?"/gi;function f(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){var n=this.getScene(),m=this.list[this.index];if(m.content.replace(d,"")!=n.content.replace(d,"")){this.save()}if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var q=this.list[this.index];i.document.body.innerHTML=q.bookcontent.replace(b,"");var m=new baidu.editor.dom.Range(i.document);m.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:true});if(c.ie&&c.version==9&&m.collapsed&&a.isBlockElm(m.startContainer)&&a.isEmptyNode(m.startContainer)){a.fillNode(m.document,m.startContainer)}m.select(!c.gecko);setTimeout(function(){m.scrollToView(i.autoHeightEnabled,i.autoHeightEnabled?a.getXY(i.iframe).y:0)},200);this.update();if(i.currentSelectedArr){i.currentSelectedArr=[];var o=i.document.getElementsByTagName("td");for(var n=0,r;r=o[n++];){if(r.className==i.options.selectedTdClass){i.currentSelectedArr.push(r)}}}this.clearKey();i.fireEvent("reset",true)};this.getScene=function(){var n=i.selection.getRange(),m=i.body.innerHTML.replace(b,"");baidu.editor.browser.ie&&(m=m.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">"));var q=n.createBookmark(true,true),o=i.body.innerHTML.replace(b,"");n.moveToBookmark(q).select(true);return{bookcontent:o,content:m}};this.save=function(){var n=this.getScene(),m=this.list[this.index];if(m&&m.content==n.content&&m.bookcontent==n.bookcontent){return}this.list=this.list.slice(0,this.index+1);this.list.push(n);if(this.list.length>k){this.list.shift()}this.index=this.list.length-1;this.clearKey();this.update()};this.update=function(){this.hasRedo=this.list[this.index+1]?true:false;this.hasUndo=this.list[this.index-1]||this.list.length==1?true:false};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey()};this.clearKey=function(){g=0;e=null}}i.undoManger=new f();function j(){this.undoManger.save()}i.addListener("beforeexeccommand",j);i.addListener("afterexeccommand",j);i.addListener("reset",function(n,m){if(!m){i.undoManger.reset()}});i.commands.redo=i.commands.undo={execCommand:function(m){i.undoManger[m]()},queryCommandState:function(m){return i.undoManger["has"+(m.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var l={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},g=0,e;i.addListener("keydown",function(n,m){var o=m.keyCode||m.which;if(!l[o]&&!m.ctrlKey&&!m.metaKey&&!m.shiftKey&&!m.altKey){if(i.undoManger.list.length==0||((o==8||o==46)&&e!=o)){i.undoManger.save();e=o;return}if(i.undoManger.list.length==2&&i.undoManger.index==0&&g==0){i.undoManger.list.splice(1,1);i.undoManger.update()}e=o;g++;if(g>h){setTimeout(function(){i.undoManger.save()},0)}}})}})();(function(){var c=baidu.editor.browser,a=baidu.editor.dom.domUtils,b;baidu.editor.plugins.enterkey=function(){var e=this,d=e.options.enterTag;e.addListener("keyup",function(n,o){var q=o.keyCode||o.which;if(q==13){var m=e.selection.getRange(),j=m.startContainer,f;if(!c.ie){if(/h\d/i.test(b)){if(c.gecko){var l=a.findParentByTagName(j,["h1","h2","h3","h4","h5","h6","blockquote"],true);if(!l){e.document.execCommand("formatBlock",false,"<p>");f=1}}else{if(j.nodeType==1){var k=e.document.createTextNode(""),g;m.insertNode(k);g=a.findParentByTagName(k,"div",true);if(g){var i=e.document.createElement("p");while(g.firstChild){i.appendChild(g.firstChild)}g.parentNode.insertBefore(i,g);a.remove(g);m.setStartBefore(k).setCursor();f=1}a.remove(k)}}if(e.undoManger&&f){e.undoManger.save()}}}m=e.selection.getRange();setTimeout(function(){m.scrollToView(e.autoHeightEnabled,e.autoHeightEnabled?a.getXY(e.iframe).y:0)},50)}});e.addListener("keydown",function(k,m){var o=m.keyCode||m.which;if(o==13){if(e.undoManger){e.undoManger.save()}b="";var h=e.selection.getRange();if(!h.collapsed){var f=h.startContainer,g=h.endContainer,i=a.findParentByTagName(f,"td",true),j=a.findParentByTagName(g,"td",true);if(i&&j&&i!==j||!i&&j||i&&!j){m.preventDefault?m.preventDefault():(m.returnValue=false);return}}e.currentSelectedArr&&a.clearSelectedArr(e.currentSelectedArr);if(d=="p"){if(!c.ie){f=a.findParentByTagName(h.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote"],true);if(!f){e.document.execCommand("formatBlock",false,"<p>");if(c.gecko){h=e.selection.getRange();f=a.findParentByTagName(h.startContainer,"p",true);f&&a.removeDirtyAttr(f)}}else{b=f.tagName;f.tagName.toLowerCase()=="p"&&c.gecko&&a.removeDirtyAttr(f)}}}else{m.preventDefault?m.preventDefault():(m.returnValue=false);if(!h.collapsed){h.deleteContents();f=h.startContainer;if(f.nodeType==1&&(f=f.childNodes[h.startOffset])){while(f.nodeType==1){if(baidu.editor.dom.dtd.$empty[f.tagName]){h.setStartBefore(f).setCursor();if(e.undoManger){e.undoManger.save()}return false}if(!f.firstChild){var n=h.document.createElement("br");f.appendChild(n);h.setStart(f,0).setCursor();if(e.undoManger){e.undoManger.save()}return false}f=f.firstChild}if(f===h.startContainer.childNodes[h.startOffset]){n=h.document.createElement("br");h.insertNode(n).setCursor()}else{h.setStart(f,0).setCursor()}}else{n=h.document.createElement("br");h.insertNode(n).setStartAfter(n).setCursor()}}else{n=h.document.createElement("br");h.insertNode(n);var l=n.parentNode;if(l.lastChild===n){n.parentNode.insertBefore(n.cloneNode(true),n);h.setStartBefore(n)}else{h.setStartAfter(n)}h.setCursor()}}}})}})();(function(){baidu.editor.plugins.table=function(){var e=baidu.editor,t=e.browser,l=e.dom.domUtils,i=l.keys,s=l.clearSelectedArr;var b,j,h=l.isEmptyNode;function m(v){var w=v.parentNode.cells;for(var y=0,x;x=w[y];y++){if(x===v){return y}}}function q(v){return v.style.display=="none"}function n(v){var y=0;for(var w=0,x;x=v[w++];){if(!q(x)){y++}}return y}var u=this;u.currentSelectedArr=[];u.addListener("mousedown",o);u.addListener("keydown",function(w,v){var x=v.keyCode||v.which;if(!i[x]&&!v.ctrlKey&&!v.metaKey&&!v.shiftKey&&!v.altKey){s(u.currentSelectedArr)}});u.addListener("mouseup",function(){b=null;u.removeListener("mouseover",o);var y=u.currentSelectedArr[0];if(y){u.document.body.style.webkitUserSelect="";var w=new baidu.editor.dom.Range(u.document);if(h(y)){w.setStart(u.currentSelectedArr[0],0).setCursor()}else{w.selectNodeContents(u.currentSelectedArr[0]).select()}}else{var w=u.selection.getRange().shrinkBoundary();if(!w.collapsed){var x=l.findParentByTagName(w.startContainer,"td",true),v=l.findParentByTagName(w.endContainer,"td",true);if(x&&!v||!x&&v||x&&v&&x!==v){w.collapse(true).select(true)}}}});function r(){u.currentSelectedArr=[];b=null}u.commands.inserttable={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange();return l.findParentByTagName(v.startContainer,"table",true)||l.findParentByTagName(v.endContainer,"table",true)||u.currentSelectedArr.length>0?-1:0},execCommand:function(C,z){j=z;var y=[];y.push('cellpadding="'+(z.cellpadding||0)+'"');if(z.cellspacing>0){y.push('cellspacing="'+z.cellspacing+'" style="border-collapse:separate;"')}else{y.push('cellspacing="'+(z.cellspacing||0)+'"')}z.width?y.push('width="'+z.width+'"'):y.push('width="500"');y.push('borderColor="'+(z.bordercolor||"#000000")+'"');y.push('border="'+(z.border||1)+'"');var x,D=[],w=z.numRows;if(w){while(w--){var A=[];var v=z.numCols;while(v--){var B='style="';if(z.cellpadding){B+="padding:"+z.cellpadding+"px; "}if(z.border||z.bordercolor){B+="border:"+(z.border||1)+"px solid "+(z.bordercolor||"#000000")+";"}B+='" ';A[v]="<td "+B+' width="'+Math.floor((z.width||500)/z.numCols)+'" height="'+(this.options.tdHeight||20)+'">'+(t.ie?l.fillChar:"<br/>")+"</td>"}D.push("<tr "+(z.align?"style=text-align:"+z.align+"":"")+">"+A.join("")+"</tr>")}}x="<table "+y.join(" ")+(z.tablealign?"align='"+z.tablealign+"'":"")+(z.backgroundcolor?' bgcolor="'+z.backgroundcolor+'"':"")+">"+D.join("")+"</table>";x+=z.tablealign?"<p class='tableclear'></p>":"";this.execCommand("insertHtml",x);r()}};function a(w){var v=w.nextSibling,x;if(!(v&&v.nodeType==1&&l.hasClass(v,"tableclear"))){x=u.document.createElement("p");x.className="tableclear";l.insertAfter(w,x)}}u.commands.edittable={queryCommandState:function(){var v=this.selection.getRange();if(this.highlight||this.queryCommandState("highlightcode")){return -1}return l.findParentByTagName(v.startContainer,"table",true)||u.currentSelectedArr.length>0?0:-1},execCommand:function(F,D){var x=this.selection.getStart();var H=l.findParentByTagName(x,"table",true);if(H){var A=H.getAttribute("cellPadding");if(A!=D.cellpadding){H.setAttribute("cellPadding",D.cellpadding||0);var z=H.getElementsByTagName("td");for(var B=0,I;I=z[B++];){I.style.padding=(D.cellpadding||0)+"px"}}A=H.getAttribute("cellSpacing");if(A!=D.cellspacing){D.cellspacing==0?H.style.borderCollapse="collapse":H.style.borderCollapse="separate";H.setAttribute("cellSpacing",D.cellspacing||0)}else{D.cellspacing==0?H.style.borderCollapse="collapse":""}H.setAttribute("width",D.width||0);H.setAttribute("height",D.height||0);H.setAttribute("border",D.border||0);H.style.border=(D.border||0)+"px solid #ffffff";H.setAttribute("borderColor",D.bordercolor);H.style.borderColor=D.bordercolor;var C=H.getElementsByTagName("td");for(var E=0,w;w=C[E++];){w.style.border=(D.border||0)+"px solid #ffffff";w.style.borderColor=D.bordercolor}H.setAttribute("align",D.tablealign);H.setAttribute("bgColor",D.backgroundcolor);if(u.currentSelectedArr.length>0){for(var G=0,v;v=u.currentSelectedArr[G++];){l.setStyle(v,"text-align",D.align)}}else{var y=l.findParentByTagName(x,"td",true);if(y){l.setStyle(y,"text-align",D.align)}}if(D.tablealign){a(H)}}}};u.commands.deletetable={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange();return(l.findParentByTagName(v.startContainer,"table",true)&&l.findParentByTagName(v.endContainer,"table",true))||u.currentSelectedArr.length>0?0:-1},execCommand:function(){var w=this.selection.getRange(),x=l.findParentByTagName(u.currentSelectedArr.length>0?u.currentSelectedArr[0]:w.startContainer,"table",true);var y=x.ownerDocument.createElement("p"),v;y.innerHTML=t.ie?"&nbsp;":"<br/>";x.parentNode.insertBefore(y,x);v=l.getNextDomNode(x);if(v&&l.hasClass(v,"tableclear")){l.remove(v)}l.remove(x);w.setStart(y,0).setCursor();r()}};u.commands.addcaption={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange();return(l.findParentByTagName(v.startContainer,"table",true)&&l.findParentByTagName(v.endContainer,"table",true))||u.currentSelectedArr.length>0?0:-1},execCommand:function(w,x){var v=this.selection.getRange(),y=l.findParentByTagName(u.currentSelectedArr.length>0?u.currentSelectedArr[0]:v.startContainer,"table",true);if(x=="on"){var z=y.createCaption();z.innerHTML="请在此输入表格标题"}else{y.removeChild(y.caption)}}};u.commands.mergeright={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange(),A=v.startContainer,z=l.findParentByTagName(A,["td","th"],true);if(!z||this.currentSelectedArr.length>1){return -1}var y=z.parentNode;var w=m(z)+z.colSpan;if(w>=y.cells.length){return -1}var x=y.cells[w];if(q(x)){return -1}return z.rowSpan==x.rowSpan?0:-1},execCommand:function(){var B=this.selection.getRange(),v=B.startContainer,w=l.findParentByTagName(v,["td","th"],true)||u.currentSelectedArr[0],C=w.parentNode,F=C.parentNode.parentNode.rows;var y=C.rowIndex,E=m(w)+w.colSpan,A=F[y].cells[E];for(var z=y;z<y+A.rowSpan;z++){for(var x=E;x<E+A.colSpan;x++){var D=F[z].cells[x];D.setAttribute("rootRowIndex",C.rowIndex);D.setAttribute("rootCellIndex",m(w))}}w.colSpan+=A.colSpan||1;c(w,A);A.style.display="none";if(l.isEmptyBlock(w)){B.setStart(w,0).setCursor()}else{B.selectNodeContents(w).setCursor(true,true)}t.ie&&l.removeAttributes(w,["width","height"])}};u.commands.mergedown={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var w=this.selection.getRange(),C=w.startContainer,B=l.findParentByTagName(C,"td",true);if(!B||n(u.currentSelectedArr)>1){return -1}var A=B.parentNode,y=A.parentNode.parentNode,z=y.rows;var x=A.rowIndex+B.rowSpan;if(x>=z.length){return -1}var v=z[x].cells[m(B)];if(q(v)){return -1}return B.colSpan==v.colSpan?0:-1},execCommand:function(){var B=this.selection.getRange(),v=B.startContainer,x=l.findParentByTagName(v,["td","th"],true)||u.currentSelectedArr[0];var D=x.parentNode,F=D.parentNode.parentNode.rows;var w=D.rowIndex+x.rowSpan,C=m(x),z=F[w].cells[C];for(var A=w;A<w+z.rowSpan;A++){for(var y=C;y<C+z.colSpan;y++){var E=F[A].cells[y];E.setAttribute("rootRowIndex",D.rowIndex);E.setAttribute("rootCellIndex",m(x))}}x.rowSpan+=z.rowSpan||1;c(x,z);z.style.display="none";if(l.isEmptyBlock(x)){B.setStart(x,0).setCursor()}else{B.selectNodeContents(x).setCursor(true,true)}t.ie&&l.removeAttributes(x,["width","height"])}};u.commands.deleterow={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange(),x=v.startContainer,w=l.findParentByTagName(x,["td","th"],true);if(!w&&u.currentSelectedArr.length==0){return -1}},execCommand:function(){var G=this.selection.getRange(),z=G.startContainer,B=l.findParentByTagName(z,["td","th"],true),v,M,y,D,E,C;if(B&&u.currentSelectedArr.length==0){var A=(B.rowSpan||1)-1;u.currentSelectedArr.push(B);v=B.parentNode,M=v.parentNode.parentNode;D=M.rows,E=v.rowIndex+1,C=m(B);while(A){u.currentSelectedArr.push(D[E].cells[C]);A--;E++}}while(B=u.currentSelectedArr.pop()){if(!l.findParentByTagName(B,"table")){continue}v=B.parentNode,M=v.parentNode.parentNode;y=v.cells,D=M.rows,E=v.rowIndex,C=m(B);for(var F=0;F<y.length;){var x=y[F];if(q(x)){var w=D[x.getAttribute("rootRowIndex")].cells[x.getAttribute("rootCellIndex")];w.rowSpan--;F+=w.colSpan}else{if(x.rowSpan==1){F+=x.colSpan}else{var K=D[E+1].cells[F];K.style.display="";K.rowSpan=x.rowSpan-1;K.colSpan=x.colSpan;F+=x.colSpan}}}l.remove(v);var N,I,L;if(E==D.length){if(E==0){var H=M.ownerDocument.createElement("p");H.innerHTML=t.ie?"&nbsp;":"<br/>";M.parentNode.insertBefore(H,M);l.remove(M);G.setStart(H,0).setCursor();return}var J=E-1;N=D[J].cells[C];I=q(N)?D[N.getAttribute("rootRowIndex")].cells[N.getAttribute("rootCellIndex")]:N}else{L=D[E].cells[C];I=q(L)?D[L.getAttribute("rootRowIndex")].cells[L.getAttribute("rootCellIndex")]:L}}G.setStart(I,0).setCursor();f(M)}};u.commands.deletecol={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange(),x=v.startContainer,w=l.findParentByTagName(x,["td","th"],true);if(!w&&u.currentSelectedArr.length==0){return -1}},execCommand:function(){var H=this.selection.getRange(),z=H.startContainer,C=l.findParentByTagName(z,["td","th"],true);if(C&&u.currentSelectedArr.length==0){var B=(C.colSpan||1)-1;u.currentSelectedArr.push(C);while(B){do{C=C.nextSibling}while(C.nodeType==3);u.currentSelectedArr.push(C);B--}}while(C=u.currentSelectedArr.pop()){if(!l.findParentByTagName(C,"table")){continue}var v=C.parentNode,M=v.parentNode.parentNode,E=m(C),F=M.rows,x=v.cells,G=v.rowIndex;var y;for(var R=0;R<F.length;){var w=F[R].cells[E];if(q(w)){var N=F[w.getAttribute("rootRowIndex")].cells[w.getAttribute("rootCellIndex")];y=N.rowSpan;for(var L=0;L<N.rowSpan;L++){var P=F[R+L].cells[E];l.remove(P)}N.colSpan--;R+=y}else{if(w.colSpan==1){y=w.rowSpan;for(var L=R,K=R+w.rowSpan;L<K;L++){l.remove(F[L].cells[E])}R+=y}else{var A=F[R].cells[E+1];A.style.display="";A.rowSpan=w.rowSpan;A.colSpan=w.colSpan-1;R+=w.rowSpan;l.remove(w)}}}var Q,J,O;if(E==x.length){if(E==0){var I=M.ownerDocument.createElement("p");I.innerHTML=t.ie?"&nbsp;":"<br/>";M.parentNode.insertBefore(I,M);l.remove(M);H.setStart(I,0).setCursor();return}var D=E-1;Q=F[G].cells[D];J=q(Q)?F[Q.getAttribute("rootRowIndex")].cells[Q.getAttribute("rootCellIndex")]:Q}else{O=F[G].cells[E];J=q(O)?F[O.getAttribute("rootRowIndex")].cells[O.getAttribute("rootCellIndex")]:O}}H.setStart(J,0).setCursor();f(M)}};u.commands.splittocells={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange(),x=v.startContainer,w=l.findParentByTagName(x,["td","th"],true);return w&&(w.rowSpan>1||w.colSpan>1)&&(!u.currentSelectedArr.length||n(u.currentSelectedArr)==1)?0:-1},execCommand:function(){var z=this.selection.getRange(),v=z.startContainer,w=l.findParentByTagName(v,["td","th"],true),B=w.parentNode,G=B.parentNode.parentNode;var E=B.rowIndex,D=m(w),C=w.rowSpan,A=w.colSpan;for(var y=0;y<C;y++){for(var x=0;x<A;x++){var F=G.rows[E+y].cells[D+x];F.rowSpan=1;F.colSpan=1;if(q(F)){F.style.display="";F.innerHTML=t.ie?"":"<br/>"}}}}};u.commands.splittorows={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange(),x=v.startContainer,w=l.findParentByTagName(x,"td",true)||u.currentSelectedArr[0];return w&&(w.rowSpan>1)&&(!u.currentSelectedArr.length||n(u.currentSelectedArr)==1)?0:-1},execCommand:function(){var z=this.selection.getRange(),v=z.startContainer,w=l.findParentByTagName(v,"td",true)||u.currentSelectedArr[0],B=w.parentNode,H=B.parentNode.parentNode.rows;var E=B.rowIndex,D=m(w),C=w.rowSpan,A=w.colSpan;for(var y=0;y<C;y++){var G=H[E+y],F=G.cells[D];F.rowSpan=1;F.colSpan=A;if(q(F)){F.style.display="";F.innerHTML=t.ie?"":"<br/>"}for(var x=D+1;x<D+A;x++){F=G.cells[x];F.setAttribute("rootRowIndex",E+y)}}s(u.currentSelectedArr);this.selection.getRange().setStart(w,0).setCursor()}};u.commands.insertparagraphbeforetable={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange(),x=v.startContainer,w=l.findParentByTagName(x,"td",true)||u.currentSelectedArr[0];return w&&l.findParentByTagName(w,"table")?0:-1},execCommand:function(){var v=this.selection.getRange(),x=v.startContainer,w=l.findParentByTagName(x,"table",true);x=u.document.createElement(u.options.enterTag);w.parentNode.insertBefore(x,w);s(u.currentSelectedArr);if(x.tagName=="P"){x.innerHTML=t.ie?"":"<br/>";v.setStart(x,0)}else{v.setStartBefore(x)}v.setCursor()}};u.commands.splittocols={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange(),x=v.startContainer,w=l.findParentByTagName(x,["td","th"],true)||u.currentSelectedArr[0];return w&&(w.colSpan>1)&&(!u.currentSelectedArr.length||n(u.currentSelectedArr)==1)?0:-1},execCommand:function(){var z=this.selection.getRange(),v=z.startContainer,w=l.findParentByTagName(v,["td","th"],true)||u.currentSelectedArr[0],B=w.parentNode,H=B.parentNode.parentNode.rows;var E=B.rowIndex,D=m(w),C=w.rowSpan,A=w.colSpan;for(var y=0;y<A;y++){var G=H[E].cells[D+y];G.rowSpan=C;G.colSpan=1;if(q(G)){G.style.display="";G.innerHTML=t.ie?"":"<br/>"}for(var x=E+1;x<E+C;x++){var F=H[x].cells[D+y];F.setAttribute("rootCellIndex",D+y)}}s(u.currentSelectedArr);this.selection.getRange().setStart(w,0).setCursor()}};u.commands.insertrow={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange();return l.findParentByTagName(v.startContainer,"table",true)||l.findParentByTagName(v.endContainer,"table",true)||u.currentSelectedArr.length!=0?0:-1},execCommand:function(){var A=this.selection.getRange(),v=A.startContainer,C=l.findParentByTagName(v,"tr",true)||u.currentSelectedArr[0].parentNode,F=C.parentNode.parentNode,I=F.rows;var D=C.rowIndex,G=I[D].cells;var H=F.insertRow(D);var y;for(var B=0;B<G.length;){var E=G[B];if(q(E)){var z=I[E.getAttribute("rootRowIndex")].cells[E.getAttribute("rootCellIndex")];z.rowSpan++;for(var x=0;x<z.colSpan;x++){y=E.cloneNode(false);y.rowSpan=y.colSpan=1;y.innerHTML=t.ie?"":"<br/>";y.className="";if(H.children[B+x]){H.insertBefore(y,H.children[B+x])}else{H.appendChild(y)}y.style.display="none"}B+=z.colSpan}else{for(var w=0;w<E.colSpan;w++){y=E.cloneNode(false);y.rowSpan=y.colSpan=1;y.innerHTML=t.ie?"":"<br/>";y.className="";if(H.children[B+w]){H.insertBefore(y,H.children[B+w])}else{H.appendChild(y)}}B+=E.colSpan}}f(F);A.setStart(H.cells[0],0).setCursor();s(u.currentSelectedArr)}};u.commands.insertcol={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var v=this.selection.getRange();return l.findParentByTagName(v.startContainer,"table",true)||l.findParentByTagName(v.endContainer,"table",true)||u.currentSelectedArr.length!=0?0:-1},execCommand:function(){var A=this.selection.getRange(),v=A.startContainer,w=l.findParentByTagName(v,["td","th"],true)||u.currentSelectedArr[0],G=l.findParentByTagName(w,"table"),H=G.rows;var C=m(w),z;for(var E=0;E<H.length;){var F=H[E].cells[C],B;if(q(F)){var D=H[F.getAttribute("rootRowIndex")].cells[F.getAttribute("rootCellIndex")];D.colSpan++;for(var y=0;y<D.rowSpan;y++){z=w.cloneNode(false);z.rowSpan=z.colSpan=1;z.innerHTML=t.ie?"":"<br/>";z.className="";B=H[E+y];if(B.children[C]){B.insertBefore(z,B.children[C])}else{B.appendChild(z)}z.style.display="none"}E+=D.rowSpan}else{for(var x=0;x<F.rowSpan;x++){z=w.cloneNode(false);z.rowSpan=z.colSpan=1;z.innerHTML=t.ie?"":"<br/>";z.className="";B=H[E+x];if(B.children[C]){B.insertBefore(z,B.children[C])}else{B.appendChild(z)}z.innerHTML=t.ie?"":"<br/>"}E+=F.rowSpan}}f(G);A.setStart(H[0].cells[C],0).setCursor();s(u.currentSelectedArr)}};u.commands.mergecells={queryCommandState:function(){if(this.highlight||this.queryCommandState("highlightcode")){return -1}var x=0;for(var v=0,w;w=this.currentSelectedArr[v++];){if(!q(w)){x++}}return x>1?0:-1},execCommand:function(){var w=u.currentSelectedArr[0],z=u.currentSelectedArr[u.currentSelectedArr.length-1],G=l.findParentByTagName(w,"table"),I=G.rows,v={beginRowIndex:w.parentNode.rowIndex,beginCellIndex:m(w),endRowIndex:z.parentNode.rowIndex,endCellIndex:m(z)},F=v.beginRowIndex,y=v.beginCellIndex,x=v.endRowIndex-v.beginRowIndex+1,E=v.endCellIndex-v.beginCellIndex+1,C=I[F].cells[y];for(var B=0,D;(D=I[F+B++])&&B<=x;){for(var A=0,H;(H=D.cells[y+A++])&&A<=E;){if(B==1&&A==1){H.style.display="";H.rowSpan=x;H.colSpan=E}else{H.style.display="none";H.rowSpan=1;H.colSpan=1;H.setAttribute("rootRowIndex",F);H.setAttribute("rootCellIndex",y);c(C,H)}}}this.selection.getRange().setStart(C,0).setCursor();t.ie&&l.removeAttributes(C,["width","height"]);s(u.currentSelectedArr)}};function c(w,v){if(h(v)){return}if(h(w)){w.innerHTML=v.innerHTML;return}var x=w.lastChild;if(x.nodeType!=1||x.tagName!="BR"){w.appendChild(w.ownerDocument.createElement("br"))}while(x=v.firstChild){w.appendChild(x)}}function g(z,y){var I=z.parentNode,H=y.parentNode,J=I.rowIndex,x=H.rowIndex,F=I.parentNode.parentNode.rows,S=F.length,w=F[0].cells.length,M=m(z),T=m(y);if(z==y){return{beginRowIndex:J,beginCellIndex:M,endRowIndex:J+z.rowSpan-1,endCellIndex:T+z.colSpan-1}}var O=Math.min(J,x),G=Math.min(M,T),v=Math.max(J+z.rowSpan-1,x+y.rowSpan-1),N=Math.max(M+z.colSpan-1,T+y.colSpan-1);while(1){var L=O,Q=G,R=v,C=N;if(O>0){for(D=G;D<=N;){var A=F[O].cells[D];if(q(A)){O=A.getAttribute("rootRowIndex");A=F[A.getAttribute("rootRowIndex")].cells[A.getAttribute("rootCellIndex")]}D=m(A)+(A.colSpan||1)}}if(G>0){for(var E=O;E<=v;){var P=F[E].cells[G];if(q(P)){G=P.getAttribute("rootCellIndex");P=F[P.getAttribute("rootRowIndex")].cells[P.getAttribute("rootCellIndex")]}E=P.parentNode.rowIndex+(P.rowSpan||1)}}if(v<S){for(var D=G;D<=N;){var B=F[v].cells[D];if(q(B)){B=F[B.getAttribute("rootRowIndex")].cells[B.getAttribute("rootCellIndex")]}v=B.parentNode.rowIndex+B.rowSpan-1;D=m(B)+(B.colSpan||1)}}if(N<w){for(E=O;E<=v;){var K=F[E].cells[N];if(q(K)){K=F[K.getAttribute("rootRowIndex")].cells[K.getAttribute("rootCellIndex")]}N=m(K)+K.colSpan-1;E=K.parentNode.rowIndex+(K.rowSpan||1)}}if(Q==G&&C==N&&R==v&&L==O){break}}return{beginRowIndex:O,beginCellIndex:G,endRowIndex:v,endCellIndex:N}}function o(w,v){b=v.target||v.srcElement;if(u.queryCommandState("highlightcode")||l.findParent(b,function(x){return x.tagName=="DIV"&&/highlighter/.test(x.id)})){return}if(v.button==2){return}u.document.body.style.webkitUserSelect="";s(u.currentSelectedArr);l.clearSelectedArr(u.currentSelectedArr);if(b.tagName!=="TD"){b=l.findParentByTagName(b,"td")||b}if(b.tagName=="TD"){u.addListener("mouseover",function(y,x){var z=x.target||x.srcElement;k.call(u,z);x.preventDefault?x.preventDefault():(x.returnValue=false)})}else{r()}}function k(x){if(b&&x.tagName=="TD"){u.document.body.style.webkitUserSelect="none";var w=x.parentNode.parentNode.parentNode;u.selection.getNative()[t.ie?"empty":"removeAllRanges"]();var v=g(b,x);d(w,v)}}function d(y,x){var z=y.rows;s(u.currentSelectedArr);for(var w=x.beginRowIndex;w<=x.endRowIndex;w++){for(var v=x.beginCellIndex;v<=x.endCellIndex;v++){var A=z[w].cells[v];A.className=u.options.selectedTdClass;u.currentSelectedArr.push(A)}}}function f(D){var z=D.getElementsByTagName("td"),C,B,E=D.rows;for(var x=0,w;w=z[x++];){if(!q(w)){C=w.parentNode.rowIndex;B=m(w);for(var v=0;v<w.rowSpan;v++){var A=v==0?1:0;for(;A<w.colSpan;A++){var y=E[C+v].children[B+A];y.setAttribute("rootRowIndex",C);y.setAttribute("rootCellIndex",B)}}}}}u.adjustTable=function(I){var G=I.getElementsByTagName("table");for(var C=0,x;x=G[C++];){if(x.getAttribute("align")){a(x)}if(!x.getAttribute("border")){x.setAttribute("border",1)}if(l.getComputedStyle(x,"border-color")=="#ffffff"){x.setAttribute("borderColor","#000000")}var B=l.getElementsByTagName(x,"td"),z,y;for(var A=0,w;w=B[A++];){if(l.isEmptyNode(w)){w.innerHTML=t.ie?l.fillChar:"<br/>"}var D=m(w),F=w.parentNode.rowIndex,H=l.findParentByTagName(w,"table").rows;for(var v=0;v<w.rowSpan;v++){var E=v==0?1:0;for(;E<w.colSpan;E++){if(!z){z=w.cloneNode(false);z.rowSpan=z.colSpan=1;z.style.display="none";z.innerHTML=t.ie?"":"<br/>"}else{z=z.cloneNode(true)}z.setAttribute("rootRowIndex",w.parentNode.rowIndex);z.setAttribute("rootCellIndex",D);if(v==0){if(w.nextSibling){w.parentNode.insertBefore(z,w.nextSibling)}else{w.parentNode.appendChild(z)}}else{y=H[F+v].children[D];if(y){y.parentNode.insertBefore(z,y)}else{H[F+v].appendChild(z)}}}}}}}}})();baidu.editor.plugins.serialize=function(){var r=baidu.editor.dom.dtd,x=baidu.editor.utils,v=baidu.editor.dom.domUtils,y=baidu.editor.browser,o=y.ie,e=y.version;var z=this,h=baidu.editor.dom.dtd.$empty,q=function(){var C=/<(?:(?:\/([^>]+)>[ \t\r\n]*)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>[ \t\r\n]*))/g,A=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,D={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},G={script:1,style:1},B={li:{"$":"ul",ul:1,ol:1},dd:{"$":"dl",dl:1},dt:{"$":"dl",dl:1},option:{"$":"select",select:1},td:{"$":"tr",tr:1},th:{"$":"tr",tr:1},tr:{"$":"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{"$":"table",table:1,colgroup:1},thead:{"$":"table",table:1},tfoot:{"$":"table",table:1},col:{"$":"colgroup",colgroup:1}};var E={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};function F(K,O){var L,M=0,I,T;C.exec("");while((L=C.exec(K))){var R=L.index;if(R>M){var U=K.slice(M,R);if(T){T.push(U)}else{O.onText(U)}}M=C.lastIndex;if((I=L[1])){I=I.toLowerCase();if(T&&I==T._tag_name){O.onCDATA(T.join(""));T=null}if(!T){O.onTagClose(I);continue}}if(T){T.push(L[0]);continue}if((I=L[3])){if(/="/.test(I)){continue}I=I.toLowerCase();var S=L[4],H,J={},Q=S&&S.slice(-1)=="/";if(S){A.exec("");while((H=A.exec(S))){var P=H[1].toLowerCase(),N=H[2]||H[3]||H[4]||"";if(!N&&D[P]){N=P}if(P=="style"){if(o&&e<=6){N=N.replace(/(?!;)\s*([\w-]+):/g,function(V,W){return W.toLowerCase()+":"})}}if(N){J[P]=N.replace(/:\s*/g,":")}}}O.onTagOpen(I,J,Q);if(!T&&G[I]){T=[];T._tag_name=I}continue}if((I=L[2])){O.onComment(I)}}if(K.length>M){O.onText(K.slice(M,K.length))}}return function(K,L){var I={type:"fragment",parent:null,children:[]};var J=I;function N(O){O.parent=J;J.children.push(O)}function M(P,O){var Q=P;if(B[Q.tag]){while(B[J.tag]&&B[J.tag][Q.tag]){J=J.parent}if(J.tag==Q.tag){J=J.parent}while(B[Q.tag]){if(B[Q.tag][J.tag]){break}Q=Q.parent={type:"element",tag:B[Q.tag]["$"],attributes:{},children:[Q]}}}if(L){while(r[Q.tag]&&!(J.tag=="span"?x.extend(r.strong,{a:1,A:1}):(r[J.tag]||r.div))[Q.tag]){if(H(J)){continue}if(!J.parent){break}J=J.parent}}Q.parent=J;J.children.push(Q);if(O){J=P}if(P.attributes.style){P.attributes.style=P.attributes.style.toLowerCase()}return P}function H(O){var P;if(!O.children.length&&(P=E[O.tag])){M({type:"element",tag:P,attributes:{},children:[]},true);return true}return false}F(K,{onText:function(O){while(!(r[J.tag]||r.div)["#"]){if(H(J)){continue}J=J.parent}if(/[^ \t\r\n]/.test(O)){N({type:"text",data:O})}},onComment:function(O){N({type:"comment",data:O})},onCDATA:function(O){while(!(r[J.tag]||r.div)["#"]){if(H(J)){continue}J=J.parent}N({type:"cdata",data:O})},onTagOpen:function(O,Q,P){P=P||h[O];M({type:"element",tag:O,attributes:Q,closed:P,children:[]},!P)},onTagClose:function(O){var P=J;while(P&&O!=P.tag){P=P.parent}if(P){for(var Q=J;Q!==P.parent;Q=Q.parent){H(Q)}if(!P.children.length&&r.$removeEmpty[P.tag]&&!P.attributes.anchorname&&P.attributes["class"]!="pagebreak"){P.parent.children.pop()}J=P.parent}else{if(!(r.$removeEmpty[O]||r.$removeEmptyBlock[O])){P={type:"element",tag:O,attributes:{},children:[]};M(P,true);H(P);J=P.parent}}}});while(J!==I){H(J);J=J.parent}return I}}();var l=function(){var B={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function A(C){return B[C]}return function(C){C=C+"";return C?C.replace(/[<>"']/g,A):""}}();var n=function(){function B(J,I){var H=J.children;var K=[];for(var G=0,F;F=H[G];G++){K.push(n(F,I))}return K.join("")}function C(G){var I=[];for(var F in G){var H=G[F];if(F=="style"){if(/pt/.test(H)){H=H.replace(/([\d.]+)pt/g,function(J){return Math.round(parseInt(J,10)*96/72)+"px"})}if(/rgba?\s*\([^)]*\)/.test(H)){H=H.replace(/rgba?\s*\(([^)]*)\)/g,function(J){return x.fixColor("color",J)})}G[F]=H.replace(/windowtext/g,"#000")}I.push(F+'="'+l(G[F])+'"')}return I.join(" ").replace(/\;+/g,";")}function A(G,F){return F?G.data.replace(/&nbsp;/g," "):l(G.data).replace(/ /g,"&nbsp;")}var E={div:"p",li:"p",tr:"p",br:"br",p:"p"};function D(J,I){var F=J.tag;if(I&&F=="td"){if(!H){H=""}H+=B(J,I)+"&nbsp;&nbsp;&nbsp;"}else{var G=C(J.attributes);var H="<"+(I&&E[F]?E[F]:F)+(G?" "+G:"")+(h[F]?" />":">");if(!h[F]){if(y.ie&&F=="p"&&!J.children.length){H+="&nbsp;"}H+=B(J,I);H+="</"+(I&&E[F]?E[F]:F)+">"}}return H}return function(G,F){if(G.type=="fragment"){return B(G,F)}else{if(G.type=="element"){return D(G,F)}else{if(G.type=="text"||G.type=="cdata"){return A(G,r.$notTransContent[G.parent.tag])}else{if(G.type=="comment"){return"<!--"+G.data+"-->"}}}}return""}}();var j=function(){function B(E){var D=new RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig);return D.test(E)}function C(D){D=D.replace(/([\d.]+)([\w]+)?/g,function(E,G,F){return(Math.round(parseFloat(G))||1)+(F||"px")});return D}function A(D){D=D.replace(/<!--\s*EndFragment\s*-->[\s\S]*$/,"");D=D.replace(/^(\r\n|\n|\r)|(\r\n|\n|\r)$/ig,"");D=D.replace(/^\s*(&nbsp;)+/ig,"");D=D.replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"");D=D.replace(/<!--[\s\S]*?-->/ig,"");D=D.replace(/v:imagedata/g,"img").replace(/<\/img>/g,"");D=D.replace(/v:\w+=["']?[^'"]+["']?/g,"");D=D.replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"");D=D.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>");D=D.replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"");D=D.replace(/<font[^>]*>\s*<\/font>/gi,"");D=D.replace(/class\s*=\s*["']?(?:(?:MsoTableGrid)|(?:MsoNormal(Table)?))\s*["']?/gi,"");D=D.replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(K,O,I,F){var G=[],J=0,N=F.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g);for(var J=0;J<N.length;J++){var M=N[J];var E,L,H=M.split(":");if(H.length==2){E=H[0].toLowerCase();L=H[1].toLowerCase();switch(E){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":G[J++]=E.replace(/^mso-|-alt$/g,"")+":"+C(L);continue;case"horiz-align":G[J++]="text-align:"+L;continue;case"vert-align":G[J++]="vertical-align:"+L;continue;case"font-color":case"mso-foreground":G[J++]="color:"+L;continue;case"mso-background":case"mso-highlight":G[J++]="background:"+L;continue;case"mso-default-height":G[J++]="min-height:"+C(L);continue;case"mso-default-width":G[J++]="min-width:"+C(L);continue;case"mso-padding-between-alt":G[J++]="border-collapse:separate;border-spacing:"+C(L);continue;case"text-line-through":if((L=="single")||(L=="double")){G[J++]="text-decoration:line-through"}continue;case"font-family":case"border-width":case"border-style":continue;case"mso-zero-height":if(L=="yes"){G[J++]="display:none"}continue;case"margin":if(!/[1-9]/.test(H[1])){continue}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(E)){if(!/mso\-list/.test(E)){continue}}G[J]=E+":"+H[1]}}if(J>0){return O+' style="'+G.join(";")+'"'}else{return O}});D=D.replace(/([ ]+)<\/span>/ig,function(E,F){return new Array(F.length+1).join("&nbsp;")+"</span>"});return D}return function(D){g=null;u="",k="",s="";if(B(D)){D=A(D)}return D.replace(/>[ \t\r\n]*</g,"><")}}();var c={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"};function w(B){var A;if(B&&B.tag=="p"){if(B.attributes["class"]=="MsoListParagraph"||/mso-list/.test(B.attributes.style)){A=1}else{var C=B.children[0];if(C&&C.tag=="span"&&/Wingdings/i.test(C.attributes.style)){A=1}}}return A}var g,d={decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^\(?[a-z]+\)?$/,"upper-alpha":/^\(?[A-Z]+\)?$/},i={disc:/^[l\u00B7\u2002]/,circle:/^[\u006F\u00D8]/,square:/^[\u006E\u25C6]/},u="",k="",s;function f(F,G){if(F.type=="element"&&!F.children.length&&(r.$removeEmpty[F.tag])&&F.tag!="a"){return{type:"fragment",children:[]}}var J=[0,10,12,16,18,24,32,48],I,K=x.indexOf;switch(F.tag){case"img":if(F.attributes.src&&/^data:/.test(F.attributes.src)){return{type:"fragment",children:[]}}if(F.attributes.src&&/^(?:file)/.test(F.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(F.attributes.src)){return{type:"fragment",children:[]}}F.attributes.word_img=F.attributes.src;F.attributes.src=z.options.UEDITOR_HOME_URL+"themes/default/images/localimage.jpg";F.attributes.style="width:395px;height:173px;";G&&(G.flag=1)}if(y.ie&&y.version<7&&z.options.relativePath){F.attributes.orgSrc=F.attributes.src}F.attributes.data_ue_src=F.attributes.data_ue_src||F.attributes.src;break;case"li":var D=F.children[0];if(!D||D.type!="element"||D.tag!="p"&&r.p[D.tag]){F.children=[{type:"element",tag:"p",attributes:{},children:D?F.children:[{type:"element",tag:"br",attributes:{},closed:true,children:[]}],parent:F}]}break;case"table":case"td":a(F);break;case"a":if(F.attributes.anchorname){F.tag="img";F.attributes={"class":"anchorclass",anchorname:F.attributes.name};F.closed=1}F.attributes.href&&(F.attributes.data_ue_src=F.attributes.href);break;case"b":F.tag=F.name="strong";break;case"i":F.tag=F.name="em";break;case"u":F.tag=F.name="span";F.attributes.style=(F.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":F.tag=F.name="span";F.attributes.style=(F.attributes.style||"")+";text-decoration:line-through;";if(F.children.length==1){D=F.children[0];if(D.tag==F.tag){F.attributes.style+=";"+D.attributes.style;F.children=D.children}}break;case"span":if(/mso-list/.test(F.attributes.style)){if(s!="end"){var N=F.children[0],C;while(N.type=="element"){N=N.children[0]}for(C in i){if(i[C].test(N.data)){u="ul";k=C;break}}if(!u){for(C in d){if(d[C].test(N.data.replace(/\.$/,""))){u="ol";k=C;break}}}if(s){if(N.data==s){if(u!="ul"){k=""}u="ul"}else{if(u!="ol"){k=""}u="ol"}s="end"}else{s=N.data}if(u){var E=F;while(E&&E.tag!="ul"&&E.tag!="ol"){E=E.parent}if(E){E.tag=u;E.attributes.style="list-style-type:"+k}}}F={type:"fragment",children:[]};break}var B=F.attributes.style;if(B){B=B.match(/(?:\b(?:color|font-size|background(-color)?|font-family|text-decoration)\b\s*:\s*(&[^;]+;|[^;])+(?=;)?)/gi);if(B){F.attributes.style=B.join(";");if(!F.attributes.style){delete F.attributes.style}}}if(y.gecko&&y.version<=10902&&F.parent){var M=F.parent;if(M.tag=="span"&&M.attributes&&M.attributes.style){F.attributes.style=M.attributes.style+";"+F.attributes.style}}if(x.isEmptyObject(F.attributes)){F.type="fragment"}break;case"font":F.tag=F.name="span";I=F.attributes;F.attributes={style:(I.size?"font-size:"+(J[I.size]||12)+"px":"")+";"+(I.color?"color:"+I.color:"")+";"+(I.face?"font-family:"+I.face:"")+";"+(I.style||"")};while(F.parent.tag==F.tag&&F.parent.children.length==1){F.attributes.style&&(F.parent.attributes.style?(F.parent.attributes.style+=";"+F.attributes.style):(F.parent.attributes.style=F.attributes.style));F.parent.children=F.children;F=F.parent}break;case"p":if(F.attributes.align){F.attributes.style=(F.attributes.style||"")+";text-align:"+F.attributes.align+";";delete F.attributes.align}if(w(F)){if(!g){var A={type:"element",tag:"ul",attributes:{},children:[]},H=K(F.parent.children,F);F.parent.children[H]=A;A.parent=F.parent;A.children[0]=F;F.parent=A;while(1){F=A.parent.children[H+1];if(w(F)){A.children[A.children.length]=F;F.parent=A;A.parent.children.splice(H+1,1)}else{break}}return A}F.tag=F.name="li";if(y.webkit){var L=F.children[0];while(L&&L.type=="element"){L=L.children[0]}L&&(L.parent.attributes.style=(L.parent.attributes.style||"")+";mso-list:10")}delete F.attributes["class"];delete F.attributes.style}}return F}function a(B){if(o&&B.attributes.style){var A=B.attributes.style;B.attributes.style=A.replace(/;\s*/g,";");B.attributes.style=B.attributes.style.replace(/^\s*|\s*$/,"")}}function m(A){if(A.type=="text"){}switch(A.tag){case"table":!A.attributes.style&&delete A.attributes.style;if(o&&A.attributes.style){a(A)}break;case"td":case"th":if(/display\s*:\s*none/i.test(A.attributes.style)){return{type:"fragment",children:[]}}if(o&&!A.children.length){var B={type:"text",data:v.fillChar,parent:A};A.children[0]=B}if(o&&A.attributes.style){a(A)}break;case"img":if(A.attributes.anchorname){A.tag="a";A.attributes={name:A.attributes.anchorname,anchorname:1};A.closed=null}else{if(A.attributes.data_ue_src){A.attributes.src=A.attributes.data_ue_src;delete A.attributes.data_ue_src}}break;case"a":if(A.attributes.data_ue_src){A.attributes.href=A.attributes.data_ue_src;delete A.attributes.data_ue_src}}return A}function b(G,F,A){if(!G.children||!G.children.length){return G}var E=G.children;for(var D=0;D<E.length;D++){var C=F(E[D],A);if(C.type=="fragment"){var B=[D,1];B.push.apply(B,C.children);E.splice.apply(E,B);if(!E.length){G={type:"fragment",children:[]}}D--}else{E[D]=C}}return G}function t(A){this.rules=A}t.prototype={rules:null,filter:function(C,F,E){F=F||this.rules;var B=F&&F.whiteList;var A=F&&F.blackList;function D(K,J){K.name=K.type=="element"?K.tag:c[K.type];if(J==null){return b(K,D,K)}if(A&&A[K.name]){E&&(E.flag=1);return{type:"fragment",children:[]}}if(B){if(K.type=="element"){if(J.type=="fragment"?B[K.name]:B[K.name]&&B[J.name][K.name]){var I;if((I=B[K.name].$)){var L=K.attributes;var H={};for(var G in I){if(L[G]){H[G]=L[G]}}K.attributes=H}}else{E&&(E.flag=1);K.type="fragment";K.name=J.name}}else{}}if(A||B){b(K,D,K)}return K}return D(C,null)},transformInput:function(B,A){function C(D){D=f(D,A);if(D.tag=="ol"||D.tag=="ul"){g=1}D=b(D,C,D);if(D.tag=="ol"||D.tag=="ul"){g=0;u="",k="",s=""}if(D.type=="text"&&D.data.replace(/\s/g,"")==z.options.pageBreakTag){D.type="element";D.name=D.tag="div";delete D.data;D.attributes={"class":"pagebreak",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"};D.children=[]}if(D.type=="text"&&!r.$notTransContent[D.parent.tag]){D.data=D.data.replace(/[\r\t\n]*/g,"").replace(/[ ]*$/g,"")}return D}return C(B)},transformOutput:function(A){function B(C){if(C.tag=="div"&&C.attributes["class"]=="pagebreak"){delete C.tag;C.type="text";C.data=z.options.pageBreakTag;delete C.children}C=m(C);if(C.tag=="ol"||C.tag=="ul"){g=1}C=b(C,B,C);if(C.tag=="ol"||C.tag=="ul"){g=0}return C}return B(A)},toHTML:n,parseHTML:q,word:j};z.serialize=new t(z.options.serialize);baidu.editor.serialize=new t({})};baidu.editor.plugins.basestyle=function(){var f={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},a=baidu.editor.dom.domUtils,e=function(h,g){var i=h.selection.getStart();return a.findParentByTagName(i,g,true)},b=0,d=this;for(var c in f){(function(h,g){d.commands[h]={execCommand:function(k){var j=new baidu.editor.dom.Range(this.document),r="",o=this;if(!b){this.addListener("beforegetcontent",function(){a.clearReduent(o.document,["strong","u","em","sup","sub","strike"])});b=1}if(o.currentSelectedArr&&o.currentSelectedArr.length>0){for(var m=0,l;l=o.currentSelectedArr[m++];){if(l.style.display!="none"){j.selectNodeContents(l).select();!r&&(r=e(this,g));if(k=="superscript"||k=="subscript"){if(!r||r.tagName.toLowerCase()!=k){j.removeInlineStyle(["sub","sup"])}}r?j.removeInlineStyle(g):j.applyInlineStyle(g[0])}}j.selectNodeContents(o.currentSelectedArr[0]).select()}else{j=o.selection.getRange();r=e(this,g);if(j.collapsed){if(r){var q=o.document.createTextNode("");j.insertNode(q).removeInlineStyle(g);j.setStartBefore(q);a.remove(q)}else{var n=j.document.createElement(g[0]);if(k=="superscript"||k=="subscript"){q=o.document.createTextNode("");j.insertNode(q).removeInlineStyle(["sub","sup"]).setStartBefore(q).collapse(true)}j.insertNode(n).setStart(n,0)}j.collapse(true)}else{if(k=="superscript"||k=="subscript"){if(!r||r.tagName.toLowerCase()!=k){j.removeInlineStyle(["sub","sup"])}}r?j.removeInlineStyle(g):j.applyInlineStyle(g[0])}j.select()}return true},queryCommandState:function(){if(this.highlight){return -1}return e(this,g)?1:0}}})(c,f[c])}};(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.dom.dtd;baidu.editor.plugins.customstyle=function(){var c=this;c.commands.customstyle={execCommand:function(u,n){var s=this,h=n.tag,j=a.findParent(s.selection.getStart(),function(i){return i.getAttribute("label")==n.label},true),o,k,l={};for(var f in n){l[f]=n[f]}delete l.tag;if(j&&j.getAttribute("label")==n.label){o=this.selection.getRange();k=o.createBookmark();if(o.collapsed){a.remove(j,true)}else{var q=a.getCommonAncestor(k.start,k.end),e=a.getElementsByTagName(q,h);for(var m=0,g;g=e[m++];){if(g.getAttribute("label")==n.label){var d=a.getPosition(g,k.start),r=a.getPosition(g,k.end);if((d&a.POSITION_FOLLOWING||d&a.POSITION_CONTAINS)&&(r&a.POSITION_PRECEDING||r&a.POSITION_CONTAINS)){if(b.$block[h]){var v=s.document.createElement("p");a.moveChild(g,v);g.parentNode.insertBefore(v,g)}}a.remove(g,true)}}j=a.findParent(q,function(i){return i.getAttribute("label")==n.label},true);if(j){a.remove(j,true)}}o.moveToBookmark(k).select()}else{if(b.$block[h]){this.execCommand("paragraph",h,l);o=s.selection.getRange();if(!o.collapsed){o.collapse();j=a.findParent(s.selection.getStart(),function(i){return i.getAttribute("label")==n.label},true);var t=s.document.createElement("p");a.insertAfter(j,t);a.fillNode(s.document,t);o.setStart(t,0).setCursor()}}else{o=s.selection.getRange();if(o.collapsed){j=s.document.createElement(h);a.setAttributes(j,l);o.insertNode(j).setStart(j,0).setCursor();return}k=o.createBookmark();o.applyInlineStyle(h,l).moveToBookmark(k).select()}}},queryCommandValue:function(){var d=this.selection.getStart(),e=a.findParent(d,function(f){return f.getAttribute("label")},true);return e?e.getAttribute("label"):""},queryCommandState:function(){return this.highlight?-1:0}};c.addListener("keyup",function(f,d){var i=d.keyCode||d.which;if(i==32||i==13){var e=c.selection.getRange();if(e.collapsed){var g=a.findParent(c.selection.getStart(),function(j){return j.getAttribute("label")!=""},true);if(g){if(baidu.editor.dom.dtd.$block[g.tagName]&&a.isEmptyNode(g)){var h=c.document.createElement("p");a.insertAfter(g,h);a.fillNode(c.document,h);a.remove(g);e.setStart(h,0).setCursor()}}}}})}})();(function(){var e=baidu.editor.browser,c=baidu.editor.dom.domUtils,d,b=e.ie&&e.version<=6;baidu.editor.plugins.autofloat=function(){var g=this.options.autoFloatEnabled;if(!g){return}var i=this,j=false,k=0,m,l=document.createElement("div");function o(v){var q=i.ui.getDom("toolbarbox"),s=c.getXY(q),r=window.getComputedStyle?document.defaultView.getComputedStyle(q,null).position:q.currentStyle.position,u=window.getComputedStyle?document.defaultView.getComputedStyle(q,null).left:q.currentStyle.left;l.style.height=q.offsetHeight+"px";m=q.style.cssText;if(e.ie7Compat){var t=(q.getBoundingClientRect().left-document.documentElement.getBoundingClientRect().left)+"px"}q.style.width=q.offsetWidth+"px";q.parentNode.insertBefore(l,q);if(b){q.style.position="absolute";q.style.setExpression("top",'eval("((document.documentElement||document.body).scrollTop-'+v+")+'px'\")");q.style.zIndex="1"}else{q.style.position="fixed";q.style.zIndex="1";q.style.top="0";if(e.ie7Compat){q.style.left=t}((r=="absolute"||r=="relative")&&parseFloat(u))&&(q.style.left=s.x+"px")}j=true}function h(){var q=i.ui.getDom("toolbarbox");l.parentNode.removeChild(l);if(b){q.style.removeExpression("top")}q.style.cssText=m;j=false}function n(){var s=d.getClientRect(i.ui.getDom("toolbarbox"));var q=d.getClientRect(i.ui.getDom("iframeholder"));if(!j){if(s.top<0&&q.bottom>s.height+k){var t=(document.documentElement.scrollTop||document.body.scrollTop)+s.top;o(t)}}else{var r=d.getClientRect(l);if(s.top<r.top||s.bottom+k>q.bottom){h()}}}i.addListener("destroy",function(){c.un(window,["scroll","resize"],n);i.removeListener("keydown",n)});i.addListener("ready",function(){if(a()){if(b){f()}i.addListener("autoheightchanged",function(r,q){if(q){c.on(window,["scroll","resize"],n);i.addListener("keydown",n)}else{c.un(window,["scroll","resize"],n);i.removeListener("keydown",n)}});i.addListener("beforefullscreenchange",function(r,q){if(q){if(j){h()}}});i.addListener("fullscreenchanged",function(r,q){if(!q){n()}});i.addListener("sourcemodechanged",function(r,q){setTimeout(function(){n()})})}})};function a(){try{d=baidu.editor.ui.uiUtils}catch(g){alert("autofloat插件功能依赖于UEditor UI\nautofloat定义位置: _src/plugins/autofloat/autofloat.js");throw ({name:"未包含UI文件",message:"autofloat功能依赖于UEditor UI。autofloat定义位置: _src/plugins/autofloat/autofloat.js"})}return 1}function f(){var g=document.body.style;g.backgroundImage='url("about:blank")';g.backgroundAttachment="fixed"}})();(function(){var b=baidu.editor.browser,a=baidu.editor.dom.domUtils,f=baidu.editor.dom.dtd;function e(h){h=h||{};this.indentChar=h.indentChar||"    ";this.breakChar=h.breakChar||"\n";this.selfClosingEnd=h.selfClosingEnd||" />"}var g=function(){var i={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function h(j){return i[j]}return function(j){j=j+"";return j?j.replace(/[<>"']/g,h):""}}();function d(i){var j=[];for(var h in i){j.push(h+'="'+g(i[h])+'"')}return j.join(" ")}e.prototype={format:function(h){var i=baidu.editor.serialize.parseHTML(h);this.buff=[];this.indents="";this.indenting=1;this.visitNode(i);return this.buff.join("")},visitNode:function(i){if(i.type=="fragment"){this.visitChildren(i.children)}else{if(i.type=="element"){var h=f.$empty[i.tag];this.visitTag(i.tag,i.attributes,h);this.visitChildren(i.children);if(!h){this.visitEndTag(i.tag)}}else{if(i.type=="comment"){this.visitComment(i.data)}else{this.visitText(i.data,f.$notTransContent[i.parent.tag])}}}},visitChildren:function(j){for(var h=0;h<j.length;h++){this.visitNode(j[h])}},visitTag:function(h,j,i){if(this.indenting){this.indent()}else{if(!f.$inline[h]&&h!="a"){this.newline();this.indent()}}this.buff.push("<",h);var k=d(j);if(k){this.buff.push(" ",k)}if(i){this.buff.push(this.selfClosingEnd);if(h=="br"){this.newline()}}else{this.buff.push(">");this.indents+=this.indentChar}if(!f.$inline[h]){this.newline()}},indent:function(){this.buff.push(this.indents);this.indenting=0},newline:function(){this.buff.push(this.breakChar);this.indenting=1},visitEndTag:function(h){this.indents=this.indents.slice(0,-this.indentChar.length);if(this.indenting){this.indent()}else{if(!f.$inline[h]){this.newline();this.indent()}}this.buff.push("</",h,">")},visitText:function(i,h){if(this.indenting){this.indent()}if(!h){i=i.replace(/&nbsp;/g," ").replace(/[ ][ ]+/g,function(j){return new Array(j.length+1).join("&nbsp;")}).replace(/(?:^ )|(?: $)/g,"&nbsp;")}this.buff.push(i)},visitComment:function(h){if(this.indenting){this.indent()}this.buff.push("<!--",h,"-->")}};var c={textarea:function(j,i){var h=i.ownerDocument.createElement("textarea");h.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";if(baidu.editor.browser.ie&&baidu.editor.browser.version<8){h.style.width=i.offsetWidth+"px";h.style.height=i.offsetHeight+"px";i.onresize=function(){h.style.width=i.offsetWidth+"px";h.style.height=i.offsetHeight+"px"}}i.appendChild(h);return{setContent:function(k){h.value=k},getContent:function(){return h.value},select:function(){var k;if(baidu.editor.browser.ie){k=h.createTextRange();k.collapse(true);k.select()}else{h.setSelectionRange(0,0);h.focus()}},dispose:function(){i.removeChild(h);i.onresize=null;h=null;i=null}}},codemirror:function(k,j){var i={mode:"text/html",tabMode:"indent",lineNumbers:true,lineWrapping:true};var h=window.CodeMirror(j,i);var l=h.getWrapperElement();l.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';h.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";h.refresh();return{setContent:function(m){h.setValue(m)},getContent:function(){return h.getValue()},select:function(){h.focus()},dispose:function(){j.removeChild(l);l=null;h=null}}}};baidu.editor.plugins.source=function(){var l=this,o=baidu.editor.utils;l.initPlugins(["serialize"]);var h=this.options;var n=new e(h.source);var k=false;var q;function i(t){var s=h.sourceEditor=="codemirror"&&window.CodeMirror;return c[s?"codemirror":"textarea"](l,t)}var r;l.commands.source={execCommand:function(){k=!k;if(k){l.undoManger&&l.undoManger.save();this.currentSelectedArr&&a.clearSelectedArr(this.currentSelectedArr);if(b.gecko){l.body.contentEditable=false}r=l.iframe.style.cssText;l.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";var s=n.format(l.hasContents()?l.getContent():"");q=i(l.iframe.parentNode);q.setContent(s);setTimeout(function(){q.select()})}else{l.iframe.style.cssText=r;l.setContent(q.getContent().replace(new RegExp(n.breakChar+"?("+n.indentChar+"){0,}<","g"),"<")||"<p>"+(b.ie?"":"<br/>")+"</p>");q.dispose();q=null;setTimeout(function(){var v=l.body.firstChild;if(!v){l.body.innerHTML="<p>"+(b.ie?"":"<br/>")+"</p>";v=l.body.firstChild}l.undoManger&&l.undoManger.save();while(v&&v.firstChild){v=v.firstChild}var u=l.selection.getRange();if(v.nodeType==3||baidu.editor.dom.dtd.$empty[v.tagName]){u.setStartBefore(v)}else{u.setStart(v,0)}if(baidu.editor.browser.gecko){var t=document.createElement("input");t.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(t);l.body.contentEditable=false;setTimeout(function(){a.setViewportOffset(t,{left:-32768,top:0});t.focus();setTimeout(function(){l.body.contentEditable=true;u.setCursor(false,true);baidu.editor.dom.domUtils.remove(t)})})}else{u.setCursor(false,true)}})}this.fireEvent("sourcemodechanged",k)},queryCommandState:function(){return k|0}};var j=l.queryCommandState;l.queryCommandState=function(s){s=s.toLowerCase();if(k){return s=="source"?1:-1}return j.apply(this,arguments)};var m=l.getContent;l.getContent=function(){if(k&&q){var s=q.getContent();if(this.serialize){var t=this.serialize.parseHTML(s);t=this.serialize.filter(t);s=this.serialize.toHTML(t)}return s}else{return m.apply(this,arguments)}};l.addListener("ready",function(){if(h.sourceEditor=="codemirror"){o.loadFile(document,{src:h.UEDITOR_HOME_URL+"third-party/codemirror2.15/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"});o.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:h.UEDITOR_HOME_URL+"third-party/codemirror2.15/codemirror.css"})}})}})();baidu.editor.plugins.searchreplace=function(){var a,c,b=this;this.addListener("reset",function(){a=null;c=null});b.commands.searchreplace={execCommand:function(n,d){var i=this,e=i.selection,g,h,f=0,d=baidu.editor.utils.extend(d,{all:false,casesensitive:false,dir:1},true);if(baidu.editor.browser.ie){while(1){var k;h=i.document.selection.createRange();k=h.duplicate();k.moveToElementText(i.document.body);if(d.all){c=0;d.dir=1;if(a){k.setEndPoint(d.dir==-1?"EndToStart":"StartToEnd",a)}}else{k.setEndPoint(d.dir==-1?"EndToStart":"StartToEnd",h);if(d.hasOwnProperty("replaceStr")){k.setEndPoint(d.dir==-1?"StartToEnd":"EndToStart",h)}}h=k.duplicate();if(!k.findText(d.searchStr,d.dir,d.casesensitive?4:0)){a=null;k=i.document.selection.createRange();k.scrollIntoView();return f}k.select();if(d.hasOwnProperty("replaceStr")){g=e.getRange();g.deleteContents().insertNode(g.document.createTextNode(d.replaceStr)).select();a=e.getNative().createRange()}f++;if(!d.all){break}}}else{var j=i.window,m=e.getNative(),k;while(1){if(d.all){if(a){a.collapse(false);h=a}else{h=i.document.createRange();h.setStart(i.document.body,0)}m.removeAllRanges();m.addRange(h);c=0;d.dir=1}else{h=j.getSelection().getRangeAt(0);if(d.hasOwnProperty("replaceStr")){h.collapse(d.dir==1?true:false)}}if(!c){h.collapse(d.dir<0?true:false);m.removeAllRanges();m.addRange(h)}else{m.removeAllRanges()}if(!j.find(d.searchStr,d.casesensitive,d.dir<0?true:false)){a=null;m.removeAllRanges();return f}c=0;g=j.getSelection().getRangeAt(0);if(!g.collapsed){if(d.hasOwnProperty("replaceStr")){g.deleteContents();var l=j.document.createTextNode(d.replaceStr);g.insertNode(l);g.selectNode(l);m.addRange(g);a=g.cloneRange()}}f++;if(!d.all){break}}}return true}}};(function(){var a=baidu.editor.dom.domUtils;baidu.editor.plugins.autoheight=function(){var e=this;e.autoHeightEnabled=e.options.autoHeightEnabled;var g;var f;var b,d,c;e.enableAutoHeight=function(){var h=e.iframe,j=e.document;e.autoHeightEnabled=true;f=h.scroll;b=j.body.style.overflowY;h.scroll="no";var i=0,k;g=setInterval(function(){if(e.queryCommandState("source")!=1){if(!d){d=e.document.createElement("span");d.style.cssText="margin:0;padding:0;border:0;clear:both;display:block;";d.innerHTML="."}c=d.cloneNode(true);e.body.appendChild(c);k=Math.max(a.getXY(c).y+c.offsetHeight,e.options.minFrameHeight);if(!baidu.editor.browser.gecko||k-i!=c.offsetHeight){e.setHeight(k);i=k}a.remove(c)}},50);e.addListener("destroy",function(){clearInterval(g)});e.fireEvent("autoheightchanged",e.autoHeightEnabled)};e.disableAutoHeight=function(){var h=e.iframe,i=e.document;h.scroll=f;i.body.style.overflowY=b;clearInterval(g);e.autoHeightEnabled=false;e.fireEvent("autoheightchanged",e.autoHeightEnabled)};e.addListener("ready",function(){if(e.autoHeightEnabled){e.enableAutoHeight()}})}})();baidu.editor.plugins.formatmatch=function(){var e=this,a=baidu.editor.dom.domUtils,f=[],c,b=0,d=baidu.editor.browser;this.addListener("reset",function(){f=[];b=0});function g(o,r){if(d.webkit){var n=r.target.tagName=="IMG"?r.target:null}function h(i){if(s&&(!e.currentSelectedArr||!e.currentSelectedArr.length)){i.selectNode(s)}return i.applyInlineStyle(f[f.length-1].tagName,null,f)}e.undoManger&&e.undoManger.save();var m=e.selection.getRange(),q=n||m.getClosedNode();if(c&&q&&q.tagName=="IMG"){q.style.cssText+=";float:"+(c.style.cssFloat||c.style.styleFloat||"none")+";display:"+(c.style.display||"inline");c=null}else{if(!c){var k=m.collapsed;if(k){var s=e.document.createTextNode("match");m.insertNode(s).select()}e.__hasEnterExecCommand=true;var j=e.options.removeFormatAttributes;e.options.removeFormatAttributes="";e.execCommand("removeformat");e.options.removeFormatAttributes=j;e.__hasEnterExecCommand=false;m=e.selection.getRange();if(f.length==0){if(e.currentSelectedArr&&e.currentSelectedArr.length>0){m.selectNodeContents(e.currentSelectedArr[0]).select()}}else{if(e.currentSelectedArr&&e.currentSelectedArr.length>0){for(var l=0,t;t=e.currentSelectedArr[l++];){m.selectNodeContents(t);h(m)}m.selectNodeContents(e.currentSelectedArr[0]).select()}else{h(m)}}if(!e.currentSelectedArr||!e.currentSelectedArr.length){if(s){m.setStartBefore(s).collapse(true)}m.select()}s&&a.remove(s)}}e.undoManger&&e.undoManger.save();e.removeListener("mouseup",g);b=0}e.commands.formatmatch={execCommand:function(j){if(b){b=0;f=[];e.removeListener("mouseup",g);return}var h=e.selection.getRange();c=h.getClosedNode();if(!c||c.tagName!="IMG"){h.collapse(true).shrinkBoundary();var m=h.startContainer;f=a.findParents(m,true,function(i){return !a.isBlockElm(i)&&i.nodeType==1});for(var l=0,k;k=f[l];l++){if(k.tagName=="A"){f.splice(l,1);break}}}e.addListener("mouseup",g);b=1},queryCommandState:function(){if(this.highlight){return -1}return b},notNeedUndo:1}};baidu.editor.plugins.elementpath=function(){var b=baidu.editor.dom.domUtils,e,a,d=baidu.editor.dom.dtd,c=this;c.commands.elementpath={execCommand:function(r,g){var o=this,k=a[g],n=o.selection.getRange();o.currentSelectedArr&&b.clearSelectedArr(o.currentSelectedArr);e=g*1;if(d.$tableContent[k.tagName]){switch(k.tagName){case"TD":o.currentSelectedArr=[k];k.className=o.options.selectedTdClass;break;case"TR":var s=k.cells;for(var m=0,h;h=s[m++];){o.currentSelectedArr.push(h);h.className=o.options.selectedTdClass}break;case"TABLE":case"TBODY":var t=k.rows;for(var m=0,q;q=t[m++];){s=q.cells;for(var l=0,f;f=s[l++];){o.currentSelectedArr.push(f);f.className=o.options.selectedTdClass}}}k=o.currentSelectedArr[0];if(b.isEmptyNode(k)){n.setStart(k,0).setCursor()}else{n.selectNodeContents(k).select()}}else{n.selectNode(k).select()}},queryCommandValue:function(){var l=this.selection.getStart(),g=b.findParents(l,true),k=[];a=g;for(var j=0,h;h=g[j];j++){if(h.nodeType==3){continue}var f=h.tagName.toLowerCase();if(f=="img"&&h.getAttribute("anchorname")){f="anchor"}k[j]=f;if(e==j){e=-1;break}}return k}}};(function(){baidu.editor.plugins.video=function(){var d=this;var c={};var a=[];var e=0;function b(i,l,g,k){var h="edui_faked_video_"+(e++);var j='<img isfakedvideo id="'+h+'" width="'+l+'" height="'+g+'" _url="'+i+'" class="edui-faked-video" src="http://hi.baidu.com/fc/editor/images/spacer.gif" style="background:url(http://hi.baidu.com/ui/neweditor/lib/fck/images/fck_videologo.gif) no-repeat center center; border:1px solid gray;'+k+';" />';c[h]='<embed isfakedvideo type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+i+'" width="'+l+'" height="'+g+'" wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never"></embed>';return j}d.commands.insertvideo={execCommand:function(l,i){var h=i.url;var k=i.width||320;var g=i.height||240;var j=i.style?i.style:"";d.execCommand("inserthtml",b(h,k,g,j))},queryCommandState:function(){return this.highlight?-1:0}};function f(j,i){var h=new RegExp(i+":\\s*((\\w)*)","ig");var g=h.exec(j);return g?g[1]:""}d.addListener("beforegetcontent",function(){var j=d.document.createElement("div");var k={};for(var g in c){var l;while((l=d.document.getElementById(g))){j.innerHTML=c[g];var h=j.firstChild;h.width=l.width;h.height=l.height;var i=l.style.cssText;if(/float/ig.test(i)){if(!!window.ActiveXObject){h.style.styleFloat=f(i,"float")}else{h.style.cssFloat=f(i,"float")}}else{if(/display/ig.test(i)){h.style.display=f(i,"display")}}l.parentNode.replaceChild(h,l);a.push([l,h]);k[g]=c[g]}}c=k});d.addListener("aftersetcontent",function(){var n=d.document.createElement("div");c={};var l=d.document.getElementsByTagName("embed");var i=[];var m=l.length;while(m--){i[m]=l[m]}m=i.length;while(m--){var h=i[m].getAttribute("src");var j=i[m].width||320;var o=i[m].height||240;var q=i[m].style.cssText;var g=f(q,"display")?"display:"+f(q,"display"):"float:"+f(q,"float");n.innerHTML=b(h,j,o,g);i[m].parentNode.replaceChild(n.firstChild,i[m])}});d.addListener("aftergetcontent",function(){for(var g=0;g<a.length;g++){var h=a[g];h[1].parentNode.replaceChild(h[0],h[1])}a=[]})}})();baidu.editor.plugins.highlight=function(){var e=this,a=baidu.editor.dom.domUtils,b=baidu.editor.utils,c=baidu.editor.browser;e.commands.highlightcode={execCommand:function(q,j,l){if(j&&l){var k=document.createElement("pre");k.className="brush: "+l+";toolbar:false;";k.style.display="";k.appendChild(document.createTextNode(j));document.body.appendChild(k);if(e.queryCommandState("highlightcode")){e.execCommand("highlightcode")}e.execCommand("inserthtml",SyntaxHighlighter.highlight(k,null,true));var g=e.document.getElementById(SyntaxHighlighter.getHighlighterDivId());g.setAttribute("highlighter",k.className);a.remove(k);f()}else{var n=this.selection.getRange(),i=a.findParentByTagName(n.startContainer,"table",true),m=a.findParentByTagName(n.endContainer,"table",true),o;if(i&&m&&i===m&&i.parentNode.className.indexOf("syntaxhighlighter")>-1){o=i.parentNode;if(a.isBody(o.parentNode)){var h=e.document.createElement("p");h.innerHTML=baidu.editor.browser.ie?"":"<br/>";e.body.insertBefore(h,o);n.setStart(h,0)}else{n.setStartBefore(o)}n.setCursor();a.remove(o)}}},queryCommandState:function(){var h=this.selection.getRange(),i,g;h.adjustmentBoundary();i=a.findParent(h.startContainer,function(j){return j.nodeType==1&&j.tagName=="DIV"&&a.hasClass(j,"syntaxhighlighter")},true);g=a.findParent(h.endContainer,function(j){return j.nodeType==1&&j.tagName=="DIV"&&a.hasClass(j,"syntaxhighlighter")},true);return i&&g&&i==g?1:0}};e.addListener("beforeselectionchange",function(){e.highlight=e.queryCommandState("highlightcode")==1?1:0});e.addListener("afterselectionchange",function(){e.highlight=0});e.addListener("ready",function(){if(typeof XRegExp=="undefined"){var g={id:"syntaxhighlighter_js",src:e.options.highlightJsUrl,tag:"script",type:"text/javascript",defer:"defer"};b.loadFile(document,g,function(){d()})}if(!e.document.getElementById("syntaxhighlighter_css")){var g={id:"syntaxhighlighter_css",tag:"link",rel:"stylesheet",type:"text/css",href:e.options.highlightCssUrl};b.loadFile(e.document,g)}});e.addListener("beforegetcontent",function(o,g){for(var j=0,k,q=a.getElementsByTagName(e.body,"div");k=q[j++];){if(k.className=="container"){var l=k.parentNode;while(l){if(l.tagName=="DIV"&&/highlighter/.test(l.id)){break}l=l.parentNode}var h=e.document.createElement("pre");for(var n=[],m=0,r;r=k.childNodes[m++];){n.push(r[c.ie?"innerText":"textContent"])}h.appendChild(e.document.createTextNode(n.join("\n")));h.className=l.getAttribute("highlighter");l.parentNode.insertBefore(h,l);a.remove(l)}}});e.addListener("aftergetcontent",function(g,h){d()});function f(){var l=e.document.getElementById(SyntaxHighlighter.getHighlighterDivId());if(l){var k=l.getElementsByTagName("td");for(var j=0,g,h;g=k[0].childNodes[j];j++){h=k[1].firstChild.childNodes[j];h.style.height=g.style.height=h.offsetHeight+"px"}}}function d(){for(var h=0,n,l=a.getElementsByTagName(e.document,"pre");n=l[h++];){if(n.className.indexOf("brush")>-1){var k=document.createElement("pre"),g,m;k.className=n.className;k.style.display="none";k.appendChild(document.createTextNode(n[c.ie?"innerText":"textContent"]));document.body.appendChild(k);try{g=SyntaxHighlighter.highlight(k,null,true)}catch(j){a.remove(k);return}m=e.document.createElement("div");m.innerHTML=g;m.firstChild.setAttribute("highlighter",k.className);n.parentNode.insertBefore(m.firstChild,n);a.remove(k);a.remove(n);f()}}}e.addListener("aftersetcontent",function(){d()})};baidu.editor.plugins.shortcutkeys=function(){var a=this,b=baidu.editor.utils.extend({"ctrl+66":"Bold","ctrl+90":"Undo","ctrl+89":"Redo","ctrl+73":"Italic","ctrl+85":"Underline:Underline","ctrl+shift+67":"removeformat","ctrl+shift+76":"justify:left","ctrl+shift+82":"justify:right","ctrl+65":"selectAll"},a.options.shortcutkeys);a.addListener("keydown",function(d,h){var g=h.keyCode||h.which,f;for(var c in b){if(/^(ctrl)(\+shift)?\+(\d+)$/.test(c.toLowerCase())||/^(\d+)$/.test(c)){if(((RegExp.$1=="ctrl"?(h.ctrlKey||h.metaKey):0)&&(RegExp.$2!=""?h[RegExp.$2.slice(1)+"Key"]:1)&&g==RegExp.$3)||g==RegExp.$1){f=b[c].split(":");a.execCommand(f[0],f[1]);h.preventDefault?h.preventDefault():(h.returnValue=false)}}}})};(function(){baidu.editor.plugins.contextmenu=function(){var f=this,g,b=f.options.contextMenu;if(!b||b.length==0){return}var e=baidu.editor,a=e.dom.domUtils,d=e.browser;var c=baidu.editor.ui.uiUtils;f.addListener("contextmenu",function(o,r){var k=c.getViewportOffsetByEvent(r);if(g){g.destroy()}for(var l=0,h,s=[];h=b[l];l++){var q;(function(v){if(v=="-"){if((q=s[s.length-1])&&q!=="-"){s.push("-")}}else{if(v.group){for(var u=0,t,i=[];t=v.subMenu[u];u++){(function(w){if(w=="-"){if((q=i[i.length-1])&&q!=="-"){i.push("-")}}else{if(f.queryCommandState(w.cmdName)!=-1){i.push({label:w.label,className:"edui-for-"+w.cmdName+(w.value||""),onclick:w.exec?function(){w.exec.call(f)}:function(){f.execCommand(w.cmdName,w.value)}})}}})(t)}if(i.length){s.push({label:v.group,className:"edui-for-"+v.icon,subMenu:{items:i,editor:f}})}}else{if(f.queryCommandState(v.cmdName)!=-1){if(v.cmdName=="highlightcode"&&f.queryCommandState(v.cmdName)==0){return}s.push({label:v.label,className:"edui-for-"+(v.icon?v.icon:v.cmdName+(v.value||"")),onclick:v.exec?function(){v.exec.call(f)}:function(){f.execCommand(v.cmdName,v.value)}})}}}})(h)}if(s[s.length-1]=="-"){s.pop()}g=new baidu.editor.ui.Menu({items:s,editor:f});g.render();g.showAt(k);a.preventDefault(r);if(d.ie){var j;try{j=f.selection.getNative().createRange()}catch(n){return}if(j.item){var m=new e.dom.Range(f.document);m.selectNode(j.item(0)).select(true,true)}}})}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.dom.dtd,d={TD:1,PRE:1,BLOCKQUOTE:1};function c(i,f,h){var g=i.nextSibling;if(g&&g.nodeType==1&&g.tagName.toLowerCase()==f&&(a.getStyle(g,"list-style-type")||(f=="ol"?"decimal":"disc"))==h){a.moveChild(g,i);if(g.childNodes.length==0){a.remove(g)}}var e=i.previousSibling;if(e&&e.nodeType==1&&e.tagName.toLowerCase()==f&&(a.getStyle(e,"list-style-type")||(f=="ol"?"decimal":"disc"))==h){a.moveChild(i,e)}if(i.childNodes.length==0){a.remove(i)}}baidu.editor.plugins.list=function(){var e=this;e.addListener("keydown",function(o,v){function k(){v.preventDefault?v.preventDefault():(v.returnValue=false);e.undoManger&&e.undoManger.save()}var w=v.keyCode||v.which;if(w==13){var n=e.selection.getRange(),g=a.findParentByTagName(n.startContainer,["ol","ul"],true,function(x){return x.tagName=="TABLE"}),j=a.findParentByTagName(n.endContainer,["ol","ul"],true,function(x){return x.tagName=="TABLE"});if(g&&j&&g===j){if(!n.collapsed){g=a.findParentByTagName(n.startContainer,"li",true);j=a.findParentByTagName(n.endContainer,"li",true);if(g&&j&&g===j){n.deleteContents();t=a.findParentByTagName(n.startContainer,"li",true);if(t&&a.isEmptyBlock(t)){i=t.previousSibling;m=t.nextSibling;f=e.document.createElement("p");a.fillNode(e.document,f);r=t.parentNode;if(i&&m){n.setStart(m,0).collapse(true).select(true);a.remove(t)}else{if(!i&&!m||!i){r.parentNode.insertBefore(f,r)}else{t.parentNode.parentNode.insertBefore(f,r.nextSibling)}a.remove(t);if(!r.firstChild){a.remove(r)}n.setStart(f,0).setCursor()}k();return}}else{var u=n.cloneRange(),h=u.collapse(false).createBookmark();n.deleteContents();u.moveToBookmark(h);var t=a.findParentByTagName(u.startContainer,"li",true),i=t.previousSibling,m=t.nextSibling;if(i){t=i;if(i.firstChild&&a.isBlockElm(i.firstChild)){i=i.firstChild}if(a.isEmptyNode(i)){a.remove(t)}}if(m){t=m;if(m.firstChild&&a.isBlockElm(m.firstChild)){m=m.firstChild}if(a.isEmptyNode(m)){a.remove(t)}}u.select();k();return}}t=a.findParentByTagName(n.startContainer,"li",true);if(t){if(a.isEmptyBlock(t)){h=n.createBookmark();var r=t.parentNode;if(t!==r.lastChild){a.breakParent(t,r)}else{r.parentNode.insertBefore(t,r.nextSibling);if(a.isEmptyNode(r)){a.remove(r)}}if(!b.$list[t.parentNode.tagName]){if(!a.isBlockElm(t.firstChild)){f=e.document.createElement("p");t.parentNode.insertBefore(f,t);while(t.firstChild){f.appendChild(t.firstChild)}a.remove(t)}else{a.remove(t,true)}}n.moveToBookmark(h).select()}else{var l=t.firstChild;if(!l||!a.isBlockElm(l)){var f=e.document.createElement("p");!t.firstChild&&a.fillNode(e.document,f);while(t.firstChild){f.appendChild(t.firstChild)}t.appendChild(f);l=f}var q=e.document.createElement("span");n.insertNode(q);a.breakParent(q,t);var s=q.nextSibling;l=s.firstChild;if(!l){f=e.document.createElement("p");a.fillNode(e.document,f);s.appendChild(f);l=f}if(a.isEmptyNode(l)){a.fillNode(e.document,l)}n.setStart(l,0).collapse(true).shrinkBoundary().select();a.remove(q);i=s.previousSibling;if(i&&a.isEmptyBlock(i)){i.innerHTML="<p></p>";a.fillNode(e.document,i.firstChild)}}k()}}}if(w==8){n=e.selection.getRange();if(n.collapsed&&a.isStartInblock(n)){u=n.cloneRange().trimBoundary();t=a.findParentByTagName(n.startContainer,"li",true);if(t&&a.isStartInblock(u)){if(t&&(i=t.previousSibling)){if(w==46&&t.childNodes.length){return}if(b.$list[i.tagName]){i=i.lastChild}e.undoManger&&e.undoManger.save();var l=t.firstChild;if(a.isBlockElm(l)){if(a.isEmptyNode(l)){i.appendChild(l);n.setStart(l,0).setCursor(false,true)}else{var g=a.findParentByTagName(n.startContainer,"p",true);if(g&&g!==l){return}q=e.document.createElement("span");n.insertNode(q);a.moveChild(t,i);n.setStartBefore(q).collapse(true).select(true);a.remove(q)}}else{if(a.isEmptyNode(t)){var f=e.document.createElement("p");i.appendChild(f);n.setStart(f,0).setCursor()}else{n.setEnd(i,i.childNodes.length).collapse().select(true);while(t.firstChild){i.appendChild(t.firstChild)}}}a.remove(t);e.undoManger&&e.undoManger.save();a.preventDefault(v);return}if(t&&!t.previousSibling){l=t.firstChild;if(!l||a.isEmptyNode(a.isBlockElm(l)?l:t)){var f=e.document.createElement("p");t.parentNode.parentNode.insertBefore(f,t.parentNode);a.fillNode(e.document,f);n.setStart(f,0).setCursor();a.remove(!t.nextSibling?t.parentNode:t);e.undoManger&&e.undoManger.save();a.preventDefault(v);return}}}}}});e.commands.insertorderedlist=e.commands.insertunorderedlist={execCommand:function(j,B){if(!B){B=j.toLowerCase()=="insertorderedlist"?"decimal":"disc"}var I=this,u=this.selection.getRange(),v=function(i){return i.nodeType==1?i.tagName.toLowerCase()!="br":!a.isWhitespace(i)},K=j.toLowerCase()=="insertorderedlist"?"ol":"ul",h=I.document.createDocumentFragment();u.adjustmentBoundary().shrinkBoundary();var n=u.createBookmark(true),l=a.findParentByTagName(I.document.getElementById(n.start),"li"),y=0,k=a.findParentByTagName(I.document.getElementById(n.end),"li"),z=0,G,r,C,E;if(l||k){l&&(G=l.parentNode);if(!n.end){k=l}k&&(r=k.parentNode);if(G===r){while(l!==k){E=l;l=l.nextSibling;if(!a.isBlockElm(E.firstChild)){var w=I.document.createElement("p");while(E.firstChild){w.appendChild(E.firstChild)}E.appendChild(w)}h.appendChild(E)}E=I.document.createElement("span");G.insertBefore(E,k);if(!a.isBlockElm(k.firstChild)){w=I.document.createElement("p");while(k.firstChild){w.appendChild(k.firstChild)}k.appendChild(w)}h.appendChild(k);a.breakParent(E,G);if(a.isEmptyNode(E.previousSibling)){a.remove(E.previousSibling)}if(a.isEmptyNode(E.nextSibling)){a.remove(E.nextSibling)}var m=a.getComputedStyle(G,"list-style-type")||(j.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(G.tagName.toLowerCase()==K&&m==B){for(var A=0,s,o=I.document.createDocumentFragment();s=h.childNodes[A++];){while(s.firstChild){o.appendChild(s.firstChild)}}E.parentNode.insertBefore(o,E)}else{C=I.document.createElement(K);a.setStyle(C,"list-style-type",B);C.appendChild(h);E.parentNode.insertBefore(C,E)}a.remove(E);C&&c(C,K,B);u.moveToBookmark(n).select();return}if(l){while(l){E=l.nextSibling;var f=I.document.createDocumentFragment(),F=0;while(l.firstChild){if(a.isBlockElm(l.firstChild)){F=1}f.appendChild(l.firstChild)}if(!F){var J=I.document.createElement("p");J.appendChild(f);h.appendChild(J)}else{h.appendChild(f)}a.remove(l);l=E}G.parentNode.insertBefore(h,G.nextSibling);if(a.isEmptyNode(G)){u.setStartBefore(G);a.remove(G)}else{u.setStartAfter(G)}y=1}if(k){l=r.firstChild;while(l!==k){E=l.nextSibling;f=I.document.createDocumentFragment(),F=0;while(l.firstChild){if(a.isBlockElm(l.firstChild)){F=1}f.appendChild(l.firstChild)}if(!F){J=I.document.createElement("p");J.appendChild(f);h.appendChild(J)}else{h.appendChild(f)}a.remove(l);l=E}h.appendChild(k.firstChild);a.remove(k);r.parentNode.insertBefore(h,r);u.setEndBefore(r);if(a.isEmptyNode(r)){a.remove(r)}z=1}}if(!y){u.setStartBefore(I.document.getElementById(n.start))}if(n.end&&!z){u.setEndAfter(I.document.getElementById(n.end))}u.enlarge(true,function(i){return d[i.tagName]});h=I.document.createDocumentFragment();var g=u.createBookmark(),x=a.getNextDomNode(g.start,false,v),H=u.cloneRange(),D,q=a.isBlockElm;while(x&&x!==g.end&&(a.getPosition(x,g.end)&a.POSITION_PRECEDING)){if(x.nodeType==3||b.li[x.tagName]){if(x.nodeType==1&&b.$list[x.tagName]){while(x.firstChild){h.appendChild(x.firstChild)}D=a.getNextDomNode(x,false,v);a.remove(x);x=D;continue}D=x;H.setStartBefore(x);while(x&&x!==g.end&&(!q(x)||a.isBookmarkNode(x))){D=x;x=a.getNextDomNode(x,false,null,function(i){return !d[i.tagName]})}if(x&&q(x)){E=a.getNextDomNode(D,false,v);if(E&&a.isBookmarkNode(E)){x=a.getNextDomNode(E,false,v);D=E}}H.setEndAfter(D);x=a.getNextDomNode(D,false,v);var t=u.document.createElement("li");t.appendChild(H.extractContents());h.appendChild(t)}else{x=a.getNextDomNode(x,true,v)}}u.moveToBookmark(g).collapse(true);C=I.document.createElement(K);a.setStyle(C,"list-style-type",B);C.appendChild(h);u.insertNode(C);c(C,K,B);u.moveToBookmark(n).select()},queryCommandState:function(g){if(this.highlight){return -1}var f=this.selection.getStart();return a.findParentByTagName(f,g.toLowerCase()=="insertorderedlist"?"ol":"ul",true)?1:0},queryCommandValue:function(h){var f=this.selection.getStart(),g=a.findParentByTagName(f,h.toLowerCase()=="insertorderedlist"?"ol":"ul",true);return g?a.getComputedStyle(g,"list-style-type"):null}}}})();(function(){var a=baidu.editor.dom.domUtils,b=baidu.editor.browser;function c(h){var f=this.document;if(f.getElementById("baidu_pastebin")){return}var e=this.selection.getRange(),d=e.createBookmark(),g=f.createElement("div");g.id="baidu_pastebin";b.webkit&&g.appendChild(f.createTextNode(a.fillChar+a.fillChar));f.body.appendChild(g);d.start.style.display="";g.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+a.getXY(d.start).y+"px";e.selectNodeContents(g).select(true);setTimeout(function(){if(b.webkit){for(var j=0,k=f.querySelectorAll("#baidu_pastebin"),m;m=k[j++];){if(a.isEmptyNode(m)){a.remove(m)}else{g=m;break}}}try{g.parentNode.removeChild(g)}catch(l){}e.moveToBookmark(d).select(true);h(g)},0)}baidu.editor.plugins.paste=function(){var h=this;var g={flag:""};var f=h.options.pasteplain;var d={flag:""};h.commands.pasteplain={queryCommandState:function(){return f},execCommand:function(){f=!f|0},notNeedUndo:1};function e(t){var s;if(t.firstChild){var w=a.getElementsByTagName(t,"span");for(var z=0,m;m=w[z++];){if(m.id=="_baidu_cut_start"||m.id=="_baidu_cut_end"){a.remove(m)}}if(b.webkit){var u=t.querySelectorAll("div br");for(var z=0,k;k=u[z++];){var r=k.parentNode;if(r.tagName=="DIV"&&r.childNodes.length==1){r.innerHMTL="<p><br/></p>";a.remove(r)}}var y=t.querySelectorAll("#baidu_pastebin");for(var z=0,A;A=y[z++];){var D=h.document.createElement("p");A.parentNode.insertBefore(D,A);while(A.firstChild){D.appendChild(A.firstChild)}a.remove(A)}var j=t.querySelectorAll("meta");for(var z=0,q;q=j[z++];){a.remove(q)}}if(b.gecko){var v=t.querySelectorAll("[_moz_dirty]");for(z=0;q=v[z++];){q.removeAttribute("_moz_dirty")}}if(!b.ie){var o=t.querySelectorAll("span.apple-style-span");for(var z=0,q;q=o[z++];){a.remove(q,true)}}s=t.innerHTML;var B=h.serialize;if(B){try{var x=B.transformInput(B.parseHTML(B.word(s)),g);x=B.filter(x,f?{whiteList:{p:{br:1,BR:1},br:{"$":{}},div:{br:1,BR:1,"$":{}},li:{"$":{}},tr:{td:1,"$":{}},td:{"$":{}}},blackList:{style:1,script:1,object:1}}:null,!f?d:null);if(b.webkit){var l=x.children.length,n;while((n=x.children[l-1])&&n.tag=="br"){x.children.splice(l-1,1);l=x.children.length}}s=B.toHTML(x,f)}catch(C){}}s={html:s};h.fireEvent("beforepaste",s);h.execCommand("insertHtml",s.html)}}h.addListener("ready",function(){a.on(h.body,"cut",function(){var i=h.selection.getRange();if(!i.collapsed&&h.undoManger){h.undoManger.save()}});a.on(h.body,b.ie?"keydown":"paste",function(i){if(b.ie&&(!i.ctrlKey||i.keyCode!="86")){return}c.call(h,function(k){e(k);function j(){h.ui.hideToolbarMsg();h.removeListener("selectionchange",j)}if(d.flag&&h.ui){h.ui.showToolbarMsg(h.options.messages.pasteMsg,g.flag);d.flag="";setTimeout(function(){h.addListener("selectionchange",j)},100)}if(g.flag&&!h.queryCommandState("pasteplain")&&h.ui){h.ui.showToolbarMsg(h.options.messages.pasteWordImgMsg,true);g.flag="";setTimeout(function(){h.addListener("selectionchange",j)},100)}})})})}})();